import{featureCollection as A,polygon as j}from"../helpers@7.1.0/index.js";function w(e,n){let s=!1;return A(E(e.features.map(o=>{const r={x:o.geometry.coordinates[0],y:o.geometry.coordinates[1]};return n?r.z=o.properties[n]:o.geometry.coordinates.length===3&&(s=!0,r.z=o.geometry.coordinates[2]),r})).map(o=>{const r=[o.a.x,o.a.y],y=[o.b.x,o.b.y],c=[o.c.x,o.c.y];let l={};return s?(r.push(o.a.z),y.push(o.b.z),c.push(o.c.z)):l={a:o.a.z,b:o.b.z,c:o.c.z},j([[r,y,c,r]],l)}))}var v=class{constructor(e,n,s){this.a=e,this.b=n,this.c=s;const o=n.x-e.x,r=n.y-e.y,y=s.x-e.x,c=s.y-e.y,l=o*(e.x+n.x)+r*(e.y+n.y),x=y*(e.x+s.x)+c*(e.y+s.y),p=2*(o*(s.y-n.y)-r*(s.x-n.x));let u,f;this.x=(c*l-r*x)/p,this.y=(o*x-y*l)/p,u=this.x-e.x,f=this.y-e.y,this.r=u*u+f*f}};function C(e,n){return n.x-e.x}function D(e){let n=e.length,s,o,r,y,c;e:for(;n;)for(o=e[--n],s=e[--n],r=n;r;)if(c=e[--r],y=e[--r],s===y&&o===c||s===c&&o===y){e.splice(n,2),e.splice(r,2),n-=2;continue e}}function E(e){if(e.length<3)return[];e.sort(C);let n=e.length-1;const s=e[n].x,o=e[0].x;let r=e[n].y,y=r;const c=1e-12;let l,x,p,u,f,d;for(;n--;)e[n].y<r&&(r=e[n].y),e[n].y>y&&(y=e[n].y);let a=o-s,_=y-r;const b=a>_?a:_,m=(o+s)*.5,z=(y+r)*.5,i=[new v({__sentinel:!0,x:m-20*b,y:z-b},{__sentinel:!0,x:m,y:z+20*b},{__sentinel:!0,x:m+20*b,y:z-b})],h=[],g=[];let t;for(n=e.length;n--;){for(g.length=0,t=i.length;t--;){if(a=e[n].x-i[t].x,a>0&&a*a>i[t].r){h.push(i[t]),i.splice(t,1);continue}_=e[n].y-i[t].y,!(a*a+_*_>i[t].r)&&(g.push(i[t].a,i[t].b,i[t].b,i[t].c,i[t].c,i[t].a),i.splice(t,1))}for(D(g),t=g.length;t;)x=g[--t],l=g[--t],p=e[n],u=x.x-l.x,f=x.y-l.y,d=2*(u*(p.y-x.y)-f*(p.x-x.x)),Math.abs(d)>c&&i.push(new v(l,x,p))}for(Array.prototype.push.apply(h,i),n=h.length;n--;)(h[n].a.__sentinel||h[n].b.__sentinel||h[n].c.__sentinel)&&h.splice(n,1);return h}var F=w;export{F as default,w as tin};

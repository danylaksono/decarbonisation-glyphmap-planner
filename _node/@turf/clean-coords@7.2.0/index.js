import{feature as w}from"../helpers@7.2.0/index.js";import{getType as m,getCoords as h}from"../invariant@7.2.0/index.js";function f(t,a={}){var o=typeof a=="object"?a.mutate:a;if(!t)throw new Error("geojson is required");var r=m(t),i=[];switch(r){case"LineString":i=u(t,r);break;case"MultiLineString":case"Polygon":h(t).forEach(function(e){i.push(u(e,r))});break;case"MultiPolygon":h(t).forEach(function(e){var s=[];e.forEach(function(c){s.push(u(c,r))}),i.push(s)});break;case"Point":return t;case"MultiPoint":var n={};h(t).forEach(function(e){var s=e.join("-");Object.prototype.hasOwnProperty.call(n,s)||(i.push(e),n[s]=!0)});break;default:throw new Error(r+" geometry not supported")}return t.coordinates?o===!0?(t.coordinates=i,t):{type:r,coordinates:i}:o===!0?(t.geometry.coordinates=i,t):w({type:r,coordinates:i},t.properties,{bbox:t.bbox,id:t.id})}function u(t,a){var o=h(t);if(o.length===2&&!g(o[0],o[1]))return o;var r=[],i=o.length-1,n=r.length;r.push(o[0]);for(var e=1;e<i;e++){var s=r[r.length-1];o[e][0]===s[0]&&o[e][1]===s[1]||(r.push(o[e]),n=r.length,n>2&&d(r[n-3],r[n-1],r[n-2])&&r.splice(r.length-2,1))}if(r.push(o[o.length-1]),n=r.length,(a==="Polygon"||a==="MultiPolygon")&&g(o[0],o[o.length-1])&&n<4)throw new Error("invalid polygon");return a==="LineString"&&n<3||d(r[n-3],r[n-1],r[n-2])&&r.splice(r.length-2,1),r}function g(t,a){return t[0]===a[0]&&t[1]===a[1]}function d(t,a,o){var r=o[0],i=o[1],n=t[0],e=t[1],s=a[0],c=a[1],y=r-n,b=i-e,l=s-n,p=c-e,v=y*p-b*l;return v!==0?!1:Math.abs(l)>=Math.abs(p)?l>0?n<=r&&r<=s:s<=r&&r<=n:p>0?e<=i&&i<=c:c<=i&&i<=e}var E=f;export{f as cleanCoords,E as default};

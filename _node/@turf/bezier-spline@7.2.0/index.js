import{lineString as y}from"../helpers@7.2.0/index.js";import{getGeom as x}from"../invariant@7.2.0/index.js";var u=class{constructor(h){this.points=h.points||[],this.duration=h.duration||1e4,this.sharpness=h.sharpness||.85,this.centers=[],this.controls=[],this.stepLength=h.stepLength||60,this.length=this.points.length,this.delay=0;for(let s=0;s<this.length;s++)this.points[s].z=this.points[s].z||0;for(let s=0;s<this.length-1;s++){const t=this.points[s],n=this.points[s+1];this.centers.push({x:(t.x+n.x)/2,y:(t.y+n.y)/2,z:(t.z+n.z)/2})}this.controls.push([this.points[0],this.points[0]]);for(let s=0;s<this.centers.length-1;s++){const t=this.points[s+1].x-(this.centers[s].x+this.centers[s+1].x)/2,n=this.points[s+1].y-(this.centers[s].y+this.centers[s+1].y)/2,i=this.points[s+1].z-(this.centers[s].y+this.centers[s+1].z)/2;this.controls.push([{x:(1-this.sharpness)*this.points[s+1].x+this.sharpness*(this.centers[s].x+t),y:(1-this.sharpness)*this.points[s+1].y+this.sharpness*(this.centers[s].y+n),z:(1-this.sharpness)*this.points[s+1].z+this.sharpness*(this.centers[s].z+i)},{x:(1-this.sharpness)*this.points[s+1].x+this.sharpness*(this.centers[s+1].x+t),y:(1-this.sharpness)*this.points[s+1].y+this.sharpness*(this.centers[s+1].y+n),z:(1-this.sharpness)*this.points[s+1].z+this.sharpness*(this.centers[s+1].z+i)}])}return this.controls.push([this.points[this.length-1],this.points[this.length-1]]),this.steps=this.cacheSteps(this.stepLength),this}cacheSteps(h){const s=[];let t=this.pos(0);s.push(0);for(let n=0;n<this.duration;n+=10){const i=this.pos(n);Math.sqrt((i.x-t.x)*(i.x-t.x)+(i.y-t.y)*(i.y-t.y)+(i.z-t.z)*(i.z-t.z))>h&&(s.push(n),t=i)}return s}vector(h){const s=this.pos(h+10),t=this.pos(h-10);return{angle:180*Math.atan2(s.y-t.y,s.x-t.x)/3.14,speed:Math.sqrt((t.x-s.x)*(t.x-s.x)+(t.y-s.y)*(t.y-s.y)+(t.z-s.z)*(t.z-s.z))}}pos(h){let s=h-this.delay;s<0&&(s=0),s>this.duration&&(s=this.duration-1);const t=s/this.duration;if(t>=1)return this.points[this.length-1];const n=Math.floor((this.points.length-1)*t),i=(this.length-1)*t-n;return z(i,this.points[n],this.controls[n][1],this.controls[n+1][0],this.points[n+1])}};function z(h,s,t,n,i){const e=g(h);return{x:i.x*e[0]+n.x*e[1]+t.x*e[2]+s.x*e[3],y:i.y*e[0]+n.y*e[1]+t.y*e[2]+s.y*e[3],z:i.z*e[0]+n.z*e[1]+t.z*e[2]+s.z*e[3]}}function g(h){const s=h*h;return[s*h,3*s*(1-h),3*h*(1-h)*(1-h),(1-h)*(1-h)*(1-h)]}function l(h,s={}){const t=s.resolution||1e4,n=s.sharpness||.85,i=[],e=x(h).coordinates.map(r=>({x:r[0],y:r[1]})),o=new u({duration:t,points:e,sharpness:n}),a=r=>{var c=o.pos(r);Math.floor(r/100)%2===0&&i.push([c.x,c.y])};for(var p=0;p<o.duration;p+=10)a(p);return a(o.duration),y(i,s.properties)}var d=l;export{l as bezierSpline,d as default};

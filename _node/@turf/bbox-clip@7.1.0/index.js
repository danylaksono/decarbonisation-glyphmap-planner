import{multiPolygon as m,polygon as y,lineString as b,multiLineString as d}from"../helpers@7.1.0/index.js";import{getGeom as L}from"../invariant@7.1.0/index.js";function S(r,t,o){var u=r.length,n=g(r[0],t),i=[],l,s,f;let e,h;for(o||(o=[]),l=1;l<u;l++){for(e=r[l-1],h=r[l],s=f=g(h,t);;)if(n|s){if(n&s)break;n?(e=p(e,h,n,t),n=g(e,t)):(h=p(e,h,s,t),s=g(h,t))}else{i.push(e),s!==f?(i.push(h),l<u-1&&(o.push(i),i=[])):l===u-1&&i.push(h);break}n=f}return i.length&&o.push(i),o}function v(r,t){var o,u,n,i,l,s,f;for(u=1;u<=8;u*=2){for(o=[],n=r[r.length-1],i=!(g(n,t)&u),l=0;l<r.length;l++)s=r[l],f=!(g(s,t)&u),f!==i&&o.push(p(n,s,u,t)),f&&o.push(s),n=s,i=f;if(r=o,!r.length)break}return o}function p(r,t,o,u){return o&8?[r[0]+(t[0]-r[0])*(u[3]-r[1])/(t[1]-r[1]),u[3]]:o&4?[r[0]+(t[0]-r[0])*(u[1]-r[1])/(t[1]-r[1]),u[1]]:o&2?[u[2],r[1]+(t[1]-r[1])*(u[2]-r[0])/(t[0]-r[0])]:o&1?[u[0],r[1]+(t[1]-r[1])*(u[0]-r[0])/(t[0]-r[0])]:null}function g(r,t){var o=0;return r[0]<t[0]?o|=1:r[0]>t[2]&&(o|=2),r[1]<t[1]?o|=4:r[1]>t[3]&&(o|=8),o}function c(r,t){const o=L(r),u=o.type,n=r.type==="Feature"?r.properties:{};let i=o.coordinates;switch(u){case"LineString":case"MultiLineString":{const l=[];return u==="LineString"&&(i=[i]),i.forEach(s=>{S(s,t,l)}),l.length===1?b(l[0],n):d(l,n)}case"Polygon":return y(a(i,t),n);case"MultiPolygon":return m(i.map(l=>a(l,t)),n);default:throw new Error("geometry "+u+" not supported")}}function a(r,t){const o=[];for(const u of r){const n=v(u,t);n.length>0&&((n[0][0]!==n[n.length-1][0]||n[0][1]!==n[n.length-1][1])&&n.push(n[0]),n.length>=4&&o.push(n))}return o}var w=c;export{c as bboxClip,w as default};

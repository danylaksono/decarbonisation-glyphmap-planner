var $i=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function tr(xt){return xt&&xt.__esModule&&Object.prototype.hasOwnProperty.call(xt,"default")?xt.default:xt}var Un={exports:{}};(function(xt,ir){(function(f,re){xt.exports=re()})($i,function(){function f(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function re(r,t){for(var e=0;e<t.length;e++){var n=t[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function m(r,t,e){return t&&re(r.prototype,t),e&&re(r,e),r}function C(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),t&&Yt(r,t)}function O(r){return O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},O(r)}function Yt(r,t){return Yt=Object.setPrototypeOf||function(e,n){return e.__proto__=n,e},Yt(r,t)}function Ze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function It(r,t,e){return It=Ze()?Reflect.construct:function(n,i,s){var a=[null];a.push.apply(a,i);var u=new(Function.bind.apply(n,a));return s&&Yt(u,s.prototype),u},It.apply(null,arguments)}function ke(r){var t=typeof Map=="function"?new Map:void 0;return ke=function(e){if(e===null||(n=e,Function.toString.call(n).indexOf("[native code]")===-1))return e;var n;if(typeof e!="function")throw new TypeError("Super expression must either be null or a function");if(t!==void 0){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return It(e,arguments,O(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),Yt(i,e)},ke(r)}function q(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Bn(r,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return q(r)}function R(r){var t=Ze();return function(){var e,n=O(r);if(t){var i=O(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return Bn(this,e)}}function M(r,t,e){return M=typeof Reflect<"u"&&Reflect.get?Reflect.get:function(n,i,s){var a=function(o,l){for(;!Object.prototype.hasOwnProperty.call(o,l)&&(o=O(o))!==null;);return o}(n,i);if(a){var u=Object.getOwnPropertyDescriptor(a,i);return u.get?u.get.call(s):u.value}},M(r,t,e||r)}function se(r){return function(t){if(Array.isArray(t))return xe(t)}(r)||function(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}(r)||je(r)||function(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function je(r,t){if(r){if(typeof r=="string")return xe(r,t);var e=Object.prototype.toString.call(r).slice(8,-1);return e==="Object"&&r.constructor&&(e=r.constructor.name),e==="Map"||e==="Set"?Array.from(r):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?xe(r,t):void 0}}function xe(r,t){(t==null||t>r.length)&&(t=r.length);for(var e=0,n=new Array(t);e<t;e++)n[e]=r[e];return n}function ft(r,t){var e=typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(!e){if(Array.isArray(r)||(e=je(r))||t){e&&(r=e);var n=0,i=function(){};return{s:i,n:function(){return n>=r.length?{done:!0}:{done:!1,value:r[n++]}},e:function(o){throw o},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var s,a=!0,u=!1;return{s:function(){e=e.call(r)},n:function(){var o=e.next();return a=o.done,o},e:function(o){u=!0,s=o},f:function(){try{a||e.return==null||e.return()}finally{if(u)throw s}}}}var Y=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getEndCapStyle",value:function(){return this._endCapStyle}},{key:"isSingleSided",value:function(){return this._isSingleSided}},{key:"setQuadrantSegments",value:function(t){this._quadrantSegments=t,this._quadrantSegments===0&&(this._joinStyle=r.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=r.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),t<=0&&(this._quadrantSegments=1),this._joinStyle!==r.JOIN_ROUND&&(this._quadrantSegments=r.DEFAULT_QUADRANT_SEGMENTS)}},{key:"getJoinStyle",value:function(){return this._joinStyle}},{key:"setJoinStyle",value:function(t){this._joinStyle=t}},{key:"setSimplifyFactor",value:function(t){this._simplifyFactor=t<0?0:t}},{key:"getSimplifyFactor",value:function(){return this._simplifyFactor}},{key:"getQuadrantSegments",value:function(){return this._quadrantSegments}},{key:"setEndCapStyle",value:function(t){this._endCapStyle=t}},{key:"getMitreLimit",value:function(){return this._mitreLimit}},{key:"setMitreLimit",value:function(t){this._mitreLimit=t}},{key:"setSingleSided",value:function(t){this._isSingleSided=t}}],[{key:"constructor_",value:function(){if(this._quadrantSegments=r.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=r.CAP_ROUND,this._joinStyle=r.JOIN_ROUND,this._mitreLimit=r.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=r.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var t=arguments[0];this.setQuadrantSegments(t)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this.setQuadrantSegments(e),this.setEndCapStyle(n)}else if(arguments.length===4){var i=arguments[0],s=arguments[1],a=arguments[2],u=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(s),this.setJoinStyle(a),this.setMitreLimit(u)}}}},{key:"bufferDistanceError",value:function(t){var e=Math.PI/2/t;return 1-Math.cos(e/2)}}]),r}();Y.CAP_ROUND=1,Y.CAP_FLAT=2,Y.CAP_SQUARE=3,Y.JOIN_ROUND=1,Y.JOIN_MITRE=2,Y.JOIN_BEVEL=3,Y.DEFAULT_QUADRANT_SEGMENTS=8,Y.DEFAULT_MITRE_LIMIT=5,Y.DEFAULT_SIMPLIFY_FACTOR=.01;var mt=function(r){C(e,r);var t=R(e);function e(n){var i;return f(this,e),(i=t.call(this,n)).name=Object.keys({Exception:e})[0],i}return m(e,[{key:"toString",value:function(){return this.message}}]),e}(ke(Error)),P=function(r){C(e,r);var t=R(e);function e(n){var i;return f(this,e),(i=t.call(this,n)).name=Object.keys({IllegalArgumentException:e})[0],i}return e}(mt),zt=function(){function r(){f(this,r)}return m(r,[{key:"filter",value:function(t){}}]),r}();function j(){}function Xt(){}function Z(){}var Ie,Ee,Ut,Ot,We,Ne,ae,Bt,Te=function(){function r(){f(this,r)}return m(r,null,[{key:"equalsWithTolerance",value:function(t,e,n){return Math.abs(t-e)<=n}}]),r}(),Vt=function(){function r(t,e){f(this,r),this.low=e||0,this.high=t||0}return m(r,null,[{key:"toBinaryString",value:function(t){var e,n="";for(e=2147483648;e>0;e>>>=1)n+=(t.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)n+=(t.low&e)===e?"1":"0";return n}}]),r}();function I(){}function Ht(){}I.NaN=NaN,I.isNaN=function(r){return Number.isNaN(r)},I.isInfinite=function(r){return!Number.isFinite(r)},I.MAX_VALUE=Number.MAX_VALUE,I.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,I.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,typeof Float64Array=="function"&&typeof Int32Array=="function"?(Ne=2146435072,ae=new Float64Array(1),Bt=new Int32Array(ae.buffer),I.doubleToLongBits=function(r){ae[0]=r;var t=0|Bt[0],e=0|Bt[1];return(e&Ne)===Ne&&1048575&e&&t!==0&&(t=0,e=2146959360),new Vt(e,t)},I.longBitsToDouble=function(r){return Bt[0]=r.low,Bt[1]=r.high,ae[0]}):(Ie=1023,Ee=Math.log2,Ut=Math.floor,Ot=Math.pow,We=function(){for(var r=53;r>0;r--){var t=Ot(2,r)-1;if(Ut(Ee(t))+1===r)return t}return 0}(),I.doubleToLongBits=function(r){var t,e,n,i,s,a,u,o,l;if(r<0||1/r===Number.NEGATIVE_INFINITY?(a=1<<31,r=-r):a=0,r===0)return new Vt(o=a,l=0);if(r===1/0)return new Vt(o=2146435072|a,l=0);if(r!=r)return new Vt(o=2146959360,l=0);if(i=0,l=0,(t=Ut(r))>1)if(t<=We)(i=Ut(Ee(t)))<=20?(l=0,o=t<<20-i&1048575):(l=t%(e=Ot(2,n=i-20))<<32-n,o=t/e&1048575);else for(n=t,l=0;(n=Ut(e=n/2))!==0;)i++,l>>>=1,l|=(1&o)<<31,o>>>=1,e!==n&&(o|=524288);if(u=i+Ie,s=t===0,t=r-t,i<52&&t!==0)for(n=0;;){if((e=2*t)>=1?(t=e-1,s?(u--,s=!1):(n<<=1,n|=1,i++)):(t=e,s?--u==0&&(i++,s=!1):(n<<=1,i++)),i===20)o|=n,n=0;else if(i===52){l|=n;break}if(e===1){i<20?o|=n<<20-i:i<52&&(l|=n<<52-i);break}}return o|=u<<20,new Vt(o|=a,l)},I.longBitsToDouble=function(r){var t,e,n,i,s=r.high,a=r.low,u=s&1<<31?-1:1;for(n=((2146435072&s)>>20)-Ie,i=0,e=1<<19,t=1;t<=20;t++)s&e&&(i+=Ot(2,-t)),e>>>=1;for(e=1<<31,t=21;t<=52;t++)a&e&&(i+=Ot(2,-t)),e>>>=1;if(n===-1023){if(i===0)return 0*u;n=-1022}else{if(n===1024)return i===0?u/0:NaN;i+=1}return u*i*Ot(2,n)});var ut=function(r){C(e,r);var t=R(e);function e(n){var i;return f(this,e),(i=t.call(this,n)).name=Object.keys({RuntimeException:e})[0],i}return e}(mt),ue=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,null,[{key:"constructor_",value:function(){if(arguments.length===0)ut.constructor_.call(this);else if(arguments.length===1){var n=arguments[0];ut.constructor_.call(this,n)}}}]),e}(ut),A=function(){function r(){f(this,r)}return m(r,null,[{key:"shouldNeverReachHere",value:function(){if(arguments.length===0)r.shouldNeverReachHere(null);else if(arguments.length===1){var t=arguments[0];throw new ue("Should never reach here"+(t!==null?": "+t:""))}}},{key:"isTrue",value:function(){if(arguments.length===1){var t=arguments[0];r.isTrue(t,null)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];if(!e)throw n===null?new ue:new ue(n)}}},{key:"equals",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];r.equals(t,e,null)}else if(arguments.length===3){var n=arguments[0],i=arguments[1],s=arguments[2];if(!i.equals(n))throw new ue("Expected "+n+" but encountered "+i+(s!==null?": "+s:""))}}}]),r}(),Ke=new ArrayBuffer(8),Vn=new Float64Array(Ke),Je=new Int32Array(Ke),v=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getM",value:function(){return I.NaN}},{key:"setOrdinate",value:function(t,e){switch(t){case r.X:this.x=e;break;case r.Y:this.y=e;break;case r.Z:this.setZ(e);break;default:throw new P("Invalid ordinate index: "+t)}}},{key:"equals2D",value:function(){if(arguments.length===1){var t=arguments[0];return this.x===t.x&&this.y===t.y}if(arguments.length===2){var e=arguments[0],n=arguments[1];return!!Te.equalsWithTolerance(this.x,e.x,n)&&!!Te.equalsWithTolerance(this.y,e.y,n)}}},{key:"setM",value:function(t){throw new P("Invalid ordinate index: "+r.M)}},{key:"getZ",value:function(){return this.z}},{key:"getOrdinate",value:function(t){switch(t){case r.X:return this.x;case r.Y:return this.y;case r.Z:return this.getZ()}throw new P("Invalid ordinate index: "+t)}},{key:"equals3D",value:function(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||I.isNaN(this.getZ())&&I.isNaN(t.getZ()))}},{key:"equals",value:function(t){return t instanceof r&&this.equals2D(t)}},{key:"equalInZ",value:function(t,e){return Te.equalsWithTolerance(this.getZ(),t.getZ(),e)}},{key:"setX",value:function(t){this.x=t}},{key:"compareTo",value:function(t){var e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}},{key:"getX",value:function(){return this.x}},{key:"setZ",value:function(t){this.z=t}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return A.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}}},{key:"copy",value:function(){return new r(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}},{key:"distance3D",value:function(t){var e=this.x-t.x,n=this.y-t.y,i=this.getZ()-t.getZ();return Math.sqrt(e*e+n*n+i*i)}},{key:"getY",value:function(){return this.y}},{key:"setY",value:function(t){this.y=t}},{key:"distance",value:function(t){var e=this.x-t.x,n=this.y-t.y;return Math.sqrt(e*e+n*n)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*t+r.hashCode(this.x))+r.hashCode(this.y)}},{key:"setCoordinate",value:function(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}},{key:"interfaces_",get:function(){return[j,Xt,Z]}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)r.constructor_.call(this,0,0);else if(arguments.length===1){var t=arguments[0];r.constructor_.call(this,t.x,t.y,t.getZ())}else if(arguments.length===2){var e=arguments[0],n=arguments[1];r.constructor_.call(this,e,n,r.NULL_ORDINATE)}else if(arguments.length===3){var i=arguments[0],s=arguments[1],a=arguments[2];this.x=i,this.y=s,this.z=a}}},{key:"hashCode",value:function(t){return Vn[0]=t,Je[0]^Je[1]}}]),r}(),Hn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"compare",value:function(t,e){var n=r.compare(t.x,e.x);if(n!==0)return n;var i=r.compare(t.y,e.y);return i!==0?i:this._dimensionsToTest<=2?0:r.compare(t.getZ(),e.getZ())}},{key:"interfaces_",get:function(){return[Ht]}}],[{key:"constructor_",value:function(){if(this._dimensionsToTest=2,arguments.length===0)r.constructor_.call(this,2);else if(arguments.length===1){var t=arguments[0];if(t!==2&&t!==3)throw new P("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}},{key:"compare",value:function(t,e){return t<e?-1:t>e?1:I.isNaN(t)?I.isNaN(e)?0:-1:I.isNaN(e)?1:0}}]),r}();v.DimensionalComparator=Hn,v.NULL_ORDINATE=I.NaN,v.X=0,v.Y=1,v.Z=2,v.M=3;var z=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getArea",value:function(){return this.getWidth()*this.getHeight()}},{key:"equals",value:function(t){if(!(t instanceof r))return!1;var e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}},{key:"intersection",value:function(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new r;var e=this._minx>t._minx?this._minx:t._minx,n=this._miny>t._miny?this._miny:t._miny;return new r(e,this._maxx<t._maxx?this._maxx:t._maxx,n,this._maxy<t._maxy?this._maxy:t._maxy)}},{key:"isNull",value:function(){return this._maxx<this._minx}},{key:"getMaxX",value:function(){return this._maxx}},{key:"covers",value:function(){if(arguments.length===1){if(arguments[0]instanceof v){var t=arguments[0];return this.covers(t.x,t.y)}if(arguments[0]instanceof r){var e=arguments[0];return!this.isNull()&&!e.isNull()&&e.getMinX()>=this._minx&&e.getMaxX()<=this._maxx&&e.getMinY()>=this._miny&&e.getMaxY()<=this._maxy}}else if(arguments.length===2){var n=arguments[0],i=arguments[1];return!this.isNull()&&n>=this._minx&&n<=this._maxx&&i>=this._miny&&i<=this._maxy}}},{key:"intersects",value:function(){if(arguments.length===1){if(arguments[0]instanceof r){var t=arguments[0];return!this.isNull()&&!t.isNull()&&!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}if(arguments[0]instanceof v){var e=arguments[0];return this.intersects(e.x,e.y)}}else if(arguments.length===2){if(arguments[0]instanceof v&&arguments[1]instanceof v){var n=arguments[0],i=arguments[1];if(this.isNull())return!1;var s=n.x<i.x?n.x:i.x;if(s>this._maxx)return!1;var a=n.x>i.x?n.x:i.x;if(a<this._minx)return!1;var u=n.y<i.y?n.y:i.y;if(u>this._maxy)return!1;var o=n.y>i.y?n.y:i.y;return!(o<this._miny)}if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var l=arguments[0],c=arguments[1];return!this.isNull()&&!(l>this._maxx||l<this._minx||c>this._maxy||c<this._miny)}}}},{key:"getMinY",value:function(){return this._miny}},{key:"getDiameter",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}},{key:"getMinX",value:function(){return this._minx}},{key:"expandToInclude",value:function(){if(arguments.length===1){if(arguments[0]instanceof v){var t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof r){var e=arguments[0];if(e.isNull())return null;this.isNull()?(this._minx=e.getMinX(),this._maxx=e.getMaxX(),this._miny=e.getMinY(),this._maxy=e.getMaxY()):(e._minx<this._minx&&(this._minx=e._minx),e._maxx>this._maxx&&(this._maxx=e._maxx),e._miny<this._miny&&(this._miny=e._miny),e._maxy>this._maxy&&(this._maxy=e._maxy))}}else if(arguments.length===2){var n=arguments[0],i=arguments[1];this.isNull()?(this._minx=n,this._maxx=n,this._miny=i,this._maxy=i):(n<this._minx&&(this._minx=n),n>this._maxx&&(this._maxx=n),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}}},{key:"minExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t<e?t:e}},{key:"getWidth",value:function(){return this.isNull()?0:this._maxx-this._minx}},{key:"compareTo",value:function(t){var e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}},{key:"translate",value:function(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}},{key:"copy",value:function(){return new r(this)}},{key:"toString",value:function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}},{key:"setToNull",value:function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}},{key:"disjoint",value:function(t){return!(!this.isNull()&&!t.isNull())||t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny}},{key:"getHeight",value:function(){return this.isNull()?0:this._maxy-this._miny}},{key:"maxExtent",value:function(){if(this.isNull())return 0;var t=this.getWidth(),e=this.getHeight();return t>e?t:e}},{key:"expandBy",value:function(){if(arguments.length===1){var t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];if(this.isNull())return null;this._minx-=e,this._maxx+=e,this._miny-=n,this._maxy+=n,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}},{key:"contains",value:function(){if(arguments.length===1){if(arguments[0]instanceof r){var t=arguments[0];return this.covers(t)}if(arguments[0]instanceof v){var e=arguments[0];return this.covers(e)}}else if(arguments.length===2){var n=arguments[0],i=arguments[1];return this.covers(n,i)}}},{key:"centre",value:function(){return this.isNull()?null:new v((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}},{key:"init",value:function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof v){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof r){var e=arguments[0];this._minx=e._minx,this._maxx=e._maxx,this._miny=e._miny,this._maxy=e._maxy}}else if(arguments.length===2){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(arguments.length===4){var s=arguments[0],a=arguments[1],u=arguments[2],o=arguments[3];s<a?(this._minx=s,this._maxx=a):(this._minx=a,this._maxx=s),u<o?(this._miny=u,this._maxy=o):(this._miny=o,this._maxy=u)}}},{key:"getMaxY",value:function(){return this._maxy}},{key:"distance",value:function(t){if(this.intersects(t))return 0;var e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);var n=0;return this._maxy<t._miny?n=t._miny-this._maxy:this._miny>t._maxy&&(n=this._miny-t._maxy),e===0?n:n===0?e:Math.sqrt(e*e+n*n)}},{key:"hashCode",value:function(){var t=17;return t=37*(t=37*(t=37*(t=37*t+v.hashCode(this._minx))+v.hashCode(this._maxx))+v.hashCode(this._miny))+v.hashCode(this._maxy)}},{key:"interfaces_",get:function(){return[j,Z]}}],[{key:"constructor_",value:function(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof v){var t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof r){var e=arguments[0];this.init(e)}}else if(arguments.length===2){var n=arguments[0],i=arguments[1];this.init(n.x,i.x,n.y,i.y)}else if(arguments.length===4){var s=arguments[0],a=arguments[1],u=arguments[2],o=arguments[3];this.init(s,a,u,o)}}},{key:"intersects",value:function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],n=arguments[2];return n.x>=(t.x<e.x?t.x:e.x)&&n.x<=(t.x>e.x?t.x:e.x)&&n.y>=(t.y<e.y?t.y:e.y)&&n.y<=(t.y>e.y?t.y:e.y)}if(arguments.length===4){var i=arguments[0],s=arguments[1],a=arguments[2],u=arguments[3],o=Math.min(a.x,u.x),l=Math.max(a.x,u.x),c=Math.min(i.x,s.x),g=Math.max(i.x,s.x);return!(c>l)&&!(g<o)&&(o=Math.min(a.y,u.y),l=Math.max(a.y,u.y),c=Math.min(i.y,s.y),g=Math.max(i.y,s.y),!(c>l)&&!(g<o))}}}]),r}(),E=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"isGeometryCollection",value:function(){return this.getTypeCode()===r.TYPECODE_GEOMETRYCOLLECTION}},{key:"getFactory",value:function(){return this._factory}},{key:"getGeometryN",value:function(t){return this}},{key:"getArea",value:function(){return 0}},{key:"isRectangle",value:function(){return!1}},{key:"equalsExact",value:function(t){return this===t||this.equalsExact(t,0)}},{key:"geometryChanged",value:function(){this.apply(r.geometryChangedFilter)}},{key:"geometryChangedAction",value:function(){this._envelope=null}},{key:"equalsNorm",value:function(t){return t!==null&&this.norm().equalsExact(t.norm())}},{key:"getLength",value:function(){return 0}},{key:"getNumGeometries",value:function(){return 1}},{key:"compareTo",value:function(){var t;if(arguments.length===1){var e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}if(arguments.length===2){var n=arguments[0],i=arguments[1];return t=n,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(n,i)}}},{key:"getUserData",value:function(){return this._userData}},{key:"getSRID",value:function(){return this._SRID}},{key:"getEnvelope",value:function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}},{key:"checkNotGeometryCollection",value:function(t){if(t.getTypeCode()===r.TYPECODE_GEOMETRYCOLLECTION)throw new P("This method does not support GeometryCollection arguments")}},{key:"equal",value:function(t,e,n){return n===0?t.equals(e):t.distance(e)<=n}},{key:"norm",value:function(){var t=this.copy();return t.normalize(),t}},{key:"reverse",value:function(){var t=this.reverseInternal();return this.envelope!=null&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}},{key:"copy",value:function(){var t=this.copyInternal();return t.envelope=this._envelope==null?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}},{key:"getPrecisionModel",value:function(){return this._factory.getPrecisionModel()}},{key:"getEnvelopeInternal",value:function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new z(this._envelope)}},{key:"setSRID",value:function(t){this._SRID=t}},{key:"setUserData",value:function(t){this._userData=t}},{key:"compare",value:function(t,e){for(var n=t.iterator(),i=e.iterator();n.hasNext()&&i.hasNext();){var s=n.next(),a=i.next(),u=s.compareTo(a);if(u!==0)return u}return n.hasNext()?1:i.hasNext()?-1:0}},{key:"hashCode",value:function(){return this.getEnvelopeInternal().hashCode()}},{key:"isEquivalentClass",value:function(t){return this.getClass()===t.getClass()}},{key:"isGeometryCollectionOrDerived",value:function(){return this.getTypeCode()===r.TYPECODE_GEOMETRYCOLLECTION||this.getTypeCode()===r.TYPECODE_MULTIPOINT||this.getTypeCode()===r.TYPECODE_MULTILINESTRING||this.getTypeCode()===r.TYPECODE_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[Xt,j,Z]}},{key:"getClass",value:function(){return r}}],[{key:"hasNonEmptyElements",value:function(t){for(var e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}},{key:"hasNullElements",value:function(t){for(var e=0;e<t.length;e++)if(t[e]===null)return!0;return!1}}]),r}();E.constructor_=function(r){r&&(this._envelope=null,this._userData=null,this._factory=r,this._SRID=r.getSRID())},E.TYPECODE_POINT=0,E.TYPECODE_MULTIPOINT=1,E.TYPECODE_LINESTRING=2,E.TYPECODE_LINEARRING=3,E.TYPECODE_MULTILINESTRING=4,E.TYPECODE_POLYGON=5,E.TYPECODE_MULTIPOLYGON=6,E.TYPECODE_GEOMETRYCOLLECTION=7,E.TYPENAME_POINT="Point",E.TYPENAME_MULTIPOINT="MultiPoint",E.TYPENAME_LINESTRING="LineString",E.TYPENAME_LINEARRING="LinearRing",E.TYPENAME_MULTILINESTRING="MultiLineString",E.TYPENAME_POLYGON="Polygon",E.TYPENAME_MULTIPOLYGON="MultiPolygon",E.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection",E.geometryChangedFilter={get interfaces_(){return[zt]},filter:function(r){r.geometryChangedAction()}};var h=function(){function r(){f(this,r)}return m(r,null,[{key:"toLocationSymbol",value:function(t){switch(t){case r.EXTERIOR:return"e";case r.BOUNDARY:return"b";case r.INTERIOR:return"i";case r.NONE:return"-"}throw new P("Unknown location value: "+t)}}]),r}();h.INTERIOR=0,h.BOUNDARY=1,h.EXTERIOR=2,h.NONE=-1;var ot=function(){function r(){f(this,r)}return m(r,[{key:"add",value:function(){}},{key:"addAll",value:function(){}},{key:"isEmpty",value:function(){}},{key:"iterator",value:function(){}},{key:"size",value:function(){}},{key:"toArray",value:function(){}},{key:"remove",value:function(){}}]),r}(),oe=function(r){C(e,r);var t=R(e);function e(n){var i;return f(this,e),(i=t.call(this,n)).name=Object.keys({NoSuchElementException:e})[0],i}return e}(mt),pt=function(r){C(e,r);var t=R(e);function e(n){var i;return f(this,e),(i=t.call(this,n)).name=Object.keys({UnsupportedOperationException:e})[0],i}return e}(mt),Qe=function(r){C(e,r);var t=R(e);function e(){return f(this,e),t.apply(this,arguments)}return m(e,[{key:"contains",value:function(){}}]),e}(ot),Se=function(r,t){C(n,r);var e=R(n);function n(i){var s;return f(this,n),(s=e.call(this)).map=new Map,i instanceof ot&&s.addAll(i),s}return m(n,[{key:"contains",value:function(i){var s=i.hashCode?i.hashCode():i;return!!this.map.has(s)}},{key:"add",value:function(i){var s=i.hashCode?i.hashCode():i;return!this.map.has(s)&&!!this.map.set(s,i)}},{key:"addAll",value:function(i){var s,a=ft(i);try{for(a.s();!(s=a.n()).done;){var u=s.value;this.add(u)}}catch(o){a.e(o)}finally{a.f()}return!0}},{key:"remove",value:function(){throw new pt}},{key:"size",value:function(){return this.map.size}},{key:"isEmpty",value:function(){return this.map.size===0}},{key:"toArray",value:function(){return Array.from(this.map.values())}},{key:"iterator",value:function(){return new Zn(this.map)}},{key:t,value:function(){return this.map}}]),n}(Qe,Symbol.iterator),Zn=function(){function r(t){f(this,r),this.iterator=t.values();var e=this.iterator.next(),n=e.done,i=e.value;this.done=n,this.value=i}return m(r,[{key:"next",value:function(){if(this.done)throw new oe;var t=this.value,e=this.iterator.next(),n=e.done,i=e.value;return this.done=n,this.value=i,t}},{key:"hasNext",value:function(){return!this.done}},{key:"remove",value:function(){throw new pt}}]),r}(),p=function(){function r(){f(this,r)}return m(r,null,[{key:"opposite",value:function(t){return t===r.LEFT?r.RIGHT:t===r.RIGHT?r.LEFT:t}}]),r}();p.ON=0,p.LEFT=1,p.RIGHT=2;var $e=function(r){C(e,r);var t=R(e);function e(n){var i;return f(this,e),(i=t.call(this,n)).name=Object.keys({EmptyStackException:e})[0],i}return e}(mt),tn=function(r){C(e,r);var t=R(e);function e(n){var i;return f(this,e),(i=t.call(this,n)).name=Object.keys({IndexOutOfBoundsException:e})[0],i}return e}(mt),Et=function(r){C(e,r);var t=R(e);function e(){return f(this,e),t.apply(this,arguments)}return m(e,[{key:"get",value:function(){}},{key:"set",value:function(){}},{key:"isEmpty",value:function(){}}]),e}(ot),jn=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),(n=t.call(this)).array=[],n}return m(e,[{key:"add",value:function(n){return this.array.push(n),!0}},{key:"get",value:function(n){if(n<0||n>=this.size())throw new tn;return this.array[n]}},{key:"push",value:function(n){return this.array.push(n),n}},{key:"pop",value:function(){if(this.array.length===0)throw new $e;return this.array.pop()}},{key:"peek",value:function(){if(this.array.length===0)throw new $e;return this.array[this.array.length-1]}},{key:"empty",value:function(){return this.array.length===0}},{key:"isEmpty",value:function(){return this.empty()}},{key:"search",value:function(n){return this.array.indexOf(n)}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}}]),e}(Et);function b(r,t){return r.interfaces_&&r.interfaces_.indexOf(t)>-1}var Zt=function(){function r(t){f(this,r),this.str=t}return m(r,[{key:"append",value:function(t){this.str+=t}},{key:"setCharAt",value:function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}},{key:"toString",value:function(){return this.str}}]),r}(),le=function(){function r(t){f(this,r),this.value=t}return m(r,[{key:"intValue",value:function(){return this.value}},{key:"compareTo",value:function(t){return this.value<t?-1:this.value>t?1:0}}],[{key:"compare",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"isNan",value:function(t){return Number.isNaN(t)}},{key:"valueOf",value:function(t){return new r(t)}}]),r}(),Le=function(){function r(){f(this,r)}return m(r,null,[{key:"isWhitespace",value:function(t){return t<=32&&t>=0||t===127}},{key:"toUpperCase",value:function(t){return t.toUpperCase()}}]),r}(),S=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"le",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}},{key:"extractSignificantDigits",value:function(t,e){var n=this.abs(),i=r.magnitude(n._hi),s=r.TEN.pow(i);(n=n.divide(s)).gt(r.TEN)?(n=n.divide(r.TEN),i+=1):n.lt(r.ONE)&&(n=n.multiply(r.TEN),i-=1);for(var a=i+1,u=new Zt,o=r.MAX_PRINT_DIGITS-1,l=0;l<=o;l++){t&&l===a&&u.append(".");var c=Math.trunc(n._hi);if(c<0)break;var g=!1,y=0;c>9?(g=!0,y="9"):y="0"+c,u.append(y),n=n.subtract(r.valueOf(c)).multiply(r.TEN),g&&n.selfAdd(r.TEN);var _=!0,d=r.magnitude(n._hi);if(d<0&&Math.abs(d)>=o-l&&(_=!1),!_)break}return e[0]=i,u.toString()}},{key:"sqr",value:function(){return this.multiply(this)}},{key:"doubleValue",value:function(){return this._hi+this._lo}},{key:"subtract",value:function(){if(arguments[0]instanceof r){var t=arguments[0];return this.add(t.negate())}if(typeof arguments[0]=="number"){var e=arguments[0];return this.add(-e)}}},{key:"equals",value:function(){if(arguments.length===1&&arguments[0]instanceof r){var t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}},{key:"isZero",value:function(){return this._hi===0&&this._lo===0}},{key:"selfSubtract",value:function(){if(arguments[0]instanceof r){var t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e,0)}}},{key:"getSpecialNumberString",value:function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}},{key:"min",value:function(t){return this.le(t)?this:t}},{key:"selfDivide",value:function(){if(arguments.length===1){if(arguments[0]instanceof r){var t=arguments[0];return this.selfDivide(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfDivide(e,0)}}else if(arguments.length===2){var n=arguments[0],i=arguments[1],s=null,a=null,u=null,o=null,l=null,c=null,g=null,y=null;return l=this._hi/n,y=(s=(c=r.SPLIT*l)-(s=c-l))*(u=(y=r.SPLIT*n)-(u=y-n))-(g=l*n)+s*(o=n-u)+(a=l-s)*u+a*o,y=l+(c=(this._hi-g-y+this._lo-l*i)/n),this._hi=y,this._lo=l-y+c,this}}},{key:"dump",value:function(){return"DD<"+this._hi+", "+this._lo+">"}},{key:"divide",value:function(){if(arguments[0]instanceof r){var t=arguments[0],e=null,n=null,i=null,s=null,a=null,u=null,o=null,l=null;n=(a=this._hi/t._hi)-(e=(u=r.SPLIT*a)-(e=u-a)),l=e*(i=(l=r.SPLIT*t._hi)-(i=l-t._hi))-(o=a*t._hi)+e*(s=t._hi-i)+n*i+n*s;var c=l=a+(u=(this._hi-o-l+this._lo-a*t._lo)/t._hi),g=a-l+u;return new r(c,g)}if(typeof arguments[0]=="number"){var y=arguments[0];return I.isNaN(y)?r.createNaN():r.copy(this).selfDivide(y,0)}}},{key:"ge",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}},{key:"pow",value:function(t){if(t===0)return r.valueOf(1);var e=new r(this),n=r.valueOf(1),i=Math.abs(t);if(i>1)for(;i>0;)i%2==1&&n.selfMultiply(e),(i/=2)>0&&(e=e.sqr());else n=e;return t<0?n.reciprocal():n}},{key:"ceil",value:function(){if(this.isNaN())return r.NaN;var t=Math.ceil(this._hi),e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new r(t,e)}},{key:"compareTo",value:function(t){var e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}},{key:"rint",value:function(){return this.isNaN()?this:this.add(.5).floor()}},{key:"setValue",value:function(){if(arguments[0]instanceof r){var t=arguments[0];return this.init(t),this}if(typeof arguments[0]=="number"){var e=arguments[0];return this.init(e),this}}},{key:"max",value:function(t){return this.ge(t)?this:t}},{key:"sqrt",value:function(){if(this.isZero())return r.valueOf(0);if(this.isNegative())return r.NaN;var t=1/Math.sqrt(this._hi),e=this._hi*t,n=r.valueOf(e),i=this.subtract(n.sqr())._hi*(.5*t);return n.add(i)}},{key:"selfAdd",value:function(){if(arguments.length===1){if(arguments[0]instanceof r){var t=arguments[0];return this.selfAdd(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0],n=null,i=null,s=null,a=null,u=null,o=null;return a=(s=this._hi+e)-(u=s-this._hi),i=(o=(a=e-u+(this._hi-a))+this._lo)+(s-(n=s+o)),this._hi=n+i,this._lo=i+(n-this._hi),this}}else if(arguments.length===2){var l=arguments[0],c=arguments[1],g=null,y=null,_=null,d=null,x=null,N=null,w=null;d=this._hi+l,y=this._lo+c,x=d-(N=d-this._hi),_=y-(w=y-this._lo);var G=(g=d+(N=(x=l-N+(this._hi-x))+y))+(N=(_=c-w+(this._lo-_))+(N+(d-g))),U=N+(g-G);return this._hi=G,this._lo=U,this}}},{key:"selfMultiply",value:function(){if(arguments.length===1){if(arguments[0]instanceof r){var t=arguments[0];return this.selfMultiply(t._hi,t._lo)}if(typeof arguments[0]=="number"){var e=arguments[0];return this.selfMultiply(e,0)}}else if(arguments.length===2){var n=arguments[0],i=arguments[1],s=null,a=null,u=null,o=null,l=null,c=null;s=(l=r.SPLIT*this._hi)-this._hi,c=r.SPLIT*n,s=l-s,a=this._hi-s,u=c-n;var g=(l=this._hi*n)+(c=s*(u=c-u)-l+s*(o=n-u)+a*u+a*o+(this._hi*i+this._lo*n)),y=c+(s=l-g);return this._hi=g,this._lo=y,this}}},{key:"selfSqr",value:function(){return this.selfMultiply(this)}},{key:"floor",value:function(){if(this.isNaN())return r.NaN;var t=Math.floor(this._hi),e=0;return t===this._hi&&(e=Math.floor(this._lo)),new r(t,e)}},{key:"negate",value:function(){return this.isNaN()?this:new r(-this._hi,-this._lo)}},{key:"clone",value:function(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}}},{key:"multiply",value:function(){if(arguments[0]instanceof r){var t=arguments[0];return t.isNaN()?r.createNaN():r.copy(this).selfMultiply(t)}if(typeof arguments[0]=="number"){var e=arguments[0];return I.isNaN(e)?r.createNaN():r.copy(this).selfMultiply(e,0)}}},{key:"isNaN",value:function(){return I.isNaN(this._hi)}},{key:"intValue",value:function(){return Math.trunc(this._hi)}},{key:"toString",value:function(){var t=r.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}},{key:"toStandardNotation",value:function(){var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!0,e),i=e[0]+1,s=n;if(n.charAt(0)===".")s="0"+n;else if(i<0)s="0."+r.stringOfChar("0",-i)+n;else if(n.indexOf(".")===-1){var a=i-n.length;s=n+r.stringOfChar("0",a)+".0"}return this.isNegative()?"-"+s:s}},{key:"reciprocal",value:function(){var t,e,n,i,s=null,a=null,u=null,o=null;t=(n=1/this._hi)-(s=(u=r.SPLIT*n)-(s=u-n)),a=(o=r.SPLIT*this._hi)-this._hi;var l=n+(u=(1-(i=n*this._hi)-(o=s*(a=o-a)-i+s*(e=this._hi-a)+t*a+t*e)-n*this._lo)/this._hi);return new r(l,n-l+u)}},{key:"toSciNotation",value:function(){if(this.isZero())return r.SCI_NOT_ZERO;var t=this.getSpecialNumberString();if(t!==null)return t;var e=new Array(1).fill(null),n=this.extractSignificantDigits(!1,e),i=r.SCI_NOT_EXPONENT_CHAR+e[0];if(n.charAt(0)==="0")throw new IllegalStateException("Found leading zero: "+n);var s="";n.length>1&&(s=n.substring(1));var a=n.charAt(0)+"."+s;return this.isNegative()?"-"+a+i:a+i}},{key:"abs",value:function(){return this.isNaN()?r.NaN:this.isNegative()?this.negate():new r(this)}},{key:"isPositive",value:function(){return this._hi>0||this._hi===0&&this._lo>0}},{key:"lt",value:function(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}},{key:"add",value:function(){if(arguments[0]instanceof r){var t=arguments[0];return r.copy(this).selfAdd(t)}if(typeof arguments[0]=="number"){var e=arguments[0];return r.copy(this).selfAdd(e)}}},{key:"init",value:function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof r){var e=arguments[0];this._hi=e._hi,this._lo=e._lo}}else if(arguments.length===2){var n=arguments[0],i=arguments[1];this._hi=n,this._lo=i}}},{key:"gt",value:function(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}},{key:"isNegative",value:function(){return this._hi<0||this._hi===0&&this._lo<0}},{key:"trunc",value:function(){return this.isNaN()?r.NaN:this.isPositive()?this.floor():this.ceil()}},{key:"signum",value:function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}},{key:"interfaces_",get:function(){return[Z,j,Xt]}}],[{key:"constructor_",value:function(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var t=arguments[0];this.init(t)}else if(arguments[0]instanceof r){var e=arguments[0];this.init(e)}else if(typeof arguments[0]=="string"){var n=arguments[0];r.constructor_.call(this,r.parse(n))}}else if(arguments.length===2){var i=arguments[0],s=arguments[1];this.init(i,s)}}},{key:"determinant",value:function(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];return r.determinant(r.valueOf(t),r.valueOf(e),r.valueOf(n),r.valueOf(i))}if(arguments[3]instanceof r&&arguments[2]instanceof r&&arguments[0]instanceof r&&arguments[1]instanceof r){var s=arguments[0],a=arguments[1],u=arguments[2],o=arguments[3],l=s.multiply(o).selfSubtract(a.multiply(u));return l}}},{key:"sqr",value:function(t){return r.valueOf(t).selfMultiply(t)}},{key:"valueOf",value:function(){if(typeof arguments[0]=="string"){var t=arguments[0];return r.parse(t)}if(typeof arguments[0]=="number"){var e=arguments[0];return new r(e)}}},{key:"sqrt",value:function(t){return r.valueOf(t).sqrt()}},{key:"parse",value:function(t){for(var e=0,n=t.length;Le.isWhitespace(t.charAt(e));)e++;var i=!1;if(e<n){var s=t.charAt(e);s!=="-"&&s!=="+"||(e++,s==="-"&&(i=!0))}for(var a=new r,u=0,o=0,l=0,c=!1;!(e>=n);){var g=t.charAt(e);if(e++,Le.isDigit(g)){var y=g-"0";a.selfMultiply(r.TEN),a.selfAdd(y),u++}else{if(g!=="."){if(g==="e"||g==="E"){var _=t.substring(e);try{l=le.parseInt(_)}catch(G){throw G instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+_+" in string "+t):G}break}throw new NumberFormatException("Unexpected character '"+g+"' at position "+e+" in string "+t)}o=u,c=!0}}var d=a;c||(o=u);var x=u-o-l;if(x===0)d=a;else if(x>0){var N=r.TEN.pow(x);d=a.divide(N)}else if(x<0){var w=r.TEN.pow(-x);d=a.multiply(w)}return i?d.negate():d}},{key:"createNaN",value:function(){return new r(I.NaN,I.NaN)}},{key:"copy",value:function(t){return new r(t)}},{key:"magnitude",value:function(t){var e=Math.abs(t),n=Math.log(e)/Math.log(10),i=Math.trunc(Math.floor(n));return 10*Math.pow(10,i)<=e&&(i+=1),i}},{key:"stringOfChar",value:function(t,e){for(var n=new Zt,i=0;i<e;i++)n.append(t);return n.toString()}}]),r}();S.PI=new S(3.141592653589793,12246467991473532e-32),S.TWO_PI=new S(6.283185307179586,24492935982947064e-32),S.PI_2=new S(1.5707963267948966,6123233995736766e-32),S.E=new S(2.718281828459045,14456468917292502e-32),S.NaN=new S(I.NaN,I.NaN),S.EPS=123259516440783e-46,S.SPLIT=134217729,S.MAX_PRINT_DIGITS=32,S.TEN=S.valueOf(10),S.ONE=S.valueOf(1),S.SCI_NOT_EXPONENT_CHAR="E",S.SCI_NOT_ZERO="0.0E0";var Ce=function(){function r(){f(this,r)}return m(r,null,[{key:"orientationIndex",value:function(t,e,n){var i=r.orientationIndexFilter(t,e,n);if(i<=1)return i;var s=S.valueOf(e.x).selfAdd(-t.x),a=S.valueOf(e.y).selfAdd(-t.y),u=S.valueOf(n.x).selfAdd(-e.x),o=S.valueOf(n.y).selfAdd(-e.y);return s.selfMultiply(o).selfSubtract(a.selfMultiply(u)).signum()}},{key:"signOfDet2x2",value:function(){if(arguments[3]instanceof S&&arguments[2]instanceof S&&arguments[0]instanceof S&&arguments[1]instanceof S){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3],s=t.multiply(i).selfSubtract(e.multiply(n));return s.signum()}if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var a=arguments[0],u=arguments[1],o=arguments[2],l=arguments[3],c=S.valueOf(a),g=S.valueOf(u),y=S.valueOf(o),_=S.valueOf(l),d=c.multiply(_).selfSubtract(g.multiply(y));return d.signum()}}},{key:"intersection",value:function(t,e,n,i){var s=new S(t.y).selfSubtract(e.y),a=new S(e.x).selfSubtract(t.x),u=new S(t.x).selfMultiply(e.y).selfSubtract(new S(e.x).selfMultiply(t.y)),o=new S(n.y).selfSubtract(i.y),l=new S(i.x).selfSubtract(n.x),c=new S(n.x).selfMultiply(i.y).selfSubtract(new S(i.x).selfMultiply(n.y)),g=a.multiply(c).selfSubtract(l.multiply(u)),y=o.multiply(u).selfSubtract(s.multiply(c)),_=s.multiply(l).selfSubtract(o.multiply(a)),d=g.selfDivide(_).doubleValue(),x=y.selfDivide(_).doubleValue();return I.isNaN(d)||I.isInfinite(d)||I.isNaN(x)||I.isInfinite(x)?null:new v(d,x)}},{key:"orientationIndexFilter",value:function(t,e,n){var i=null,s=(t.x-n.x)*(e.y-n.y),a=(t.y-n.y)*(e.x-n.x),u=s-a;if(s>0){if(a<=0)return r.signum(u);i=s+a}else{if(!(s<0)||a>=0)return r.signum(u);i=-s-a}var o=r.DP_SAFE_EPSILON*i;return u>=o||-u>=o?r.signum(u):2}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}}]),r}();Ce.DP_SAFE_EPSILON=1e-15;var D=function(){function r(){f(this,r)}return m(r,[{key:"getM",value:function(t){if(this.hasM()){var e=this.getDimension()-this.getMeasures();return this.getOrdinate(t,e)}return I.NaN}},{key:"setOrdinate",value:function(t,e,n){}},{key:"getZ",value:function(t){return this.hasZ()?this.getOrdinate(t,2):I.NaN}},{key:"size",value:function(){}},{key:"getOrdinate",value:function(t,e){}},{key:"getCoordinate",value:function(){}},{key:"getCoordinateCopy",value:function(t){}},{key:"createCoordinate",value:function(){}},{key:"getDimension",value:function(){}},{key:"hasM",value:function(){return this.getMeasures()>0}},{key:"getX",value:function(t){}},{key:"hasZ",value:function(){return this.getDimension()-this.getMeasures()>2}},{key:"getMeasures",value:function(){return 0}},{key:"expandEnvelope",value:function(t){}},{key:"copy",value:function(){}},{key:"getY",value:function(t){}},{key:"toCoordinateArray",value:function(){}},{key:"interfaces_",get:function(){return[Xt]}}]),r}();D.X=0,D.Y=1,D.Z=2,D.M=3;var L=function(){function r(){f(this,r)}return m(r,null,[{key:"index",value:function(t,e,n){return Ce.orientationIndex(t,e,n)}},{key:"isCCW",value:function(){if(arguments[0]instanceof Array){var t=arguments[0],e=t.length-1;if(e<3)throw new P("Ring has fewer than 4 points, so orientation cannot be determined");for(var n=t[0],i=0,s=1;s<=e;s++){var a=t[s];a.y>n.y&&(n=a,i=s)}var u=i;do(u-=1)<0&&(u=e);while(t[u].equals2D(n)&&u!==i);var o=i;do o=(o+1)%e;while(t[o].equals2D(n)&&o!==i);var l=t[u],c=t[o];if(l.equals2D(n)||c.equals2D(n)||l.equals2D(c))return!1;var g=r.index(l,n,c),y=null;return y=g===0?l.x>c.x:g>0,y}if(b(arguments[0],D)){var _=arguments[0],d=_.size()-1;if(d<3)throw new P("Ring has fewer than 4 points, so orientation cannot be determined");for(var x=_.getCoordinate(0),N=0,w=1;w<=d;w++){var G=_.getCoordinate(w);G.y>x.y&&(x=G,N=w)}var U=null,V=N;do(V-=1)<0&&(V=d),U=_.getCoordinate(V);while(U.equals2D(x)&&V!==N);var Q=null,at=N;do at=(at+1)%d,Q=_.getCoordinate(at);while(Q.equals2D(x)&&at!==N);if(U.equals2D(x)||Q.equals2D(x)||U.equals2D(Q))return!1;var _t=r.index(U,x,Q);return _t===0?U.x>Q.x:_t>0}}}]),r}();L.CLOCKWISE=-1,L.RIGHT=L.CLOCKWISE,L.COUNTERCLOCKWISE=1,L.LEFT=L.COUNTERCLOCKWISE,L.COLLINEAR=0,L.STRAIGHT=L.COLLINEAR;var Wn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getCoordinate",value:function(){return this._minCoord}},{key:"getRightmostSide",value:function(t,e){var n=this.getRightmostSideOfSegment(t,e);return n<0&&(n=this.getRightmostSideOfSegment(t,e-1)),n<0&&(this._minCoord=null,this.checkForRightmostCoordinate(t)),n}},{key:"findRightmostEdgeAtVertex",value:function(){var t=this._minDe.getEdge().getCoordinates();A.isTrue(this._minIndex>0&&this._minIndex<t.length,"rightmost point expected to be interior vertex of edge");var e=t[this._minIndex-1],n=t[this._minIndex+1],i=L.index(this._minCoord,n,e),s=!1;(e.y<this._minCoord.y&&n.y<this._minCoord.y&&i===L.COUNTERCLOCKWISE||e.y>this._minCoord.y&&n.y>this._minCoord.y&&i===L.CLOCKWISE)&&(s=!0),s&&(this._minIndex=this._minIndex-1)}},{key:"getRightmostSideOfSegment",value:function(t,e){var n=t.getEdge().getCoordinates();if(e<0||e+1>=n.length||n[e].y===n[e+1].y)return-1;var i=p.LEFT;return n[e].y<n[e+1].y&&(i=p.RIGHT),i}},{key:"getEdge",value:function(){return this._orientedDe}},{key:"checkForRightmostCoordinate",value:function(t){for(var e=t.getEdge().getCoordinates(),n=0;n<e.length-1;n++)(this._minCoord===null||e[n].x>this._minCoord.x)&&(this._minDe=t,this._minIndex=n,this._minCoord=e[n])}},{key:"findRightmostEdgeAtNode",value:function(){var t=this._minDe.getNode().getEdges();this._minDe=t.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)}},{key:"findEdge",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();n.isForward()&&this.checkForRightmostCoordinate(n)}A.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe,this.getRightmostSide(this._minDe,this._minIndex)===p.LEFT&&(this._orientedDe=this._minDe.getSym())}}],[{key:"constructor_",value:function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null}}]),r}(),vt=function(r){C(e,r);var t=R(e);function e(n,i){var s;return f(this,e),(s=t.call(this,i?n+" [ "+i+" ]":n)).pt=i?new v(i):void 0,s.name=Object.keys({TopologyException:e})[0],s}return m(e,[{key:"getCoordinate",value:function(){return this.pt}}]),e}(ut),Kn=function(){function r(){f(this,r),this.array=[]}return m(r,[{key:"addLast",value:function(t){this.array.push(t)}},{key:"removeFirst",value:function(){return this.array.shift()}},{key:"isEmpty",value:function(){return this.array.length===0}}]),r}(),T=function(r,t){C(n,r);var e=R(n);function n(i){var s;return f(this,n),(s=e.call(this)).array=[],i instanceof ot&&s.addAll(i),s}return m(n,[{key:"interfaces_",get:function(){return[Et,ot]}},{key:"ensureCapacity",value:function(){}},{key:"add",value:function(i){return arguments.length===1?this.array.push(i):this.array.splice(arguments[0],0,arguments[1]),!0}},{key:"clear",value:function(){this.array=[]}},{key:"addAll",value:function(i){var s,a=ft(i);try{for(a.s();!(s=a.n()).done;){var u=s.value;this.array.push(u)}}catch(o){a.e(o)}finally{a.f()}}},{key:"set",value:function(i,s){var a=this.array[i];return this.array[i]=s,a}},{key:"iterator",value:function(){return new Jn(this)}},{key:"get",value:function(i){if(i<0||i>=this.size())throw new tn;return this.array[i]}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"sort",value:function(i){i?this.array.sort(function(s,a){return i.compare(s,a)}):this.array.sort()}},{key:"size",value:function(){return this.array.length}},{key:"toArray",value:function(){return this.array.slice()}},{key:"remove",value:function(i){for(var s=0,a=this.array.length;s<a;s++)if(this.array[s]===i)return!!this.array.splice(s,1);return!1}},{key:t,value:function(){return this.array.values()}}]),n}(Et,Symbol.iterator),Jn=function(){function r(t){f(this,r),this.arrayList=t,this.position=0}return m(r,[{key:"next",value:function(){if(this.position===this.arrayList.size())throw new oe;return this.arrayList.get(this.position++)}},{key:"hasNext",value:function(){return this.position<this.arrayList.size()}},{key:"set",value:function(t){return this.arrayList.set(this.position-1,t)}},{key:"remove",value:function(){this.arrayList.remove(this.arrayList.get(this.position))}}]),r}(),Qn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"clearVisitedEdges",value:function(){for(var t=this._dirEdgeList.iterator();t.hasNext();)t.next().setVisited(!1)}},{key:"getRightmostCoordinate",value:function(){return this._rightMostCoord}},{key:"computeNodeDepth",value:function(t){for(var e=null,n=t.getEdges().iterator();n.hasNext();){var i=n.next();if(i.isVisited()||i.getSym().isVisited()){e=i;break}}if(e===null)throw new vt("unable to find edge to compute depths at "+t.getCoordinate());t.getEdges().computeDepths(e);for(var s=t.getEdges().iterator();s.hasNext();){var a=s.next();a.setVisited(!0),this.copySymDepths(a)}}},{key:"computeDepth",value:function(t){this.clearVisitedEdges();var e=this._finder.getEdge();e.getNode(),e.getLabel(),e.setEdgeDepths(p.RIGHT,t),this.copySymDepths(e),this.computeDepths(e)}},{key:"create",value:function(t){this.addReachable(t),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()}},{key:"findResultEdges",value:function(){for(var t=this._dirEdgeList.iterator();t.hasNext();){var e=t.next();e.getDepth(p.RIGHT)>=1&&e.getDepth(p.LEFT)<=0&&!e.isInteriorAreaEdge()&&e.setInResult(!0)}}},{key:"computeDepths",value:function(t){var e=new Se,n=new Kn,i=t.getNode();for(n.addLast(i),e.add(i),t.setVisited(!0);!n.isEmpty();){var s=n.removeFirst();e.add(s),this.computeNodeDepth(s);for(var a=s.getEdges().iterator();a.hasNext();){var u=a.next().getSym();if(!u.isVisited()){var o=u.getNode();e.contains(o)||(n.addLast(o),e.add(o))}}}}},{key:"compareTo",value:function(t){var e=t;return this._rightMostCoord.x<e._rightMostCoord.x?-1:this._rightMostCoord.x>e._rightMostCoord.x?1:0}},{key:"getEnvelope",value:function(){if(this._env===null){for(var t=new z,e=this._dirEdgeList.iterator();e.hasNext();)for(var n=e.next().getEdge().getCoordinates(),i=0;i<n.length-1;i++)t.expandToInclude(n[i]);this._env=t}return this._env}},{key:"addReachable",value:function(t){var e=new jn;for(e.add(t);!e.empty();){var n=e.pop();this.add(n,e)}}},{key:"copySymDepths",value:function(t){var e=t.getSym();e.setDepth(p.LEFT,t.getDepth(p.RIGHT)),e.setDepth(p.RIGHT,t.getDepth(p.LEFT))}},{key:"add",value:function(t,e){t.setVisited(!0),this._nodes.add(t);for(var n=t.getEdges().iterator();n.hasNext();){var i=n.next();this._dirEdgeList.add(i);var s=i.getSym().getNode();s.isVisited()||e.push(s)}}},{key:"getNodes",value:function(){return this._nodes}},{key:"getDirectedEdges",value:function(){return this._dirEdgeList}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._finder=null,this._dirEdgeList=new T,this._nodes=new T,this._rightMostCoord=null,this._env=null,this._finder=new Wn}}]),r}(),Re=function(){function r(){f(this,r)}return m(r,null,[{key:"intersection",value:function(t,e,n,i){var s=t.x<e.x?t.x:e.x,a=t.y<e.y?t.y:e.y,u=t.x>e.x?t.x:e.x,o=t.y>e.y?t.y:e.y,l=n.x<i.x?n.x:i.x,c=n.y<i.y?n.y:i.y,g=n.x>i.x?n.x:i.x,y=n.y>i.y?n.y:i.y,_=((s>l?s:l)+(u<g?u:g))/2,d=((a>c?a:c)+(o<y?o:y))/2,x=t.x-_,N=t.y-d,w=e.x-_,G=e.y-d,U=n.x-_,V=n.y-d,Q=i.x-_,at=i.y-d,_t=N-G,wt=w-x,ne=x*G-w*N,ie=V-at,qt=Q-U,zn=U*at-Q*V,Xn=_t*qt-ie*wt,Ve=(wt*zn-qt*ne)/Xn,He=(ie*ne-_t*zn)/Xn;return I.isNaN(Ve)||I.isInfinite(Ve)||I.isNaN(He)||I.isInfinite(He)?null:new v(Ve+_,He+d)}}]),r}(),$=function(){function r(){f(this,r)}return m(r,null,[{key:"arraycopy",value:function(t,e,n,i,s){for(var a=0,u=e;u<e+s;u++)n[i+a]=t[u],a++}},{key:"getProperty",value:function(t){return{"line.separator":`
`}[t]}}]),r}(),jt=function(){function r(){f(this,r)}return m(r,null,[{key:"log10",value:function(t){var e=Math.log(t);return I.isInfinite(e)||I.isNaN(e)?e:e/r.LOG_10}},{key:"min",value:function(t,e,n,i){var s=t;return e<s&&(s=e),n<s&&(s=n),i<s&&(s=i),s}},{key:"clamp",value:function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1],n=arguments[2];return t<e?e:t>n?n:t}if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],s=arguments[1],a=arguments[2];return i<s?s:i>a?a:i}}},{key:"wrap",value:function(t,e){return t<0?e- -t%e:t%e}},{key:"max",value:function(){if(arguments.length===3){var t=arguments[0],e=arguments[1],n=arguments[2],i=t;return e>i&&(i=e),n>i&&(i=n),i}if(arguments.length===4){var s=arguments[0],a=arguments[1],u=arguments[2],o=arguments[3],l=s;return a>l&&(l=a),u>l&&(l=u),o>l&&(l=o),l}}},{key:"average",value:function(t,e){return(t+e)/2}}]),r}();jt.LOG_10=Math.log(10);var lt=function(){function r(){f(this,r)}return m(r,null,[{key:"segmentToSegment",value:function(t,e,n,i){if(t.equals(e))return r.pointToSegment(t,n,i);if(n.equals(i))return r.pointToSegment(i,t,e);var s=!1;if(z.intersects(t,e,n,i)){var a=(e.x-t.x)*(i.y-n.y)-(e.y-t.y)*(i.x-n.x);if(a===0)s=!0;else{var u=(t.y-n.y)*(i.x-n.x)-(t.x-n.x)*(i.y-n.y),o=((t.y-n.y)*(e.x-t.x)-(t.x-n.x)*(e.y-t.y))/a,l=u/a;(l<0||l>1||o<0||o>1)&&(s=!0)}}else s=!0;return s?jt.min(r.pointToSegment(t,n,i),r.pointToSegment(e,n,i),r.pointToSegment(n,t,e),r.pointToSegment(i,t,e)):0}},{key:"pointToSegment",value:function(t,e,n){if(e.x===n.x&&e.y===n.y)return t.distance(e);var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),s=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/i;if(s<=0)return t.distance(e);if(s>=1)return t.distance(n);var a=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(a)*Math.sqrt(i)}},{key:"pointToLinePerpendicular",value:function(t,e,n){var i=(n.x-e.x)*(n.x-e.x)+(n.y-e.y)*(n.y-e.y),s=((e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y))/i;return Math.abs(s)*Math.sqrt(i)}},{key:"pointToSegmentString",value:function(t,e){if(e.length===0)throw new P("Line array must contain at least one vertex");for(var n=t.distance(e[0]),i=0;i<e.length-1;i++){var s=r.pointToSegment(t,e[i],e[i+1]);s<n&&(n=s)}return n}}]),r}(),en=function(){function r(){f(this,r)}return m(r,[{key:"create",value:function(){if(arguments.length===1)arguments[0]instanceof Array||b(arguments[0],D);else if(arguments.length!==2&&arguments.length===3){var t=arguments[0],e=arguments[1];return this.create(t,e)}}}]),r}(),he=function(){function r(){f(this,r)}return m(r,[{key:"filter",value:function(t){}}]),r}(),$n=function(){function r(){f(this,r)}return m(r,null,[{key:"ofLine",value:function(t){var e=t.size();if(e<=1)return 0;var n=0,i=new v;t.getCoordinate(0,i);for(var s=i.x,a=i.y,u=1;u<e;u++){t.getCoordinate(u,i);var o=i.x,l=i.y,c=o-s,g=l-a;n+=Math.sqrt(c*c+g*g),s=o,a=l}return n}}]),r}(),nn=function r(){f(this,r)},Nt=function(){function r(){f(this,r)}return m(r,null,[{key:"copyCoord",value:function(t,e,n,i){for(var s=Math.min(t.getDimension(),n.getDimension()),a=0;a<s;a++)n.setOrdinate(i,a,t.getOrdinate(e,a))}},{key:"isRing",value:function(t){var e=t.size();return e===0||!(e<=3)&&t.getOrdinate(0,D.X)===t.getOrdinate(e-1,D.X)&&t.getOrdinate(0,D.Y)===t.getOrdinate(e-1,D.Y)}},{key:"scroll",value:function(){if(arguments.length===2){if(b(arguments[0],D)&&Number.isInteger(arguments[1])){var t=arguments[0],e=arguments[1];r.scroll(t,e,r.isRing(t))}else if(b(arguments[0],D)&&arguments[1]instanceof v){var n=arguments[0],i=arguments[1],s=r.indexOf(i,n);if(s<=0)return null;r.scroll(n,s)}}else if(arguments.length===3){var a=arguments[0],u=arguments[1],o=arguments[2],l=u;if(l<=0)return null;for(var c=a.copy(),g=o?a.size()-1:a.size(),y=0;y<g;y++)for(var _=0;_<a.getDimension();_++)a.setOrdinate(y,_,c.getOrdinate((u+y)%g,_));if(o)for(var d=0;d<a.getDimension();d++)a.setOrdinate(g,d,a.getOrdinate(0,d))}}},{key:"isEqual",value:function(t,e){var n=t.size();if(n!==e.size())return!1;for(var i=Math.min(t.getDimension(),e.getDimension()),s=0;s<n;s++)for(var a=0;a<i;a++){var u=t.getOrdinate(s,a),o=e.getOrdinate(s,a);if(t.getOrdinate(s,a)!==e.getOrdinate(s,a)&&(!I.isNaN(u)||!I.isNaN(o)))return!1}return!0}},{key:"minCoordinateIndex",value:function(){if(arguments.length===1){var t=arguments[0];return r.minCoordinateIndex(t,0,t.size()-1)}if(arguments.length===3){for(var e=arguments[0],n=arguments[1],i=arguments[2],s=-1,a=null,u=n;u<=i;u++){var o=e.getCoordinate(u);(a===null||a.compareTo(o)>0)&&(a=o,s=u)}return s}}},{key:"extend",value:function(t,e,n){var i=t.create(n,e.getDimension()),s=e.size();if(r.copy(e,0,i,0,s),s>0)for(var a=s;a<n;a++)r.copy(e,s-1,i,a,1);return i}},{key:"reverse",value:function(t){for(var e=t.size()-1,n=Math.trunc(e/2),i=0;i<=n;i++)r.swap(t,i,e-i)}},{key:"swap",value:function(t,e,n){if(e===n)return null;for(var i=0;i<t.getDimension();i++){var s=t.getOrdinate(e,i);t.setOrdinate(e,i,t.getOrdinate(n,i)),t.setOrdinate(n,i,s)}}},{key:"copy",value:function(t,e,n,i,s){for(var a=0;a<s;a++)r.copyCoord(t,e+a,n,i+a)}},{key:"ensureValidRing",value:function(t,e){var n=e.size();return n===0?e:n<=3?r.createClosedRing(t,e,4):e.getOrdinate(0,D.X)===e.getOrdinate(n-1,D.X)&&e.getOrdinate(0,D.Y)===e.getOrdinate(n-1,D.Y)?e:r.createClosedRing(t,e,n+1)}},{key:"indexOf",value:function(t,e){for(var n=0;n<e.size();n++)if(t.x===e.getOrdinate(n,D.X)&&t.y===e.getOrdinate(n,D.Y))return n;return-1}},{key:"createClosedRing",value:function(t,e,n){var i=t.create(n,e.getDimension()),s=e.size();r.copy(e,0,i,0,s);for(var a=s;a<n;a++)r.copy(e,0,i,a,1);return i}},{key:"minCoordinate",value:function(t){for(var e=null,n=0;n<t.size();n++){var i=t.getCoordinate(n);(e===null||e.compareTo(i)>0)&&(e=i)}return e}}]),r}(),k=function(){function r(){f(this,r)}return m(r,null,[{key:"toDimensionSymbol",value:function(t){switch(t){case r.FALSE:return r.SYM_FALSE;case r.TRUE:return r.SYM_TRUE;case r.DONTCARE:return r.SYM_DONTCARE;case r.P:return r.SYM_P;case r.L:return r.SYM_L;case r.A:return r.SYM_A}throw new P("Unknown dimension value: "+t)}},{key:"toDimensionValue",value:function(t){switch(Le.toUpperCase(t)){case r.SYM_FALSE:return r.FALSE;case r.SYM_TRUE:return r.TRUE;case r.SYM_DONTCARE:return r.DONTCARE;case r.SYM_P:return r.P;case r.SYM_L:return r.L;case r.SYM_A:return r.A}throw new P("Unknown dimension symbol: "+t)}}]),r}();k.P=0,k.L=1,k.A=2,k.FALSE=-1,k.TRUE=-2,k.DONTCARE=-3,k.SYM_FALSE="F",k.SYM_TRUE="T",k.SYM_DONTCARE="*",k.SYM_P="0",k.SYM_L="1",k.SYM_A="2";var ce=function(){function r(){f(this,r)}return m(r,[{key:"filter",value:function(t){}}]),r}(),ge=function(){function r(){f(this,r)}return m(r,[{key:"filter",value:function(t,e){}},{key:"isDone",value:function(){}},{key:"isGeometryChanged",value:function(){}}]),r}(),Wt=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"computeEnvelopeInternal",value:function(){return this.isEmpty()?new z:this._points.expandEnvelope(new z)}},{key:"isRing",value:function(){return this.isClosed()&&this.isSimple()}},{key:"getCoordinates",value:function(){return this._points.toCoordinateArray()}},{key:"copyInternal",value:function(){return new e(this._points.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof E){var n=arguments[0],i=arguments[1];if(!this.isEquivalentClass(n))return!1;var s=n;if(this._points.size()!==s._points.size())return!1;for(var a=0;a<this._points.size();a++)if(!this.equal(this._points.getCoordinate(a),s._points.getCoordinate(a),i))return!1;return!0}return M(O(e.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var n=0;n<Math.trunc(this._points.size()/2);n++){var i=this._points.size()-1-n;if(!this._points.getCoordinate(n).equals(this._points.getCoordinate(i))){if(this._points.getCoordinate(n).compareTo(this._points.getCoordinate(i))>0){var s=this._points.copy();Nt.reverse(s),this._points=s}return null}}}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._points.getCoordinate(0)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?k.FALSE:0}},{key:"isClosed",value:function(){return!this.isEmpty()&&this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}},{key:"reverseInternal",value:function(){var n=this._points.copy();return Nt.reverse(n),this.getFactory().createLineString(n)}},{key:"getEndPoint",value:function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}},{key:"getTypeCode",value:function(){return E.TYPECODE_LINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getLength",value:function(){return $n.ofLine(this._points)}},{key:"getNumPoints",value:function(){return this._points.size()}},{key:"compareToSameClass",value:function(){if(arguments.length===1){for(var n=arguments[0],i=n,s=0,a=0;s<this._points.size()&&a<i._points.size();){var u=this._points.getCoordinate(s).compareTo(i._points.getCoordinate(a));if(u!==0)return u;s++,a++}return s<this._points.size()?1:a<i._points.size()?-1:0}if(arguments.length===2){var o=arguments[0],l=arguments[1],c=o;return l.compare(this._points,c._points)}}},{key:"apply",value:function(){if(b(arguments[0],he))for(var n=arguments[0],i=0;i<this._points.size();i++)n.filter(this._points.getCoordinate(i));else if(b(arguments[0],ge)){var s=arguments[0];if(this._points.size()===0)return null;for(var a=0;a<this._points.size()&&(s.filter(this._points,a),!s.isDone());a++);s.isGeometryChanged()&&this.geometryChanged()}else if(b(arguments[0],ce)){var u=arguments[0];u.filter(this)}else if(b(arguments[0],zt)){var o=arguments[0];o.filter(this)}}},{key:"getBoundary",value:function(){throw new pt}},{key:"isEquivalentClass",value:function(n){return n instanceof e}},{key:"getCoordinateN",value:function(n){return this._points.getCoordinate(n)}},{key:"getGeometryType",value:function(){return E.TYPENAME_LINESTRING}},{key:"getCoordinateSequence",value:function(){return this._points}},{key:"isEmpty",value:function(){return this._points.size()===0}},{key:"init",value:function(n){if(n===null&&(n=this.getFactory().getCoordinateSequenceFactory().create([])),n.size()===1)throw new P("Invalid number of points in LineString (found "+n.size()+" - must be 0 or >= 2)");this._points=n}},{key:"isCoordinate",value:function(n){for(var i=0;i<this._points.size();i++)if(this._points.getCoordinate(i).equals(n))return!0;return!1}},{key:"getStartPoint",value:function(){return this.isEmpty()?null:this.getPointN(0)}},{key:"getPointN",value:function(n){return this.getFactory().createPoint(this._points.getCoordinate(n))}},{key:"interfaces_",get:function(){return[nn]}}],[{key:"constructor_",value:function(){if(this._points=null,arguments.length!==0&&arguments.length===2){var n=arguments[0],i=arguments[1];E.constructor_.call(this,i),this.init(n)}}}]),e}(E),rn=function r(){f(this,r)},we=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"computeEnvelopeInternal",value:function(){if(this.isEmpty())return new z;var n=new z;return n.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),n}},{key:"getCoordinates",value:function(){return this.isEmpty()?[]:[this.getCoordinate()]}},{key:"copyInternal",value:function(){return new e(this._coordinates.copy(),this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof E){var n=arguments[0],i=arguments[1];return!!this.isEquivalentClass(n)&&(!(!this.isEmpty()||!n.isEmpty())||this.isEmpty()===n.isEmpty()&&this.equal(n.getCoordinate(),this.getCoordinate(),i))}return M(O(e.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){}},{key:"getCoordinate",value:function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}},{key:"getBoundaryDimension",value:function(){return k.FALSE}},{key:"reverseInternal",value:function(){return this.getFactory().createPoint(this._coordinates.copy())}},{key:"getTypeCode",value:function(){return E.TYPECODE_POINT}},{key:"getDimension",value:function(){return 0}},{key:"getNumPoints",value:function(){return this.isEmpty()?0:1}},{key:"getX",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getX called on empty Point");return this.getCoordinate().x}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var n=arguments[0],i=n;return this.getCoordinate().compareTo(i.getCoordinate())}if(arguments.length===2){var s=arguments[0],a=arguments[1],u=s;return a.compare(this._coordinates,u._coordinates)}}},{key:"apply",value:function(){if(b(arguments[0],he)){var n=arguments[0];if(this.isEmpty())return null;n.filter(this.getCoordinate())}else if(b(arguments[0],ge)){var i=arguments[0];if(this.isEmpty())return null;i.filter(this._coordinates,0),i.isGeometryChanged()&&this.geometryChanged()}else if(b(arguments[0],ce)){var s=arguments[0];s.filter(this)}else if(b(arguments[0],zt)){var a=arguments[0];a.filter(this)}}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return E.TYPENAME_POINT}},{key:"getCoordinateSequence",value:function(){return this._coordinates}},{key:"getY",value:function(){if(this.getCoordinate()===null)throw new IllegalStateException("getY called on empty Point");return this.getCoordinate().y}},{key:"isEmpty",value:function(){return this._coordinates.size()===0}},{key:"init",value:function(n){n===null&&(n=this.getFactory().getCoordinateSequenceFactory().create([])),A.isTrue(n.size()<=1),this._coordinates=n}},{key:"isSimple",value:function(){return!0}},{key:"interfaces_",get:function(){return[rn]}}],[{key:"constructor_",value:function(){this._coordinates=null;var n=arguments[0],i=arguments[1];E.constructor_.call(this,i),this.init(n)}}]),e}(E),sn=function(){function r(){f(this,r)}return m(r,null,[{key:"ofRing",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];return Math.abs(r.ofRingSigned(t))}if(b(arguments[0],D)){var e=arguments[0];return Math.abs(r.ofRingSigned(e))}}},{key:"ofRingSigned",value:function(){if(arguments[0]instanceof Array){var t=arguments[0];if(t.length<3)return 0;for(var e=0,n=t[0].x,i=1;i<t.length-1;i++){var s=t[i].x-n,a=t[i+1].y,u=t[i-1].y;e+=s*(u-a)}return e/2}if(b(arguments[0],D)){var o=arguments[0],l=o.size();if(l<3)return 0;var c=new v,g=new v,y=new v;o.getCoordinate(0,g),o.getCoordinate(1,y);var _=g.x;y.x-=_;for(var d=0,x=1;x<l-1;x++)c.y=g.y,g.x=y.x,g.y=y.y,o.getCoordinate(x+1,y),y.x-=_,d+=g.x*(c.y-y.y);return d/2}}}]),r}(),Tt=function(){function r(){f(this,r)}return m(r,null,[{key:"sort",value:function(){var t=arguments,e=arguments[0];if(arguments.length===1)e.sort(function(_,d){return _.compareTo(d)});else if(arguments.length===2)e.sort(function(_,d){return t[1].compare(_,d)});else if(arguments.length===3){var n=e.slice(arguments[1],arguments[2]);n.sort();var i=e.slice(0,arguments[1]).concat(n,e.slice(arguments[2],e.length));e.splice(0,e.length);var s,a=ft(i);try{for(a.s();!(s=a.n()).done;){var u=s.value;e.push(u)}}catch(_){a.e(_)}finally{a.f()}}else if(arguments.length===4){var o=e.slice(arguments[1],arguments[2]);o.sort(function(_,d){return t[3].compare(_,d)});var l=e.slice(0,arguments[1]).concat(o,e.slice(arguments[2],e.length));e.splice(0,e.length);var c,g=ft(l);try{for(g.s();!(c=g.n()).done;){var y=c.value;e.push(y)}}catch(_){g.e(_)}finally{g.f()}}}},{key:"asList",value:function(t){var e,n=new T,i=ft(t);try{for(i.s();!(e=i.n()).done;){var s=e.value;n.add(s)}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"copyOf",value:function(t,e){return t.slice(0,e)}}]),r}(),an=function r(){f(this,r)},fe=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"computeEnvelopeInternal",value:function(){return this._shell.getEnvelopeInternal()}},{key:"getCoordinates",value:function(){if(this.isEmpty())return[];for(var n=new Array(this.getNumPoints()).fill(null),i=-1,s=this._shell.getCoordinates(),a=0;a<s.length;a++)n[++i]=s[a];for(var u=0;u<this._holes.length;u++)for(var o=this._holes[u].getCoordinates(),l=0;l<o.length;l++)n[++i]=o[l];return n}},{key:"getArea",value:function(){var n=0;n+=sn.ofRing(this._shell.getCoordinateSequence());for(var i=0;i<this._holes.length;i++)n-=sn.ofRing(this._holes[i].getCoordinateSequence());return n}},{key:"copyInternal",value:function(){for(var n=this._shell.copy(),i=new Array(this._holes.length).fill(null),s=0;s<this._holes.length;s++)i[s]=this._holes[s].copy();return new e(n,i,this._factory)}},{key:"isRectangle",value:function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var n=this._shell.getCoordinateSequence(),i=this.getEnvelopeInternal(),s=0;s<5;s++){var a=n.getX(s);if(a!==i.getMinX()&&a!==i.getMaxX())return!1;var u=n.getY(s);if(u!==i.getMinY()&&u!==i.getMaxY())return!1}for(var o=n.getX(0),l=n.getY(0),c=1;c<=4;c++){var g=n.getX(c),y=n.getY(c);if(g!==o==(y!==l))return!1;o=g,l=y}return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof E){var n=arguments[0],i=arguments[1];if(!this.isEquivalentClass(n))return!1;var s=n,a=this._shell,u=s._shell;if(!a.equalsExact(u,i)||this._holes.length!==s._holes.length)return!1;for(var o=0;o<this._holes.length;o++)if(!this._holes[o].equalsExact(s._holes[o],i))return!1;return!0}return M(O(e.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(var n=0;n<this._holes.length;n++)this._holes[n]=this.normalized(this._holes[n],!1);Tt.sort(this._holes)}else if(arguments.length===2){var i=arguments[0],s=arguments[1];if(i.isEmpty())return null;var a=i.getCoordinateSequence(),u=Nt.minCoordinateIndex(a,0,a.size()-2);Nt.scroll(a,u,!0),L.isCCW(a)===s&&Nt.reverse(a)}}},{key:"getCoordinate",value:function(){return this._shell.getCoordinate()}},{key:"getNumInteriorRing",value:function(){return this._holes.length}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"reverseInternal",value:function(){for(var n=this.getExteriorRing().reverse(),i=new Array(this.getNumInteriorRing()).fill(null),s=0;s<i.length;s++)i[s]=this.getInteriorRingN(s).reverse();return this.getFactory().createPolygon(n,i)}},{key:"getTypeCode",value:function(){return E.TYPECODE_POLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getLength",value:function(){var n=0;n+=this._shell.getLength();for(var i=0;i<this._holes.length;i++)n+=this._holes[i].getLength();return n}},{key:"getNumPoints",value:function(){for(var n=this._shell.getNumPoints(),i=0;i<this._holes.length;i++)n+=this._holes[i].getNumPoints();return n}},{key:"convexHull",value:function(){return this.getExteriorRing().convexHull()}},{key:"normalized",value:function(n,i){var s=n.copy();return this.normalize(s,i),s}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var n=arguments[0],i=this._shell,s=n._shell;return i.compareToSameClass(s)}if(arguments.length===2){var a=arguments[0],u=arguments[1],o=a,l=this._shell,c=o._shell,g=l.compareToSameClass(c,u);if(g!==0)return g;for(var y=this.getNumInteriorRing(),_=o.getNumInteriorRing(),d=0;d<y&&d<_;){var x=this.getInteriorRingN(d),N=o.getInteriorRingN(d),w=x.compareToSameClass(N,u);if(w!==0)return w;d++}return d<y?1:d<_?-1:0}}},{key:"apply",value:function(){if(b(arguments[0],he)){var n=arguments[0];this._shell.apply(n);for(var i=0;i<this._holes.length;i++)this._holes[i].apply(n)}else if(b(arguments[0],ge)){var s=arguments[0];if(this._shell.apply(s),!s.isDone())for(var a=0;a<this._holes.length&&(this._holes[a].apply(s),!s.isDone());a++);s.isGeometryChanged()&&this.geometryChanged()}else if(b(arguments[0],ce)){var u=arguments[0];u.filter(this)}else if(b(arguments[0],zt)){var o=arguments[0];o.filter(this),this._shell.apply(o);for(var l=0;l<this._holes.length;l++)this._holes[l].apply(o)}}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();var n=new Array(this._holes.length+1).fill(null);n[0]=this._shell;for(var i=0;i<this._holes.length;i++)n[i+1]=this._holes[i];return n.length<=1?this.getFactory().createLinearRing(n[0].getCoordinateSequence()):this.getFactory().createMultiLineString(n)}},{key:"getGeometryType",value:function(){return E.TYPENAME_POLYGON}},{key:"getExteriorRing",value:function(){return this._shell}},{key:"isEmpty",value:function(){return this._shell.isEmpty()}},{key:"getInteriorRingN",value:function(n){return this._holes[n]}},{key:"interfaces_",get:function(){return[an]}}],[{key:"constructor_",value:function(){this._shell=null,this._holes=null;var n=arguments[0],i=arguments[1],s=arguments[2];if(E.constructor_.call(this,s),n===null&&(n=this.getFactory().createLinearRing()),i===null&&(i=[]),E.hasNullElements(i))throw new P("holes must not contain null elements");if(n.isEmpty()&&E.hasNonEmptyElements(i))throw new P("shell is empty but holes are not");this._shell=n,this._holes=i}}]),e}(E),ti=function(r){C(e,r);var t=R(e);function e(){return f(this,e),t.apply(this,arguments)}return e}(Qe),un=function(r){C(e,r);var t=R(e);function e(n){var i;return f(this,e),(i=t.call(this)).array=[],n instanceof ot&&i.addAll(n),i}return m(e,[{key:"contains",value:function(n){var i,s=ft(this.array);try{for(s.s();!(i=s.n()).done;)if(i.value.compareTo(n)===0)return!0}catch(a){s.e(a)}finally{s.f()}return!1}},{key:"add",value:function(n){if(this.contains(n))return!1;for(var i=0,s=this.array.length;i<s;i++)if(this.array[i].compareTo(n)===1)return!!this.array.splice(i,0,n);return this.array.push(n),!0}},{key:"addAll",value:function(n){var i,s=ft(n);try{for(s.s();!(i=s.n()).done;){var a=i.value;this.add(a)}}catch(u){s.e(u)}finally{s.f()}return!0}},{key:"remove",value:function(){throw new pt}},{key:"size",value:function(){return this.array.length}},{key:"isEmpty",value:function(){return this.array.length===0}},{key:"toArray",value:function(){return this.array.slice()}},{key:"iterator",value:function(){return new ei(this.array)}}]),e}(ti),ei=function(){function r(t){f(this,r),this.array=t,this.position=0}return m(r,[{key:"next",value:function(){if(this.position===this.array.length)throw new oe;return this.array[this.position++]}},{key:"hasNext",value:function(){return this.position<this.array.length}},{key:"remove",value:function(){throw new pt}}]),r}(),W=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"computeEnvelopeInternal",value:function(){for(var n=new z,i=0;i<this._geometries.length;i++)n.expandToInclude(this._geometries[i].getEnvelopeInternal());return n}},{key:"getGeometryN",value:function(n){return this._geometries[n]}},{key:"getCoordinates",value:function(){for(var n=new Array(this.getNumPoints()).fill(null),i=-1,s=0;s<this._geometries.length;s++)for(var a=this._geometries[s].getCoordinates(),u=0;u<a.length;u++)n[++i]=a[u];return n}},{key:"getArea",value:function(){for(var n=0,i=0;i<this._geometries.length;i++)n+=this._geometries[i].getArea();return n}},{key:"copyInternal",value:function(){for(var n=new Array(this._geometries.length).fill(null),i=0;i<n.length;i++)n[i]=this._geometries[i].copy();return new e(n,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof E){var n=arguments[0],i=arguments[1];if(!this.isEquivalentClass(n))return!1;var s=n;if(this._geometries.length!==s._geometries.length)return!1;for(var a=0;a<this._geometries.length;a++)if(!this._geometries[a].equalsExact(s._geometries[a],i))return!1;return!0}return M(O(e.prototype),"equalsExact",this).apply(this,arguments)}},{key:"normalize",value:function(){for(var n=0;n<this._geometries.length;n++)this._geometries[n].normalize();Tt.sort(this._geometries)}},{key:"getCoordinate",value:function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}},{key:"getBoundaryDimension",value:function(){for(var n=k.FALSE,i=0;i<this._geometries.length;i++)n=Math.max(n,this._geometries[i].getBoundaryDimension());return n}},{key:"reverseInternal",value:function(){for(var n=this._geometries.length,i=new T(n),s=0;s<n;s++)i.add(this._geometries[s].reverse());return this.getFactory().buildGeometry(i)}},{key:"getTypeCode",value:function(){return E.TYPECODE_GEOMETRYCOLLECTION}},{key:"getDimension",value:function(){for(var n=k.FALSE,i=0;i<this._geometries.length;i++)n=Math.max(n,this._geometries[i].getDimension());return n}},{key:"getLength",value:function(){for(var n=0,i=0;i<this._geometries.length;i++)n+=this._geometries[i].getLength();return n}},{key:"getNumPoints",value:function(){for(var n=0,i=0;i<this._geometries.length;i++)n+=this._geometries[i].getNumPoints();return n}},{key:"getNumGeometries",value:function(){return this._geometries.length}},{key:"compareToSameClass",value:function(){if(arguments.length===1){var n=arguments[0],i=new un(Tt.asList(this._geometries)),s=new un(Tt.asList(n._geometries));return this.compare(i,s)}if(arguments.length===2){for(var a=arguments[0],u=arguments[1],o=a,l=this.getNumGeometries(),c=o.getNumGeometries(),g=0;g<l&&g<c;){var y=this.getGeometryN(g),_=o.getGeometryN(g),d=y.compareToSameClass(_,u);if(d!==0)return d;g++}return g<l?1:g<c?-1:0}}},{key:"apply",value:function(){if(b(arguments[0],he))for(var n=arguments[0],i=0;i<this._geometries.length;i++)this._geometries[i].apply(n);else if(b(arguments[0],ge)){var s=arguments[0];if(this._geometries.length===0)return null;for(var a=0;a<this._geometries.length&&(this._geometries[a].apply(s),!s.isDone());a++);s.isGeometryChanged()&&this.geometryChanged()}else if(b(arguments[0],ce)){var u=arguments[0];u.filter(this);for(var o=0;o<this._geometries.length;o++)this._geometries[o].apply(u)}else if(b(arguments[0],zt)){var l=arguments[0];l.filter(this);for(var c=0;c<this._geometries.length;c++)this._geometries[c].apply(l)}}},{key:"getBoundary",value:function(){return E.checkNotGeometryCollection(this),A.shouldNeverReachHere(),null}},{key:"getGeometryType",value:function(){return E.TYPENAME_GEOMETRYCOLLECTION}},{key:"isEmpty",value:function(){for(var n=0;n<this._geometries.length;n++)if(!this._geometries[n].isEmpty())return!1;return!0}}],[{key:"constructor_",value:function(){if(this._geometries=null,arguments.length!==0&&arguments.length===2){var n=arguments[0],i=arguments[1];if(E.constructor_.call(this,i),n===null&&(n=[]),E.hasNullElements(n))throw new P("geometries must not contain null elements");this._geometries=n}}}]),e}(E),Oe=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"copyInternal",value:function(){for(var n=new Array(this._geometries.length).fill(null),i=0;i<n.length;i++)n[i]=this._geometries[i].copy();return new e(n,this._factory)}},{key:"isValid",value:function(){return!0}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof E){var n=arguments[0],i=arguments[1];return!!this.isEquivalentClass(n)&&M(O(e.prototype),"equalsExact",this).call(this,n,i)}return M(O(e.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getCoordinate",value:function(){if(arguments.length===1&&Number.isInteger(arguments[0])){var n=arguments[0];return this._geometries[n].getCoordinate()}return M(O(e.prototype),"getCoordinate",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return k.FALSE}},{key:"getTypeCode",value:function(){return E.TYPECODE_MULTIPOINT}},{key:"getDimension",value:function(){return 0}},{key:"getBoundary",value:function(){return this.getFactory().createGeometryCollection()}},{key:"getGeometryType",value:function(){return E.TYPENAME_MULTIPOINT}},{key:"interfaces_",get:function(){return[rn]}}],[{key:"constructor_",value:function(){var n=arguments[0],i=arguments[1];W.constructor_.call(this,n,i)}}]),e}(W),Kt=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"copyInternal",value:function(){return new e(this._points.copy(),this._factory)}},{key:"getBoundaryDimension",value:function(){return k.FALSE}},{key:"isClosed",value:function(){return!!this.isEmpty()||M(O(e.prototype),"isClosed",this).call(this)}},{key:"reverseInternal",value:function(){var n=this._points.copy();return Nt.reverse(n),this.getFactory().createLinearRing(n)}},{key:"getTypeCode",value:function(){return E.TYPECODE_LINEARRING}},{key:"validateConstruction",value:function(){if(!this.isEmpty()&&!M(O(e.prototype),"isClosed",this).call(this))throw new P("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new P("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}},{key:"getGeometryType",value:function(){return E.TYPENAME_LINEARRING}}],[{key:"constructor_",value:function(){var n=arguments[0],i=arguments[1];Wt.constructor_.call(this,n,i),this.validateConstruction()}}]),e}(Wt);Kt.MINIMUM_VALID_SIZE=4;var St=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"setOrdinate",value:function(n,i){switch(n){case e.X:this.x=i;break;case e.Y:this.y=i;break;default:throw new P("Invalid ordinate index: "+n)}}},{key:"getZ",value:function(){return v.NULL_ORDINATE}},{key:"getOrdinate",value:function(n){switch(n){case e.X:return this.x;case e.Y:return this.y}throw new P("Invalid ordinate index: "+n)}},{key:"setZ",value:function(n){throw new P("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+")"}},{key:"setCoordinate",value:function(n){this.x=n.x,this.y=n.y,this.z=n.getZ()}}],[{key:"constructor_",value:function(){if(arguments.length===0)v.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof e){var n=arguments[0];v.constructor_.call(this,n.x,n.y)}else if(arguments[0]instanceof v){var i=arguments[0];v.constructor_.call(this,i.x,i.y)}}else if(arguments.length===2){var s=arguments[0],a=arguments[1];v.constructor_.call(this,s,a,v.NULL_ORDINATE)}}}]),e}(v);St.X=0,St.Y=1,St.Z=-1,St.M=-1;var Lt=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(n,i){switch(n){case e.X:this.x=i;break;case e.Y:this.y=i;break;case e.M:this._m=i;break;default:throw new P("Invalid ordinate index: "+n)}}},{key:"setM",value:function(n){this._m=n}},{key:"getZ",value:function(){return v.NULL_ORDINATE}},{key:"getOrdinate",value:function(n){switch(n){case e.X:return this.x;case e.Y:return this.y;case e.M:return this._m}throw new P("Invalid ordinate index: "+n)}},{key:"setZ",value:function(n){throw new P("CoordinateXY dimension 2 does not support z-ordinate")}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(n){this.x=n.x,this.y=n.y,this.z=n.getZ(),this._m=n.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)v.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof e){var n=arguments[0];v.constructor_.call(this,n.x,n.y),this._m=n._m}else if(arguments[0]instanceof v){var i=arguments[0];v.constructor_.call(this,i.x,i.y),this._m=this.getM()}}else if(arguments.length===3){var s=arguments[0],a=arguments[1],u=arguments[2];v.constructor_.call(this,s,a,v.NULL_ORDINATE),this._m=u}}}]),e}(v);Lt.X=0,Lt.Y=1,Lt.Z=-1,Lt.M=2;var be=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"getM",value:function(){return this._m}},{key:"setOrdinate",value:function(n,i){switch(n){case v.X:this.x=i;break;case v.Y:this.y=i;break;case v.Z:this.z=i;break;case v.M:this._m=i;break;default:throw new P("Invalid ordinate index: "+n)}}},{key:"setM",value:function(n){this._m=n}},{key:"getOrdinate",value:function(n){switch(n){case v.X:return this.x;case v.Y:return this.y;case v.Z:return this.getZ();case v.M:return this.getM()}throw new P("Invalid ordinate index: "+n)}},{key:"copy",value:function(){return new e(this)}},{key:"toString",value:function(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}},{key:"setCoordinate",value:function(n){this.x=n.x,this.y=n.y,this.z=n.getZ(),this._m=n.getM()}}],[{key:"constructor_",value:function(){if(this._m=null,arguments.length===0)v.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof e){var n=arguments[0];v.constructor_.call(this,n),this._m=n._m}else if(arguments[0]instanceof v){var i=arguments[0];v.constructor_.call(this,i),this._m=this.getM()}}else if(arguments.length===4){var s=arguments[0],a=arguments[1],u=arguments[2],o=arguments[3];v.constructor_.call(this,s,a,u),this._m=o}}}]),e}(v),me=function(){function r(){f(this,r)}return m(r,null,[{key:"measures",value:function(t){return t instanceof St?0:t instanceof Lt||t instanceof be?1:0}},{key:"dimension",value:function(t){return t instanceof St?2:t instanceof Lt?3:t instanceof be?4:3}},{key:"create",value:function(){if(arguments.length===1){var t=arguments[0];return r.create(t,0)}if(arguments.length===2){var e=arguments[0],n=arguments[1];return e===2?new St:e===3&&n===0?new v:e===3&&n===1?new Lt:e===4&&n===1?new be:new v}}}]),r}(),Jt=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"getCoordinate",value:function(n){return this.get(n)}},{key:"addAll",value:function(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&b(arguments[0],ot)){for(var n=arguments[0],i=arguments[1],s=!1,a=n.iterator();a.hasNext();)this.add(a.next(),i),s=!0;return s}return M(O(e.prototype),"addAll",this).apply(this,arguments)}},{key:"clone",value:function(){for(var n=M(O(e.prototype),"clone",this).call(this),i=0;i<this.size();i++)n.add(i,this.get(i).clone());return n}},{key:"toCoordinateArray",value:function(){if(arguments.length===0)return this.toArray(e.coordArrayType);if(arguments.length===1){var n=arguments[0];if(n)return this.toArray(e.coordArrayType);for(var i=this.size(),s=new Array(i).fill(null),a=0;a<i;a++)s[a]=this.get(i-a-1);return s}}},{key:"add",value:function(){if(arguments.length===1){var n=arguments[0];return M(O(e.prototype),"add",this).call(this,n)}if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var i=arguments[0],s=arguments[1];return this.add(i,s,!0),!0}if(arguments[0]instanceof v&&typeof arguments[1]=="boolean"){var a=arguments[0],u=arguments[1];if(!u&&this.size()>=1){var o=this.get(this.size()-1);if(o.equals2D(a))return null}M(O(e.prototype),"add",this).call(this,a)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var l=arguments[0],c=arguments[1];return this.add(l,c),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var g=arguments[0],y=arguments[1],_=arguments[2];if(_)for(var d=0;d<g.length;d++)this.add(g[d],y);else for(var x=g.length-1;x>=0;x--)this.add(g[x],y);return!0}if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof v){var N=arguments[0],w=arguments[1],G=arguments[2];if(!G){var U=this.size();if(U>0){if(N>0){var V=this.get(N-1);if(V.equals2D(w))return null}if(N<U){var Q=this.get(N);if(Q.equals2D(w))return null}}}M(O(e.prototype),"add",this).call(this,N,w)}}else if(arguments.length===4){var at=arguments[0],_t=arguments[1],wt=arguments[2],ne=arguments[3],ie=1;wt>ne&&(ie=-1);for(var qt=wt;qt!==ne;qt+=ie)this.add(at[qt],_t);return!0}}},{key:"closeRing",value:function(){if(this.size()>0){var n=this.get(0).copy();this.add(n,!1)}}}],[{key:"constructor_",value:function(){if(arguments.length!==0){if(arguments.length===1){var n=arguments[0];this.ensureCapacity(n.length),this.add(n,!0)}else if(arguments.length===2){var i=arguments[0],s=arguments[1];this.ensureCapacity(i.length),this.add(i,s)}}}}]),e}(T);Jt.coordArrayType=new Array(0).fill(null);var B=function(){function r(){f(this,r)}return m(r,null,[{key:"isRing",value:function(t){return!(t.length<4)&&!!t[0].equals2D(t[t.length-1])}},{key:"ptNotInList",value:function(t,e){for(var n=0;n<t.length;n++){var i=t[n];if(r.indexOf(i,e)<0)return i}return null}},{key:"scroll",value:function(t,e){var n=r.indexOf(e,t);if(n<0)return null;var i=new Array(t.length).fill(null);$.arraycopy(t,n,i,0,t.length-n),$.arraycopy(t,0,i,t.length-n,n),$.arraycopy(i,0,t,0,t.length)}},{key:"equals",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];if(t===e)return!0;if(t===null||e===null||t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].equals(e[n]))return!1;return!0}if(arguments.length===3){var i=arguments[0],s=arguments[1],a=arguments[2];if(i===s)return!0;if(i===null||s===null||i.length!==s.length)return!1;for(var u=0;u<i.length;u++)if(a.compare(i[u],s[u])!==0)return!1;return!0}}},{key:"intersection",value:function(t,e){for(var n=new Jt,i=0;i<t.length;i++)e.intersects(t[i])&&n.add(t[i],!0);return n.toCoordinateArray()}},{key:"measures",value:function(t){if(t===null||t.length===0)return 0;var e,n=0,i=ft(t);try{for(i.s();!(e=i.n()).done;){var s=e.value;n=Math.max(n,me.measures(s))}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"hasRepeatedPoints",value:function(t){for(var e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}},{key:"removeRepeatedPoints",value:function(t){return r.hasRepeatedPoints(t)?new Jt(t,!1).toCoordinateArray():t}},{key:"reverse",value:function(t){for(var e=t.length-1,n=Math.trunc(e/2),i=0;i<=n;i++){var s=t[i];t[i]=t[e-i],t[e-i]=s}}},{key:"removeNull",value:function(t){for(var e=0,n=0;n<t.length;n++)t[n]!==null&&e++;var i=new Array(e).fill(null);if(e===0)return i;for(var s=0,a=0;a<t.length;a++)t[a]!==null&&(i[s++]=t[a]);return i}},{key:"copyDeep",value:function(){if(arguments.length===1){for(var t=arguments[0],e=new Array(t.length).fill(null),n=0;n<t.length;n++)e[n]=t[n].copy();return e}if(arguments.length===5)for(var i=arguments[0],s=arguments[1],a=arguments[2],u=arguments[3],o=arguments[4],l=0;l<o;l++)a[u+l]=i[s+l].copy()}},{key:"isEqualReversed",value:function(t,e){for(var n=0;n<t.length;n++){var i=t[n],s=e[t.length-n-1];if(i.compareTo(s)!==0)return!1}return!0}},{key:"envelope",value:function(t){for(var e=new z,n=0;n<t.length;n++)e.expandToInclude(t[n]);return e}},{key:"toCoordinateArray",value:function(t){return t.toArray(r.coordArrayType)}},{key:"dimension",value:function(t){if(t===null||t.length===0)return 3;var e,n=0,i=ft(t);try{for(i.s();!(e=i.n()).done;){var s=e.value;n=Math.max(n,me.dimension(s))}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"atLeastNCoordinatesOrNothing",value:function(t,e){return e.length>=t?e:[]}},{key:"indexOf",value:function(t,e){for(var n=0;n<e.length;n++)if(t.equals(e[n]))return n;return-1}},{key:"increasingDirection",value:function(t){for(var e=0;e<Math.trunc(t.length/2);e++){var n=t.length-1-e,i=t[e].compareTo(t[n]);if(i!==0)return i}return 1}},{key:"compare",value:function(t,e){for(var n=0;n<t.length&&n<e.length;){var i=t[n].compareTo(e[n]);if(i!==0)return i;n++}return n<e.length?-1:n<t.length?1:0}},{key:"minCoordinate",value:function(t){for(var e=null,n=0;n<t.length;n++)(e===null||e.compareTo(t[n])>0)&&(e=t[n]);return e}},{key:"extract",value:function(t,e,n){e=jt.clamp(e,0,t.length);var i=(n=jt.clamp(n,-1,t.length))-e+1;n<0&&(i=0),e>=t.length&&(i=0),n<e&&(i=0);var s=new Array(i).fill(null);if(i===0)return s;for(var a=0,u=e;u<=n;u++)s[a++]=t[u];return s}}]),r}(),ni=function(){function r(){f(this,r)}return m(r,[{key:"compare",value:function(t,e){var n=t,i=e;return B.compare(n,i)}},{key:"interfaces_",get:function(){return[Ht]}}]),r}(),ii=function(){function r(){f(this,r)}return m(r,[{key:"compare",value:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(n.length===0)return 0;var s=B.compare(n,i);return B.isEqualReversed(n,i)?0:s}},{key:"OLDcompare",value:function(t,e){var n=t,i=e;if(n.length<i.length)return-1;if(n.length>i.length)return 1;if(n.length===0)return 0;for(var s=B.increasingDirection(n),a=B.increasingDirection(i),u=s>0?0:n.length-1,o=a>0?0:n.length-1,l=0;l<n.length;l++){var c=n[u].compareTo(i[o]);if(c!==0)return c;u+=s,o+=a}return 0}},{key:"interfaces_",get:function(){return[Ht]}}]),r}();B.ForwardComparator=ni,B.BidirectionalComparator=ii,B.coordArrayType=new Array(0).fill(null);var ve=function(){function r(t){f(this,r),this.str=t}return m(r,[{key:"append",value:function(t){this.str+=t}},{key:"setCharAt",value:function(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}},{key:"toString",value:function(){return this.str}}]),r}(),Qt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getM",value:function(t){return this.hasM()?this._coordinates[t].getM():I.NaN}},{key:"setOrdinate",value:function(t,e,n){switch(e){case D.X:this._coordinates[t].x=n;break;case D.Y:this._coordinates[t].y=n;break;default:this._coordinates[t].setOrdinate(e,n)}}},{key:"getZ",value:function(t){return this.hasZ()?this._coordinates[t].getZ():I.NaN}},{key:"size",value:function(){return this._coordinates.length}},{key:"getOrdinate",value:function(t,e){switch(e){case D.X:return this._coordinates[t].x;case D.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}},{key:"getCoordinate",value:function(){if(arguments.length===1){var t=arguments[0];return this._coordinates[t]}if(arguments.length===2){var e=arguments[0],n=arguments[1];n.setCoordinate(this._coordinates[e])}}},{key:"getCoordinateCopy",value:function(t){var e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}},{key:"createCoordinate",value:function(){return me.create(this.getDimension(),this.getMeasures())}},{key:"getDimension",value:function(){return this._dimension}},{key:"getX",value:function(t){return this._coordinates[t].x}},{key:"getMeasures",value:function(){return this._measures}},{key:"expandEnvelope",value:function(t){for(var e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}},{key:"copy",value:function(){for(var t=new Array(this.size()).fill(null),e=0;e<this._coordinates.length;e++){var n=this.createCoordinate();n.setCoordinate(this._coordinates[e]),t[e]=n}return new r(t,this._dimension,this._measures)}},{key:"toString",value:function(){if(this._coordinates.length>0){var t=new ve(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(var e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}return"()"}},{key:"getY",value:function(t){return this._coordinates[t].y}},{key:"toCoordinateArray",value:function(){return this._coordinates}},{key:"interfaces_",get:function(){return[D,Z]}}],[{key:"constructor_",value:function(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];r.constructor_.call(this,t,B.dimension(t),B.measures(t))}else if(Number.isInteger(arguments[0])){var e=arguments[0];this._coordinates=new Array(e).fill(null);for(var n=0;n<e;n++)this._coordinates[n]=new v}else if(b(arguments[0],D)){var i=arguments[0];if(i===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=i.getDimension(),this._measures=i.getMeasures(),this._coordinates=new Array(i.size()).fill(null);for(var s=0;s<this._coordinates.length;s++)this._coordinates[s]=i.getCoordinateCopy(s)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var a=arguments[0],u=arguments[1];r.constructor_.call(this,a,u,B.measures(a))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var o=arguments[0],l=arguments[1];this._coordinates=new Array(o).fill(null),this._dimension=l;for(var c=0;c<o;c++)this._coordinates[c]=me.create(l)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var g=arguments[0],y=arguments[1],_=arguments[2];this._dimension=y,this._measures=_,this._coordinates=g===null?new Array(0).fill(null):g}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var d=arguments[0],x=arguments[1],N=arguments[2];this._coordinates=new Array(d).fill(null),this._dimension=x,this._measures=N;for(var w=0;w<d;w++)this._coordinates[w]=this.createCoordinate()}}}}]),r}(),Me=function(){function r(){f(this,r)}return m(r,[{key:"readResolve",value:function(){return r.instance()}},{key:"create",value:function(){if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new Qt(t)}if(b(arguments[0],D)){var e=arguments[0];return new Qt(e)}}else{if(arguments.length===2){var n=arguments[0],i=arguments[1];return i>3&&(i=3),i<2&&(i=2),new Qt(n,i)}if(arguments.length===3){var s=arguments[0],a=arguments[1],u=arguments[2],o=a-u;return u>1&&(u=1),o>3&&(o=3),o<2&&(o=2),new Qt(s,o+u,u)}}}},{key:"interfaces_",get:function(){return[en,Z]}}],[{key:"instance",value:function(){return r.instanceObject}}]),r}();Me.instanceObject=new Me;var Ae=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"copyInternal",value:function(){for(var n=new Array(this._geometries.length).fill(null),i=0;i<n.length;i++)n[i]=this._geometries[i].copy();return new e(n,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof E){var n=arguments[0],i=arguments[1];return!!this.isEquivalentClass(n)&&M(O(e.prototype),"equalsExact",this).call(this,n,i)}return M(O(e.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return 1}},{key:"getTypeCode",value:function(){return E.TYPECODE_MULTIPOLYGON}},{key:"getDimension",value:function(){return 2}},{key:"getBoundary",value:function(){if(this.isEmpty())return this.getFactory().createMultiLineString();for(var n=new T,i=0;i<this._geometries.length;i++)for(var s=this._geometries[i].getBoundary(),a=0;a<s.getNumGeometries();a++)n.add(s.getGeometryN(a));var u=new Array(n.size()).fill(null);return this.getFactory().createMultiLineString(n.toArray(u))}},{key:"getGeometryType",value:function(){return E.TYPENAME_MULTIPOLYGON}},{key:"interfaces_",get:function(){return[an]}}],[{key:"constructor_",value:function(){var n=arguments[0],i=arguments[1];W.constructor_.call(this,n,i)}}]),e}(W),on=function(){function r(){f(this,r)}return m(r,[{key:"get",value:function(){}},{key:"put",value:function(){}},{key:"size",value:function(){}},{key:"values",value:function(){}},{key:"entrySet",value:function(){}}]),r}(),ri=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),(n=t.call(this)).map=new Map,n}return m(e,[{key:"get",value:function(n){return this.map.get(n)||null}},{key:"put",value:function(n,i){return this.map.set(n,i),i}},{key:"values",value:function(){for(var n=new T,i=this.map.values(),s=i.next();!s.done;)n.add(s.value),s=i.next();return n}},{key:"entrySet",value:function(){var n=new Se;return this.map.entries().forEach(function(i){return n.add(i)}),n}},{key:"size",value:function(){return this.map.size()}}]),e}(on),rt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"equals",value:function(t){if(!(t instanceof r))return!1;var e=t;return this._modelType===e._modelType&&this._scale===e._scale}},{key:"compareTo",value:function(t){var e=t,n=this.getMaximumSignificantDigits(),i=e.getMaximumSignificantDigits();return le.compare(n,i)}},{key:"getScale",value:function(){return this._scale}},{key:"isFloating",value:function(){return this._modelType===r.FLOATING||this._modelType===r.FLOATING_SINGLE}},{key:"getType",value:function(){return this._modelType}},{key:"toString",value:function(){var t="UNKNOWN";return this._modelType===r.FLOATING?t="Floating":this._modelType===r.FLOATING_SINGLE?t="Floating-Single":this._modelType===r.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}},{key:"makePrecise",value:function(){if(typeof arguments[0]=="number"){var t=arguments[0];return I.isNaN(t)||this._modelType===r.FLOATING_SINGLE?t:this._modelType===r.FIXED?Math.round(t*this._scale)/this._scale:t}if(arguments[0]instanceof v){var e=arguments[0];if(this._modelType===r.FLOATING)return null;e.x=this.makePrecise(e.x),e.y=this.makePrecise(e.y)}}},{key:"getMaximumSignificantDigits",value:function(){var t=16;return this._modelType===r.FLOATING?t=16:this._modelType===r.FLOATING_SINGLE?t=6:this._modelType===r.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}},{key:"setScale",value:function(t){this._scale=Math.abs(t)}},{key:"interfaces_",get:function(){return[Z,j]}}],[{key:"constructor_",value:function(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=r.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof bt){var t=arguments[0];this._modelType=t,t===r.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var e=arguments[0];this._modelType=r.FIXED,this.setScale(e)}else if(arguments[0]instanceof r){var n=arguments[0];this._modelType=n._modelType,this._scale=n._scale}}}},{key:"mostPrecise",value:function(t,e){return t.compareTo(e)>=0?t:e}}]),r}(),bt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"readResolve",value:function(){return r.nameToTypeMap.get(this._name)}},{key:"toString",value:function(){return this._name}},{key:"interfaces_",get:function(){return[Z]}}],[{key:"constructor_",value:function(){this._name=null;var t=arguments[0];this._name=t,r.nameToTypeMap.put(t,this)}}]),r}();bt.nameToTypeMap=new ri,rt.Type=bt,rt.FIXED=new bt("FIXED"),rt.FLOATING=new bt("FLOATING"),rt.FLOATING_SINGLE=new bt("FLOATING SINGLE"),rt.maximumPreciseValue=9007199254740992;var Pe=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"copyInternal",value:function(){for(var n=new Array(this._geometries.length).fill(null),i=0;i<n.length;i++)n[i]=this._geometries[i].copy();return new e(n,this._factory)}},{key:"equalsExact",value:function(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof E){var n=arguments[0],i=arguments[1];return!!this.isEquivalentClass(n)&&M(O(e.prototype),"equalsExact",this).call(this,n,i)}return M(O(e.prototype),"equalsExact",this).apply(this,arguments)}},{key:"getBoundaryDimension",value:function(){return this.isClosed()?k.FALSE:0}},{key:"isClosed",value:function(){if(this.isEmpty())return!1;for(var n=0;n<this._geometries.length;n++)if(!this._geometries[n].isClosed())return!1;return!0}},{key:"getTypeCode",value:function(){return E.TYPECODE_MULTILINESTRING}},{key:"getDimension",value:function(){return 1}},{key:"getBoundary",value:function(){throw new pt}},{key:"getGeometryType",value:function(){return E.TYPENAME_MULTILINESTRING}},{key:"interfaces_",get:function(){return[nn]}}],[{key:"constructor_",value:function(){var n=arguments[0],i=arguments[1];W.constructor_.call(this,n,i)}}]),e}(W),Mt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"createEmpty",value:function(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new P("Invalid dimension: "+t)}}},{key:"toGeometry",value:function(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new v(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new v(t.getMinX(),t.getMinY()),new v(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new v(t.getMinX(),t.getMinY()),new v(t.getMinX(),t.getMaxY()),new v(t.getMaxX(),t.getMaxY()),new v(t.getMaxX(),t.getMinY()),new v(t.getMinX(),t.getMinY())]),null)}},{key:"createLineString",value:function(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLineString(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(b(arguments[0],D)){var e=arguments[0];return new Wt(e,this)}}}},{key:"createMultiLineString",value:function(){if(arguments.length===0)return new Pe(null,this);if(arguments.length===1){var t=arguments[0];return new Pe(t,this)}}},{key:"buildGeometry",value:function(t){for(var e=null,n=!1,i=!1,s=t.iterator();s.hasNext();){var a=s.next(),u=a.getTypeCode();e===null&&(e=u),u!==e&&(n=!0),a instanceof W&&(i=!0)}if(e===null)return this.createGeometryCollection();if(n||i)return this.createGeometryCollection(r.toGeometryArray(t));var o=t.iterator().next();if(t.size()>1){if(o instanceof fe)return this.createMultiPolygon(r.toPolygonArray(t));if(o instanceof Wt)return this.createMultiLineString(r.toLineStringArray(t));if(o instanceof we)return this.createMultiPoint(r.toPointArray(t));A.shouldNeverReachHere("Unhandled geometry type: "+o.getGeometryType())}return o}},{key:"createMultiPointFromCoords",value:function(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)}},{key:"createPoint",value:function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof v){var t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}if(b(arguments[0],D)){var e=arguments[0];return new we(e,this)}}}},{key:"getCoordinateSequenceFactory",value:function(){return this._coordinateSequenceFactory}},{key:"createPolygon",value:function(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(b(arguments[0],D)){var t=arguments[0];return this.createPolygon(this.createLinearRing(t))}if(arguments[0]instanceof Array){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}if(arguments[0]instanceof Kt){var n=arguments[0];return this.createPolygon(n,null)}}else if(arguments.length===2){var i=arguments[0],s=arguments[1];return new fe(i,s,this)}}},{key:"getSRID",value:function(){return this._SRID}},{key:"createGeometryCollection",value:function(){if(arguments.length===0)return new W(null,this);if(arguments.length===1){var t=arguments[0];return new W(t,this)}}},{key:"getPrecisionModel",value:function(){return this._precisionModel}},{key:"createLinearRing",value:function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}if(b(arguments[0],D)){var e=arguments[0];return new Kt(e,this)}}}},{key:"createMultiPolygon",value:function(){if(arguments.length===0)return new Ae(null,this);if(arguments.length===1){var t=arguments[0];return new Ae(t,this)}}},{key:"createMultiPoint",value:function(){if(arguments.length===0)return new Oe(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];return new Oe(t,this)}if(b(arguments[0],D)){var e=arguments[0];if(e===null)return this.createMultiPoint(new Array(0).fill(null));for(var n=new Array(e.size()).fill(null),i=0;i<e.size();i++){var s=this.getCoordinateSequenceFactory().create(1,e.getDimension(),e.getMeasures());Nt.copy(e,i,s,0,1),n[i]=this.createPoint(s)}return this.createMultiPoint(n)}}}},{key:"interfaces_",get:function(){return[Z]}}],[{key:"constructor_",value:function(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)r.constructor_.call(this,new rt,0);else if(arguments.length===1){if(b(arguments[0],en)){var t=arguments[0];r.constructor_.call(this,new rt,0,t)}else if(arguments[0]instanceof rt){var e=arguments[0];r.constructor_.call(this,e,0,r.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){var n=arguments[0],i=arguments[1];r.constructor_.call(this,n,i,r.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){var s=arguments[0],a=arguments[1],u=arguments[2];this._precisionModel=s,this._coordinateSequenceFactory=u,this._SRID=a}}},{key:"toMultiPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toGeometryArray",value:function(t){if(t===null)return null;var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"getDefaultCoordinateSequenceFactory",value:function(){return Me.instance()}},{key:"toMultiLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLineStringArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toMultiPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toLinearRingArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPointArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"toPolygonArray",value:function(t){var e=new Array(t.size()).fill(null);return t.toArray(e)}},{key:"createPointFromInternalCoord",value:function(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}}]),r}(),De="XY",si="XYZ",ai="XYM",ui="XYZM",ln={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},hn="EMPTY",ye=1,yt=2,kt=3,cn=4,At=5,oi=6;for(var li in ln)ln[li].toUpperCase();var hi=function(){function r(t){f(this,r),this.wkt=t,this.index_=-1}return m(r,[{key:"isAlpha_",value:function(t){return t>="a"&&t<="z"||t>="A"&&t<="Z"}},{key:"isNumeric_",value:function(t,e){return t>="0"&&t<="9"||t=="."&&!(e!==void 0&&e)}},{key:"isWhiteSpace_",value:function(t){return t==" "||t=="	"||t=="\r"||t==`
`}},{key:"nextChar_",value:function(){return this.wkt.charAt(++this.index_)}},{key:"nextToken",value:function(){var t,e=this.nextChar_(),n=this.index_,i=e;if(e=="(")t=yt;else if(e==",")t=At;else if(e==")")t=kt;else if(this.isNumeric_(e)||e=="-")t=cn,i=this.readNumber_();else if(this.isAlpha_(e))t=ye,i=this.readText_();else{if(this.isWhiteSpace_(e))return this.nextToken();if(e!=="")throw new Error("Unexpected character: "+e);t=oi}return{position:n,value:i,type:t}}},{key:"readNumber_",value:function(){var t,e=this.index_,n=!1,i=!1;do t=="."?n=!0:t!="e"&&t!="E"||(i=!0),t=this.nextChar_();while(this.isNumeric_(t,n)||!i&&(t=="e"||t=="E")||i&&(t=="-"||t=="+"));return parseFloat(this.wkt.substring(e,this.index_--))}},{key:"readText_",value:function(){var t,e=this.index_;do t=this.nextChar_();while(this.isAlpha_(t));return this.wkt.substring(e,this.index_--).toUpperCase()}}]),r}(),ci=function(){function r(t,e){f(this,r),this.lexer_=t,this.token_,this.layout_=De,this.factory=e}return m(r,[{key:"consume_",value:function(){this.token_=this.lexer_.nextToken()}},{key:"isTokenType",value:function(t){return this.token_.type==t}},{key:"match",value:function(t){var e=this.isTokenType(t);return e&&this.consume_(),e}},{key:"parse",value:function(){return this.consume_(),this.parseGeometry_()}},{key:"parseGeometryLayout_",value:function(){var t=De,e=this.token_;if(this.isTokenType(ye)){var n=e.value;n==="Z"?t=si:n==="M"?t=ai:n==="ZM"&&(t=ui),t!==De&&this.consume_()}return t}},{key:"parseGeometryCollectionText_",value:function(){if(this.match(yt)){var t=[];do t.push(this.parseGeometry_());while(this.match(At));if(this.match(kt))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePointText_",value:function(){if(this.match(yt)){var t=this.parsePoint_();if(this.match(kt))return t}else if(this.isEmptyGeometry_())return null;throw new Error(this.formatErrorMessage_())}},{key:"parseLineStringText_",value:function(){if(this.match(yt)){var t=this.parsePointList_();if(this.match(kt))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePolygonText_",value:function(){if(this.match(yt)){var t=this.parseLineStringTextList_();if(this.match(kt))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPointText_",value:function(){var t;if(this.match(yt)){if(t=this.token_.type==yt?this.parsePointTextList_():this.parsePointList_(),this.match(kt))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiLineStringText_",value:function(){if(this.match(yt)){var t=this.parseLineStringTextList_();if(this.match(kt))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parseMultiPolygonText_",value:function(){if(this.match(yt)){var t=this.parsePolygonTextList_();if(this.match(kt))return t}else if(this.isEmptyGeometry_())return[];throw new Error(this.formatErrorMessage_())}},{key:"parsePoint_",value:function(){for(var t=[],e=this.layout_.length,n=0;n<e;++n){var i=this.token_;if(!this.match(cn))break;t.push(i.value)}if(t.length==e)return t;throw new Error(this.formatErrorMessage_())}},{key:"parsePointList_",value:function(){for(var t=[this.parsePoint_()];this.match(At);)t.push(this.parsePoint_());return t}},{key:"parsePointTextList_",value:function(){for(var t=[this.parsePointText_()];this.match(At);)t.push(this.parsePointText_());return t}},{key:"parseLineStringTextList_",value:function(){for(var t=[this.parseLineStringText_()];this.match(At);)t.push(this.parseLineStringText_());return t}},{key:"parsePolygonTextList_",value:function(){for(var t=[this.parsePolygonText_()];this.match(At);)t.push(this.parsePolygonText_());return t}},{key:"isEmptyGeometry_",value:function(){var t=this.isTokenType(ye)&&this.token_.value==hn;return t&&this.consume_(),t}},{key:"formatErrorMessage_",value:function(){return"Unexpected `"+this.token_.value+"` at position "+this.token_.position+" in `"+this.lexer_.wkt+"`"}},{key:"parseGeometry_",value:function(){var t=this.factory,e=function(N){return It(v,se(N))},n=function(N){var w=N.map(function(G){return t.createLinearRing(G.map(e))});return w.length>1?t.createPolygon(w[0],w.slice(1)):t.createPolygon(w[0])},i=this.token_;if(this.match(ye)){var s=i.value;if(this.layout_=this.parseGeometryLayout_(),s=="GEOMETRYCOLLECTION"){var a=this.parseGeometryCollectionText_();return t.createGeometryCollection(a)}switch(s){case"POINT":var u=this.parsePointText_();return u?t.createPoint(It(v,se(u))):t.createPoint();case"LINESTRING":var o=this.parseLineStringText_().map(e);return t.createLineString(o);case"LINEARRING":var l=this.parseLineStringText_().map(e);return t.createLinearRing(l);case"POLYGON":var c=this.parsePolygonText_();return c&&c.length!==0?n(c):t.createPolygon();case"MULTIPOINT":var g=this.parseMultiPointText_();if(!g||g.length===0)return t.createMultiPoint();var y=g.map(e).map(function(N){return t.createPoint(N)});return t.createMultiPoint(y);case"MULTILINESTRING":var _=this.parseMultiLineStringText_().map(function(N){return t.createLineString(N.map(e))});return t.createMultiLineString(_);case"MULTIPOLYGON":var d=this.parseMultiPolygonText_();if(!d||d.length===0)return t.createMultiPolygon();var x=d.map(n);return t.createMultiPolygon(x);default:throw new Error("Invalid geometry type: "+s)}}throw new Error(this.formatErrorMessage_())}}]),r}();function gn(r){if(r.isEmpty())return"";var t=r.getCoordinate(),e=[t.x,t.y];return t.z===void 0||Number.isNaN(t.z)||e.push(t.z),t.m===void 0||Number.isNaN(t.m)||e.push(t.m),e.join(" ")}function $t(r){for(var t=r.getCoordinates().map(function(s){var a=[s.x,s.y];return s.z===void 0||Number.isNaN(s.z)||a.push(s.z),s.m===void 0||Number.isNaN(s.m)||a.push(s.m),a}),e=[],n=0,i=t.length;n<i;++n)e.push(t[n].join(" "));return e.join(", ")}function fn(r){var t=[];t.push("("+$t(r.getExteriorRing())+")");for(var e=0,n=r.getNumInteriorRing();e<n;++e)t.push("("+$t(r.getInteriorRingN(e))+")");return t.join(", ")}var gi={Point:gn,LineString:$t,LinearRing:$t,Polygon:fn,MultiPoint:function(r){for(var t=[],e=0,n=r.getNumGeometries();e<n;++e)t.push("("+gn(r.getGeometryN(e))+")");return t.join(", ")},MultiLineString:function(r){for(var t=[],e=0,n=r.getNumGeometries();e<n;++e)t.push("("+$t(r.getGeometryN(e))+")");return t.join(", ")},MultiPolygon:function(r){for(var t=[],e=0,n=r.getNumGeometries();e<n;++e)t.push("("+fn(r.getGeometryN(e))+")");return t.join(", ")},GeometryCollection:function(r){for(var t=[],e=0,n=r.getNumGeometries();e<n;++e)t.push(mn(r.getGeometryN(e)));return t.join(", ")}};function mn(r){var t=r.getGeometryType(),e=gi[t];t=t.toUpperCase();var n=function(i){var s="";if(i.isEmpty())return s;var a=i.getCoordinate();return a.z===void 0||Number.isNaN(a.z)||(s+="Z"),a.m===void 0||Number.isNaN(a.m)||(s+="M"),s}(r);return n.length>0&&(t+=" "+n),r.isEmpty()?t+" "+hn:t+" ("+e(r)+")"}var fi=function(){function r(t){f(this,r),this.geometryFactory=t||new Mt,this.precisionModel=this.geometryFactory.getPrecisionModel()}return m(r,[{key:"read",value:function(t){var e=new hi(t);return new ci(e,this.geometryFactory).parse()}},{key:"write",value:function(t){return mn(t)}}]),r}(),Fe=function(){function r(t){f(this,r),this.parser=new fi(t)}return m(r,[{key:"write",value:function(t){return this.parser.write(t)}}],[{key:"toLineString",value:function(t,e){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+t.x+" "+t.y+", "+e.x+" "+e.y+" )"}}]),r}(),X=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getIndexAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intLineIndex[t][e]}},{key:"getTopologySummary",value:function(){var t=new ve;return this.isEndPoint()&&t.append(" endpoint"),this._isProper&&t.append(" proper"),this.isCollinear()&&t.append(" collinear"),t.toString()}},{key:"computeIntersection",value:function(t,e,n,i){this._inputLines[0][0]=t,this._inputLines[0][1]=e,this._inputLines[1][0]=n,this._inputLines[1][1]=i,this._result=this.computeIntersect(t,e,n,i)}},{key:"getIntersectionNum",value:function(){return this._result}},{key:"computeIntLineIndex",value:function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var t=arguments[0],e=this.getEdgeDistance(t,0),n=this.getEdgeDistance(t,1);e>n?(this._intLineIndex[t][0]=0,this._intLineIndex[t][1]=1):(this._intLineIndex[t][0]=1,this._intLineIndex[t][1]=0)}}},{key:"isProper",value:function(){return this.hasIntersection()&&this._isProper}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"isInteriorIntersection",value:function(){if(arguments.length===0)return!!this.isInteriorIntersection(0)||!!this.isInteriorIntersection(1);if(arguments.length===1){for(var t=arguments[0],e=0;e<this._result;e++)if(!this._intPt[e].equals2D(this._inputLines[t][0])&&!this._intPt[e].equals2D(this._inputLines[t][1]))return!0;return!1}}},{key:"getIntersection",value:function(t){return this._intPt[t]}},{key:"isEndPoint",value:function(){return this.hasIntersection()&&!this._isProper}},{key:"hasIntersection",value:function(){return this._result!==r.NO_INTERSECTION}},{key:"getEdgeDistance",value:function(t,e){return r.computeEdgeDistance(this._intPt[e],this._inputLines[t][0],this._inputLines[t][1])}},{key:"isCollinear",value:function(){return this._result===r.COLLINEAR_INTERSECTION}},{key:"toString",value:function(){return Fe.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+Fe.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()}},{key:"getEndpoint",value:function(t,e){return this._inputLines[t][e]}},{key:"isIntersection",value:function(t){for(var e=0;e<this._result;e++)if(this._intPt[e].equals2D(t))return!0;return!1}},{key:"getIntersectionAlongSegment",value:function(t,e){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[t][e]]}}],[{key:"constructor_",value:function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new v,this._intPt[1]=new v,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0}},{key:"computeEdgeDistance",value:function(t,e,n){var i=Math.abs(n.x-e.x),s=Math.abs(n.y-e.y),a=-1;if(t.equals(e))a=0;else if(t.equals(n))a=i>s?i:s;else{var u=Math.abs(t.x-e.x),o=Math.abs(t.y-e.y);(a=i>s?u:o)!==0||t.equals(e)||(a=Math.max(u,o))}return A.isTrue(!(a===0&&!t.equals(e)),"Bad distance calculation"),a}},{key:"nonRobustComputeEdgeDistance",value:function(t,e,n){var i=t.x-e.x,s=t.y-e.y,a=Math.sqrt(i*i+s*s);return A.isTrue(!(a===0&&!t.equals(e)),"Invalid distance calculation"),a}}]),r}();X.DONT_INTERSECT=0,X.DO_INTERSECT=1,X.COLLINEAR=2,X.NO_INTERSECTION=0,X.POINT_INTERSECTION=1,X.COLLINEAR_INTERSECTION=2;var Ct=function(r){C(e,r);var t=R(e);function e(){return f(this,e),t.call(this)}return m(e,[{key:"isInSegmentEnvelopes",value:function(n){var i=new z(this._inputLines[0][0],this._inputLines[0][1]),s=new z(this._inputLines[1][0],this._inputLines[1][1]);return i.contains(n)&&s.contains(n)}},{key:"computeIntersection",value:function(){if(arguments.length!==3)return M(O(e.prototype),"computeIntersection",this).apply(this,arguments);var n=arguments[0],i=arguments[1],s=arguments[2];if(this._isProper=!1,z.intersects(i,s,n)&&L.index(i,s,n)===0&&L.index(s,i,n)===0)return this._isProper=!0,(n.equals(i)||n.equals(s))&&(this._isProper=!1),this._result=X.POINT_INTERSECTION,null;this._result=X.NO_INTERSECTION}},{key:"intersection",value:function(n,i,s,a){var u=this.intersectionSafe(n,i,s,a);return this.isInSegmentEnvelopes(u)||(u=new v(e.nearestEndpoint(n,i,s,a))),this._precisionModel!==null&&this._precisionModel.makePrecise(u),u}},{key:"checkDD",value:function(n,i,s,a,u){var o=Ce.intersection(n,i,s,a),l=this.isInSegmentEnvelopes(o);$.out.println("DD in env = "+l+"  --------------------- "+o),u.distance(o)>1e-4&&$.out.println("Distance = "+u.distance(o))}},{key:"intersectionSafe",value:function(n,i,s,a){var u=Re.intersection(n,i,s,a);return u===null&&(u=e.nearestEndpoint(n,i,s,a)),u}},{key:"computeCollinearIntersection",value:function(n,i,s,a){var u=z.intersects(n,i,s),o=z.intersects(n,i,a),l=z.intersects(s,a,n),c=z.intersects(s,a,i);return u&&o?(this._intPt[0]=s,this._intPt[1]=a,X.COLLINEAR_INTERSECTION):l&&c?(this._intPt[0]=n,this._intPt[1]=i,X.COLLINEAR_INTERSECTION):u&&l?(this._intPt[0]=s,this._intPt[1]=n,!s.equals(n)||o||c?X.COLLINEAR_INTERSECTION:X.POINT_INTERSECTION):u&&c?(this._intPt[0]=s,this._intPt[1]=i,!s.equals(i)||o||l?X.COLLINEAR_INTERSECTION:X.POINT_INTERSECTION):o&&l?(this._intPt[0]=a,this._intPt[1]=n,!a.equals(n)||u||c?X.COLLINEAR_INTERSECTION:X.POINT_INTERSECTION):o&&c?(this._intPt[0]=a,this._intPt[1]=i,!a.equals(i)||u||l?X.COLLINEAR_INTERSECTION:X.POINT_INTERSECTION):X.NO_INTERSECTION}},{key:"computeIntersect",value:function(n,i,s,a){if(this._isProper=!1,!z.intersects(n,i,s,a))return X.NO_INTERSECTION;var u=L.index(n,i,s),o=L.index(n,i,a);if(u>0&&o>0||u<0&&o<0)return X.NO_INTERSECTION;var l=L.index(s,a,n),c=L.index(s,a,i);return l>0&&c>0||l<0&&c<0?X.NO_INTERSECTION:u===0&&o===0&&l===0&&c===0?this.computeCollinearIntersection(n,i,s,a):(u===0||o===0||l===0||c===0?(this._isProper=!1,n.equals2D(s)||n.equals2D(a)?this._intPt[0]=n:i.equals2D(s)||i.equals2D(a)?this._intPt[0]=i:u===0?this._intPt[0]=new v(s):o===0?this._intPt[0]=new v(a):l===0?this._intPt[0]=new v(n):c===0&&(this._intPt[0]=new v(i))):(this._isProper=!0,this._intPt[0]=this.intersection(n,i,s,a)),X.POINT_INTERSECTION)}}],[{key:"nearestEndpoint",value:function(n,i,s,a){var u=n,o=lt.pointToSegment(n,s,a),l=lt.pointToSegment(i,s,a);return l<o&&(o=l,u=i),(l=lt.pointToSegment(s,n,i))<o&&(o=l,u=s),(l=lt.pointToSegment(a,n,i))<o&&(o=l,u=a),u}}]),e}(X),mi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"countSegment",value:function(t,e){if(t.x<this._p.x&&e.x<this._p.x)return null;if(this._p.x===e.x&&this._p.y===e.y)return this._isPointOnSegment=!0,null;if(t.y===this._p.y&&e.y===this._p.y){var n=t.x,i=e.x;return n>i&&(n=e.x,i=t.x),this._p.x>=n&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(t.y>this._p.y&&e.y<=this._p.y||e.y>this._p.y&&t.y<=this._p.y){var s=L.index(t,e,this._p);if(s===L.COLLINEAR)return this._isPointOnSegment=!0,null;e.y<t.y&&(s=-s),s===L.LEFT&&this._crossingCount++}}},{key:"isPointInPolygon",value:function(){return this.getLocation()!==h.EXTERIOR}},{key:"getLocation",value:function(){return this._isPointOnSegment?h.BOUNDARY:this._crossingCount%2==1?h.INTERIOR:h.EXTERIOR}},{key:"isOnSegment",value:function(){return this._isPointOnSegment}}],[{key:"constructor_",value:function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var t=arguments[0];this._p=t}},{key:"locatePointInRing",value:function(){if(arguments[0]instanceof v&&b(arguments[1],D)){for(var t=arguments[0],e=arguments[1],n=new r(t),i=new v,s=new v,a=1;a<e.size();a++)if(e.getCoordinate(a,i),e.getCoordinate(a-1,s),n.countSegment(i,s),n.isOnSegment())return n.getLocation();return n.getLocation()}if(arguments[0]instanceof v&&arguments[1]instanceof Array){for(var u=arguments[0],o=arguments[1],l=new r(u),c=1;c<o.length;c++){var g=o[c],y=o[c-1];if(l.countSegment(g,y),l.isOnSegment())return l.getLocation()}return l.getLocation()}}}]),r}(),Ge=function(){function r(){f(this,r)}return m(r,null,[{key:"isOnLine",value:function(){if(arguments[0]instanceof v&&b(arguments[1],D)){for(var t=arguments[0],e=arguments[1],n=new Ct,i=new v,s=new v,a=e.size(),u=1;u<a;u++)if(e.getCoordinate(u-1,i),e.getCoordinate(u,s),n.computeIntersection(t,i,s),n.hasIntersection())return!0;return!1}if(arguments[0]instanceof v&&arguments[1]instanceof Array){for(var o=arguments[0],l=arguments[1],c=new Ct,g=1;g<l.length;g++){var y=l[g-1],_=l[g];if(c.computeIntersection(o,y,_),c.hasIntersection())return!0}return!1}}},{key:"locateInRing",value:function(t,e){return mi.locatePointInRing(t,e)}},{key:"isInRing",value:function(t,e){return r.locateInRing(t,e)!==h.EXTERIOR}}]),r}(),tt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"setAllLocations",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]=t}},{key:"isNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]!==h.NONE)return!1;return!0}},{key:"setAllLocationsIfNull",value:function(t){for(var e=0;e<this.location.length;e++)this.location[e]===h.NONE&&(this.location[e]=t)}},{key:"isLine",value:function(){return this.location.length===1}},{key:"merge",value:function(t){if(t.location.length>this.location.length){var e=new Array(3).fill(null);e[p.ON]=this.location[p.ON],e[p.LEFT]=h.NONE,e[p.RIGHT]=h.NONE,this.location=e}for(var n=0;n<this.location.length;n++)this.location[n]===h.NONE&&n<t.location.length&&(this.location[n]=t.location[n])}},{key:"getLocations",value:function(){return this.location}},{key:"flip",value:function(){if(this.location.length<=1)return null;var t=this.location[p.LEFT];this.location[p.LEFT]=this.location[p.RIGHT],this.location[p.RIGHT]=t}},{key:"toString",value:function(){var t=new Zt;return this.location.length>1&&t.append(h.toLocationSymbol(this.location[p.LEFT])),t.append(h.toLocationSymbol(this.location[p.ON])),this.location.length>1&&t.append(h.toLocationSymbol(this.location[p.RIGHT])),t.toString()}},{key:"setLocations",value:function(t,e,n){this.location[p.ON]=t,this.location[p.LEFT]=e,this.location[p.RIGHT]=n}},{key:"get",value:function(t){return t<this.location.length?this.location[t]:h.NONE}},{key:"isArea",value:function(){return this.location.length>1}},{key:"isAnyNull",value:function(){for(var t=0;t<this.location.length;t++)if(this.location[t]===h.NONE)return!0;return!1}},{key:"setLocation",value:function(){if(arguments.length===1){var t=arguments[0];this.setLocation(p.ON,t)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this.location[e]=n}}},{key:"init",value:function(t){this.location=new Array(t).fill(null),this.setAllLocations(h.NONE)}},{key:"isEqualOnSide",value:function(t,e){return this.location[e]===t.location[e]}},{key:"allPositionsEqual",value:function(t){for(var e=0;e<this.location.length;e++)if(this.location[e]!==t)return!1;return!0}}],[{key:"constructor_",value:function(){if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var t=arguments[0];this.init(t.length)}else if(Number.isInteger(arguments[0])){var e=arguments[0];this.init(1),this.location[p.ON]=e}else if(arguments[0]instanceof r){var n=arguments[0];if(this.init(n.location.length),n!==null)for(var i=0;i<this.location.length;i++)this.location[i]=n.location[i]}}else if(arguments.length===3){var s=arguments[0],a=arguments[1],u=arguments[2];this.init(3),this.location[p.ON]=s,this.location[p.LEFT]=a,this.location[p.RIGHT]=u}}}]),r}(),et=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getGeometryCount",value:function(){var t=0;return this.elt[0].isNull()||t++,this.elt[1].isNull()||t++,t}},{key:"setAllLocations",value:function(t,e){this.elt[t].setAllLocations(e)}},{key:"isNull",value:function(t){return this.elt[t].isNull()}},{key:"setAllLocationsIfNull",value:function(){if(arguments.length===1){var t=arguments[0];this.setAllLocationsIfNull(0,t),this.setAllLocationsIfNull(1,t)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this.elt[e].setAllLocationsIfNull(n)}}},{key:"isLine",value:function(t){return this.elt[t].isLine()}},{key:"merge",value:function(t){for(var e=0;e<2;e++)this.elt[e]===null&&t.elt[e]!==null?this.elt[e]=new tt(t.elt[e]):this.elt[e].merge(t.elt[e])}},{key:"flip",value:function(){this.elt[0].flip(),this.elt[1].flip()}},{key:"getLocation",value:function(){if(arguments.length===1){var t=arguments[0];return this.elt[t].get(p.ON)}if(arguments.length===2){var e=arguments[0],n=arguments[1];return this.elt[e].get(n)}}},{key:"toString",value:function(){var t=new Zt;return this.elt[0]!==null&&(t.append("A:"),t.append(this.elt[0].toString())),this.elt[1]!==null&&(t.append(" B:"),t.append(this.elt[1].toString())),t.toString()}},{key:"isArea",value:function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var t=arguments[0];return this.elt[t].isArea()}}},{key:"isAnyNull",value:function(t){return this.elt[t].isAnyNull()}},{key:"setLocation",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.elt[t].setLocation(p.ON,e)}else if(arguments.length===3){var n=arguments[0],i=arguments[1],s=arguments[2];this.elt[n].setLocation(i,s)}}},{key:"isEqualOnSide",value:function(t,e){return this.elt[0].isEqualOnSide(t.elt[0],e)&&this.elt[1].isEqualOnSide(t.elt[1],e)}},{key:"allPositionsEqual",value:function(t,e){return this.elt[t].allPositionsEqual(e)}},{key:"toLine",value:function(t){this.elt[t].isArea()&&(this.elt[t]=new tt(this.elt[t].location[0]))}}],[{key:"constructor_",value:function(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var t=arguments[0];this.elt[0]=new tt(t),this.elt[1]=new tt(t)}else if(arguments[0]instanceof r){var e=arguments[0];this.elt[0]=new tt(e.elt[0]),this.elt[1]=new tt(e.elt[1])}}else if(arguments.length===2){var n=arguments[0],i=arguments[1];this.elt[0]=new tt(h.NONE),this.elt[1]=new tt(h.NONE),this.elt[n].setLocation(i)}else if(arguments.length===3){var s=arguments[0],a=arguments[1],u=arguments[2];this.elt[0]=new tt(s,a,u),this.elt[1]=new tt(s,a,u)}else if(arguments.length===4){var o=arguments[0],l=arguments[1],c=arguments[2],g=arguments[3];this.elt[0]=new tt(h.NONE,h.NONE,h.NONE),this.elt[1]=new tt(h.NONE,h.NONE,h.NONE),this.elt[o].setLocations(l,c,g)}}},{key:"toLineLabel",value:function(t){for(var e=new r(h.NONE),n=0;n<2;n++)e.setLocation(n,t.getLocation(n));return e}}]),r}(),de=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"computeRing",value:function(){if(this._ring!==null)return null;for(var t=new Array(this._pts.size()).fill(null),e=0;e<this._pts.size();e++)t[e]=this._pts.get(e);this._ring=this._geometryFactory.createLinearRing(t),this._isHole=L.isCCW(this._ring.getCoordinates())}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"computePoints",value:function(t){this._startDe=t;var e=t,n=!0;do{if(e===null)throw new vt("Found null DirectedEdge");if(e.getEdgeRing()===this)throw new vt("Directed Edge visited twice during ring-building at "+e.getCoordinate());this._edges.add(e);var i=e.getLabel();A.isTrue(i.isArea()),this.mergeLabel(i),this.addPoints(e.getEdge(),e.isForward(),n),n=!1,this.setEdgeRing(e,this),e=this.getNext(e)}while(e!==this._startDe)}},{key:"getLinearRing",value:function(){return this._ring}},{key:"getCoordinate",value:function(t){return this._pts.get(t)}},{key:"computeMaxNodeDegree",value:function(){this._maxNodeDegree=0;var t=this._startDe;do{var e=t.getNode().getEdges().getOutgoingDegree(this);e>this._maxNodeDegree&&(this._maxNodeDegree=e),t=this.getNext(t)}while(t!==this._startDe);this._maxNodeDegree*=2}},{key:"addPoints",value:function(t,e,n){var i=t.getCoordinates();if(e){var s=1;n&&(s=0);for(var a=s;a<i.length;a++)this._pts.add(i[a])}else{var u=i.length-2;n&&(u=i.length-1);for(var o=u;o>=0;o--)this._pts.add(i[o])}}},{key:"isHole",value:function(){return this._isHole}},{key:"setInResult",value:function(){var t=this._startDe;do t.getEdge().setInResult(!0),t=t.getNext();while(t!==this._startDe)}},{key:"containsPoint",value:function(t){var e=this.getLinearRing();if(!e.getEnvelopeInternal().contains(t)||!Ge.isInRing(t,e.getCoordinates()))return!1;for(var n=this._holes.iterator();n.hasNext();)if(n.next().containsPoint(t))return!1;return!0}},{key:"addHole",value:function(t){this._holes.add(t)}},{key:"isShell",value:function(){return this._shell===null}},{key:"getLabel",value:function(){return this._label}},{key:"getEdges",value:function(){return this._edges}},{key:"getMaxNodeDegree",value:function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree}},{key:"getShell",value:function(){return this._shell}},{key:"mergeLabel",value:function(){if(arguments.length===1){var t=arguments[0];this.mergeLabel(t,0),this.mergeLabel(t,1)}else if(arguments.length===2){var e=arguments[0],n=arguments[1],i=e.getLocation(n,p.RIGHT);if(i===h.NONE)return null;if(this._label.getLocation(n)===h.NONE)return this._label.setLocation(n,i),null}}},{key:"setShell",value:function(t){this._shell=t,t!==null&&t.addHole(this)}},{key:"toPolygon",value:function(t){for(var e=new Array(this._holes.size()).fill(null),n=0;n<this._holes.size();n++)e[n]=this._holes.get(n).getLinearRing();return t.createPolygon(this.getLinearRing(),e)}}],[{key:"constructor_",value:function(){if(this._startDe=null,this._maxNodeDegree=-1,this._edges=new T,this._pts=new T,this._label=new et(h.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new T,this._geometryFactory=null,arguments.length!==0&&arguments.length===2){var t=arguments[0],e=arguments[1];this._geometryFactory=e,this.computePoints(t),this.computeRing()}}}]),r}(),vi=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"setEdgeRing",value:function(n,i){n.setMinEdgeRing(i)}},{key:"getNext",value:function(n){return n.getNextMin()}}],[{key:"constructor_",value:function(){var n=arguments[0],i=arguments[1];de.constructor_.call(this,n,i)}}]),e}(de),yi=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"buildMinimalRings",value:function(){var n=new T,i=this._startDe;do{if(i.getMinEdgeRing()===null){var s=new vi(i,this._geometryFactory);n.add(s)}i=i.getNext()}while(i!==this._startDe);return n}},{key:"setEdgeRing",value:function(n,i){n.setEdgeRing(i)}},{key:"linkDirectedEdgesForMinimalEdgeRings",value:function(){var n=this._startDe;do n.getNode().getEdges().linkMinimalDirectedEdges(this),n=n.getNext();while(n!==this._startDe)}},{key:"getNext",value:function(n){return n.getNext()}}],[{key:"constructor_",value:function(){var n=arguments[0],i=arguments[1];de.constructor_.call(this,n,i)}}]),e}(de),vn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"setVisited",value:function(t){this._isVisited=t}},{key:"setInResult",value:function(t){this._isInResult=t}},{key:"isCovered",value:function(){return this._isCovered}},{key:"isCoveredSet",value:function(){return this._isCoveredSet}},{key:"setLabel",value:function(t){this._label=t}},{key:"getLabel",value:function(){return this._label}},{key:"setCovered",value:function(t){this._isCovered=t,this._isCoveredSet=!0}},{key:"updateIM",value:function(t){A.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(t)}},{key:"isInResult",value:function(){return this._isInResult}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0&&arguments.length===1){var t=arguments[0];this._label=t}}}]),r}(),_e=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"isIncidentEdgeInResult",value:function(){for(var n=this.getEdges().getEdges().iterator();n.hasNext();)if(n.next().getEdge().isInResult())return!0;return!1}},{key:"isIsolated",value:function(){return this._label.getGeometryCount()===1}},{key:"getCoordinate",value:function(){return this._coord}},{key:"print",value:function(n){n.println("node "+this._coord+" lbl: "+this._label)}},{key:"computeIM",value:function(n){}},{key:"computeMergedLocation",value:function(n,i){var s=h.NONE;if(s=this._label.getLocation(i),!n.isNull(i)){var a=n.getLocation(i);s!==h.BOUNDARY&&(s=a)}return s}},{key:"setLabel",value:function(){if(arguments.length!==2||!Number.isInteger(arguments[1])||!Number.isInteger(arguments[0]))return M(O(e.prototype),"setLabel",this).apply(this,arguments);var n=arguments[0],i=arguments[1];this._label===null?this._label=new et(n,i):this._label.setLocation(n,i)}},{key:"getEdges",value:function(){return this._edges}},{key:"mergeLabel",value:function(){if(arguments[0]instanceof e){var n=arguments[0];this.mergeLabel(n._label)}else if(arguments[0]instanceof et)for(var i=arguments[0],s=0;s<2;s++){var a=this.computeMergedLocation(i,s),u=this._label.getLocation(s);u===h.NONE&&this._label.setLocation(s,a)}}},{key:"add",value:function(n){this._edges.insert(n),n.setNode(this)}},{key:"setLabelBoundary",value:function(n){if(this._label===null)return null;var i=h.NONE;this._label!==null&&(i=this._label.getLocation(n));var s=null;switch(i){case h.BOUNDARY:s=h.INTERIOR;break;case h.INTERIOR:default:s=h.BOUNDARY}this._label.setLocation(n,s)}}],[{key:"constructor_",value:function(){this._coord=null,this._edges=null;var n=arguments[0],i=arguments[1];this._coord=n,this._edges=i,this._label=new et(0,h.NONE)}}]),e}(vn),di=function(r){C(e,r);var t=R(e);function e(){return f(this,e),t.apply(this,arguments)}return e}(on);function yn(r){return r==null?0:r.color}function F(r){return r==null?null:r.parent}function ht(r,t){r!==null&&(r.color=t)}function qe(r){return r==null?null:r.left}function dn(r){return r==null?null:r.right}var te=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),(n=t.call(this)).root_=null,n.size_=0,n}return m(e,[{key:"get",value:function(n){for(var i=this.root_;i!==null;){var s=n.compareTo(i.key);if(s<0)i=i.left;else{if(!(s>0))return i.value;i=i.right}}return null}},{key:"put",value:function(n,i){if(this.root_===null)return this.root_={key:n,value:i,left:null,right:null,parent:null,color:0,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var s,a,u=this.root_;do if(s=u,(a=n.compareTo(u.key))<0)u=u.left;else{if(!(a>0)){var o=u.value;return u.value=i,o}u=u.right}while(u!==null);var l={key:n,left:null,right:null,value:i,parent:s,color:0,getValue:function(){return this.value},getKey:function(){return this.key}};return a<0?s.left=l:s.right=l,this.fixAfterInsertion(l),this.size_++,null}},{key:"fixAfterInsertion",value:function(n){var i;for(n.color=1;n!=null&&n!==this.root_&&n.parent.color===1;)F(n)===qe(F(F(n)))?yn(i=dn(F(F(n))))===1?(ht(F(n),0),ht(i,0),ht(F(F(n)),1),n=F(F(n))):(n===dn(F(n))&&(n=F(n),this.rotateLeft(n)),ht(F(n),0),ht(F(F(n)),1),this.rotateRight(F(F(n)))):yn(i=qe(F(F(n))))===1?(ht(F(n),0),ht(i,0),ht(F(F(n)),1),n=F(F(n))):(n===qe(F(n))&&(n=F(n),this.rotateRight(n)),ht(F(n),0),ht(F(F(n)),1),this.rotateLeft(F(F(n))));this.root_.color=0}},{key:"values",value:function(){var n=new T,i=this.getFirstEntry();if(i!==null)for(n.add(i.value);(i=e.successor(i))!==null;)n.add(i.value);return n}},{key:"entrySet",value:function(){var n=new Se,i=this.getFirstEntry();if(i!==null)for(n.add(i);(i=e.successor(i))!==null;)n.add(i);return n}},{key:"rotateLeft",value:function(n){if(n!=null){var i=n.right;n.right=i.left,i.left!=null&&(i.left.parent=n),i.parent=n.parent,n.parent==null?this.root_=i:n.parent.left===n?n.parent.left=i:n.parent.right=i,i.left=n,n.parent=i}}},{key:"rotateRight",value:function(n){if(n!=null){var i=n.left;n.left=i.right,i.right!=null&&(i.right.parent=n),i.parent=n.parent,n.parent==null?this.root_=i:n.parent.right===n?n.parent.right=i:n.parent.left=i,i.right=n,n.parent=i}}},{key:"getFirstEntry",value:function(){var n=this.root_;if(n!=null)for(;n.left!=null;)n=n.left;return n}},{key:"size",value:function(){return this.size_}},{key:"containsKey",value:function(n){for(var i=this.root_;i!==null;){var s=n.compareTo(i.key);if(s<0)i=i.left;else{if(!(s>0))return!0;i=i.right}}return!1}}],[{key:"successor",value:function(n){var i;if(n===null)return null;if(n.right!==null){for(i=n.right;i.left!==null;)i=i.left;return i}i=n.parent;for(var s=n;i!==null&&s===i.right;)s=i,i=i.parent;return i}}]),e}(di),_n=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"find",value:function(t){return this.nodeMap.get(t)}},{key:"addNode",value:function(){if(arguments[0]instanceof v){var t=arguments[0],e=this.nodeMap.get(t);return e===null&&(e=this.nodeFact.createNode(t),this.nodeMap.put(t,e)),e}if(arguments[0]instanceof _e){var n=arguments[0],i=this.nodeMap.get(n.getCoordinate());return i===null?(this.nodeMap.put(n.getCoordinate(),n),n):(i.mergeLabel(n),i)}}},{key:"print",value:function(t){for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"iterator",value:function(){return this.nodeMap.values().iterator()}},{key:"values",value:function(){return this.nodeMap.values()}},{key:"getBoundaryNodes",value:function(t){for(var e=new T,n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().getLocation(t)===h.BOUNDARY&&e.add(i)}return e}},{key:"add",value:function(t){var e=t.getCoordinate();this.addNode(e).add(t)}}],[{key:"constructor_",value:function(){this.nodeMap=new te,this.nodeFact=null;var t=arguments[0];this.nodeFact=t}}]),r}(),H=function(){function r(){f(this,r)}return m(r,null,[{key:"isNorthern",value:function(t){return t===r.NE||t===r.NW}},{key:"isOpposite",value:function(t,e){return t!==e&&(t-e+4)%4===2}},{key:"commonHalfPlane",value:function(t,e){if(t===e)return t;if((t-e+4)%4===2)return-1;var n=t<e?t:e;return n===0&&(t>e?t:e)===3?3:n}},{key:"isInHalfPlane",value:function(t,e){return e===r.SE?t===r.SE||t===r.SW:t===e||t===e+1}},{key:"quadrant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new P("Cannot compute the quadrant for point ( "+t+", "+e+" )");return t>=0?e>=0?r.NE:r.SE:e>=0?r.NW:r.SW}if(arguments[0]instanceof v&&arguments[1]instanceof v){var n=arguments[0],i=arguments[1];if(i.x===n.x&&i.y===n.y)throw new P("Cannot compute the quadrant for two identical points "+n);return i.x>=n.x?i.y>=n.y?r.NE:r.SE:i.y>=n.y?r.NW:r.SW}}}]),r}();H.NE=0,H.NW=1,H.SW=2,H.SE=3;var pn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"compareDirection",value:function(t){return this._dx===t._dx&&this._dy===t._dy?0:this._quadrant>t._quadrant?1:this._quadrant<t._quadrant?-1:L.index(t._p0,t._p1,this._p1)}},{key:"getDy",value:function(){return this._dy}},{key:"getCoordinate",value:function(){return this._p0}},{key:"setNode",value:function(t){this._node=t}},{key:"print",value:function(t){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),i=n.lastIndexOf("."),s=n.substring(i+1);t.print("  "+s+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label)}},{key:"compareTo",value:function(t){var e=t;return this.compareDirection(e)}},{key:"getDirectedCoordinate",value:function(){return this._p1}},{key:"getDx",value:function(){return this._dx}},{key:"getLabel",value:function(){return this._label}},{key:"getEdge",value:function(){return this._edge}},{key:"getQuadrant",value:function(){return this._quadrant}},{key:"getNode",value:function(){return this._node}},{key:"toString",value:function(){var t=Math.atan2(this._dy,this._dx),e=this.getClass().getName(),n=e.lastIndexOf(".");return"  "+e.substring(n+1)+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+t+"   "+this._label}},{key:"computeLabel",value:function(t){}},{key:"init",value:function(t,e){this._p0=t,this._p1=e,this._dx=e.x-t.x,this._dy=e.y-t.y,this._quadrant=H.quadrant(this._dx,this._dy),A.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var t=arguments[0];this._edge=t}else if(arguments.length===3){var e=arguments[0],n=arguments[1],i=arguments[2];r.constructor_.call(this,e,n,i,null)}else if(arguments.length===4){var s=arguments[0],a=arguments[1],u=arguments[2],o=arguments[3];r.constructor_.call(this,s),this.init(a,u),this._label=o}}}]),r}(),Ye=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"getNextMin",value:function(){return this._nextMin}},{key:"getDepth",value:function(n){return this._depth[n]}},{key:"setVisited",value:function(n){this._isVisited=n}},{key:"computeDirectedLabel",value:function(){this._label=new et(this._edge.getLabel()),this._isForward||this._label.flip()}},{key:"getNext",value:function(){return this._next}},{key:"setDepth",value:function(n,i){if(this._depth[n]!==-999&&this._depth[n]!==i)throw new vt("assigned depths do not match",this.getCoordinate());this._depth[n]=i}},{key:"isInteriorAreaEdge",value:function(){for(var n=!0,i=0;i<2;i++)this._label.isArea(i)&&this._label.getLocation(i,p.LEFT)===h.INTERIOR&&this._label.getLocation(i,p.RIGHT)===h.INTERIOR||(n=!1);return n}},{key:"setNextMin",value:function(n){this._nextMin=n}},{key:"print",value:function(n){M(O(e.prototype),"print",this).call(this,n),n.print(" "+this._depth[p.LEFT]+"/"+this._depth[p.RIGHT]),n.print(" ("+this.getDepthDelta()+")"),this._isInResult&&n.print(" inResult")}},{key:"setMinEdgeRing",value:function(n){this._minEdgeRing=n}},{key:"isLineEdge",value:function(){var n=this._label.isLine(0)||this._label.isLine(1),i=!this._label.isArea(0)||this._label.allPositionsEqual(0,h.EXTERIOR),s=!this._label.isArea(1)||this._label.allPositionsEqual(1,h.EXTERIOR);return n&&i&&s}},{key:"setEdgeRing",value:function(n){this._edgeRing=n}},{key:"getMinEdgeRing",value:function(){return this._minEdgeRing}},{key:"getDepthDelta",value:function(){var n=this._edge.getDepthDelta();return this._isForward||(n=-n),n}},{key:"setInResult",value:function(n){this._isInResult=n}},{key:"getSym",value:function(){return this._sym}},{key:"isForward",value:function(){return this._isForward}},{key:"getEdge",value:function(){return this._edge}},{key:"printEdge",value:function(n){this.print(n),n.print(" "),this._isForward?this._edge.print(n):this._edge.printReverse(n)}},{key:"setSym",value:function(n){this._sym=n}},{key:"setVisitedEdge",value:function(n){this.setVisited(n),this._sym.setVisited(n)}},{key:"setEdgeDepths",value:function(n,i){var s=this.getEdge().getDepthDelta();this._isForward||(s=-s);var a=1;n===p.LEFT&&(a=-1);var u=p.opposite(n),o=i+s*a;this.setDepth(n,i),this.setDepth(u,o)}},{key:"getEdgeRing",value:function(){return this._edgeRing}},{key:"isInResult",value:function(){return this._isInResult}},{key:"setNext",value:function(n){this._next=n}},{key:"isVisited",value:function(){return this._isVisited}}],[{key:"constructor_",value:function(){this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999];var n=arguments[0],i=arguments[1];if(pn.constructor_.call(this,n),this._isForward=i,i)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var s=n.getNumPoints()-1;this.init(n.getCoordinate(s),n.getCoordinate(s-1))}this.computeDirectedLabel()}},{key:"depthFactor",value:function(n,i){return n===h.EXTERIOR&&i===h.INTERIOR?1:n===h.INTERIOR&&i===h.EXTERIOR?-1:0}}]),e}(pn),kn=function(){function r(){f(this,r)}return m(r,[{key:"createNode",value:function(t){return new _e(t,null)}}]),r}(),xn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"printEdges",value:function(t){t.println("Edges:");for(var e=0;e<this._edges.size();e++){t.println("edge "+e+":");var n=this._edges.get(e);n.print(t),n.eiList.print(t)}}},{key:"find",value:function(t){return this._nodes.find(t)}},{key:"addNode",value:function(){if(arguments[0]instanceof _e){var t=arguments[0];return this._nodes.addNode(t)}if(arguments[0]instanceof v){var e=arguments[0];return this._nodes.addNode(e)}}},{key:"getNodeIterator",value:function(){return this._nodes.iterator()}},{key:"linkResultDirectedEdges",value:function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkResultDirectedEdges()}},{key:"debugPrintln",value:function(t){$.out.println(t)}},{key:"isBoundaryNode",value:function(t,e){var n=this._nodes.find(e);if(n===null)return!1;var i=n.getLabel();return i!==null&&i.getLocation(t)===h.BOUNDARY}},{key:"linkAllDirectedEdges",value:function(){for(var t=this._nodes.iterator();t.hasNext();)t.next().getEdges().linkAllDirectedEdges()}},{key:"matchInSameDirection",value:function(t,e,n,i){return!!t.equals(n)&&L.index(t,e,i)===L.COLLINEAR&&H.quadrant(t,e)===H.quadrant(n,i)}},{key:"getEdgeEnds",value:function(){return this._edgeEndList}},{key:"debugPrint",value:function(t){$.out.print(t)}},{key:"getEdgeIterator",value:function(){return this._edges.iterator()}},{key:"findEdgeInSameDirection",value:function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),s=i.getCoordinates();if(this.matchInSameDirection(t,e,s[0],s[1])||this.matchInSameDirection(t,e,s[s.length-1],s[s.length-2]))return i}return null}},{key:"insertEdge",value:function(t){this._edges.add(t)}},{key:"findEdgeEnd",value:function(t){for(var e=this.getEdgeEnds().iterator();e.hasNext();){var n=e.next();if(n.getEdge()===t)return n}return null}},{key:"addEdges",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next();this._edges.add(n);var i=new Ye(n,!0),s=new Ye(n,!1);i.setSym(s),s.setSym(i),this.add(i),this.add(s)}}},{key:"add",value:function(t){this._nodes.add(t),this._edgeEndList.add(t)}},{key:"getNodes",value:function(){return this._nodes.values()}},{key:"findEdge",value:function(t,e){for(var n=0;n<this._edges.size();n++){var i=this._edges.get(n),s=i.getCoordinates();if(t.equals(s[0])&&e.equals(s[1]))return i}return null}}],[{key:"constructor_",value:function(){if(this._edges=new T,this._nodes=null,this._edgeEndList=new T,arguments.length===0)this._nodes=new _n(new kn);else if(arguments.length===1){var t=arguments[0];this._nodes=new _n(t)}}},{key:"linkResultDirectedEdges",value:function(t){for(var e=t.iterator();e.hasNext();)e.next().getEdges().linkResultDirectedEdges()}}]),r}(),_i=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"sortShellsAndHoles",value:function(t,e,n){for(var i=t.iterator();i.hasNext();){var s=i.next();s.isHole()?n.add(s):e.add(s)}}},{key:"computePolygons",value:function(t){for(var e=new T,n=t.iterator();n.hasNext();){var i=n.next().toPolygon(this._geometryFactory);e.add(i)}return e}},{key:"placeFreeHoles",value:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();if(i.getShell()===null){var s=r.findEdgeRingContaining(i,t);if(s===null)throw new vt("unable to assign hole to a shell",i.getCoordinate(0));i.setShell(s)}}}},{key:"buildMinimalEdgeRings",value:function(t,e,n){for(var i=new T,s=t.iterator();s.hasNext();){var a=s.next();if(a.getMaxNodeDegree()>2){a.linkDirectedEdgesForMinimalEdgeRings();var u=a.buildMinimalRings(),o=this.findShell(u);o!==null?(this.placePolygonHoles(o,u),e.add(o)):n.addAll(u)}else i.add(a)}return i}},{key:"buildMaximalEdgeRings",value:function(t){for(var e=new T,n=t.iterator();n.hasNext();){var i=n.next();if(i.isInResult()&&i.getLabel().isArea()&&i.getEdgeRing()===null){var s=new yi(i,this._geometryFactory);e.add(s),s.setInResult()}}return e}},{key:"placePolygonHoles",value:function(t,e){for(var n=e.iterator();n.hasNext();){var i=n.next();i.isHole()&&i.setShell(t)}}},{key:"getPolygons",value:function(){return this.computePolygons(this._shellList)}},{key:"findShell",value:function(t){for(var e=0,n=null,i=t.iterator();i.hasNext();){var s=i.next();s.isHole()||(n=s,e++)}return A.isTrue(e<=1,"found two shells in MinimalEdgeRing list"),n}},{key:"add",value:function(){if(arguments.length===1){var t=arguments[0];this.add(t.getEdgeEnds(),t.getNodes())}else if(arguments.length===2){var e=arguments[0],n=arguments[1];xn.linkResultDirectedEdges(n);var i=this.buildMaximalEdgeRings(e),s=new T,a=this.buildMinimalEdgeRings(i,this._shellList,s);this.sortShellsAndHoles(a,this._shellList,s),this.placeFreeHoles(this._shellList,s)}}}],[{key:"constructor_",value:function(){this._geometryFactory=null,this._shellList=new T;var t=arguments[0];this._geometryFactory=t}},{key:"findEdgeRingContaining",value:function(t,e){for(var n=t.getLinearRing(),i=n.getEnvelopeInternal(),s=n.getCoordinateN(0),a=null,u=null,o=e.iterator();o.hasNext();){var l=o.next(),c=l.getLinearRing(),g=c.getEnvelopeInternal();if(!g.equals(i)&&g.contains(i)){s=B.ptNotInList(n.getCoordinates(),c.getCoordinates());var y=!1;Ge.isInRing(s,c.getCoordinates())&&(y=!0),y&&(a===null||u.contains(g))&&(u=(a=l).getLinearRing().getEnvelopeInternal())}}return a}}]),r}(),In=function(){function r(){f(this,r)}return m(r,[{key:"getBounds",value:function(){}}]),r}(),dt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getItem",value:function(){return this._item}},{key:"getBounds",value:function(){return this._bounds}},{key:"interfaces_",get:function(){return[In,Z]}}],[{key:"constructor_",value:function(){this._bounds=null,this._item=null;var t=arguments[0],e=arguments[1];this._bounds=t,this._item=e}}]),r}(),pe=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"poll",value:function(){if(this.isEmpty())return null;var t=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),t}},{key:"size",value:function(){return this._size}},{key:"reorder",value:function(t){for(var e=null,n=this._items.get(t);2*t<=this._size&&((e=2*t)!==this._size&&this._items.get(e+1).compareTo(this._items.get(e))<0&&e++,this._items.get(e).compareTo(n)<0);t=e)this._items.set(t,this._items.get(e));this._items.set(t,n)}},{key:"clear",value:function(){this._size=0,this._items.clear()}},{key:"peek",value:function(){return this.isEmpty()?null:this._items.get(1)}},{key:"isEmpty",value:function(){return this._size===0}},{key:"add",value:function(t){this._items.add(null),this._size+=1;var e=this._size;for(this._items.set(0,t);t.compareTo(this._items.get(Math.trunc(e/2)))<0;e/=2)this._items.set(e,this._items.get(Math.trunc(e/2)));this._items.set(e,t)}}],[{key:"constructor_",value:function(){this._size=null,this._items=null,this._size=0,this._items=new T,this._items.add(null)}}]),r}(),pi=function(){function r(){f(this,r)}return m(r,[{key:"insert",value:function(t,e){}},{key:"remove",value:function(t,e){}},{key:"query",value:function(){}}]),r}(),nt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getLevel",value:function(){return this._level}},{key:"size",value:function(){return this._childBoundables.size()}},{key:"getChildBoundables",value:function(){return this._childBoundables}},{key:"addChildBoundable",value:function(t){A.isTrue(this._bounds===null),this._childBoundables.add(t)}},{key:"isEmpty",value:function(){return this._childBoundables.isEmpty()}},{key:"getBounds",value:function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds}},{key:"interfaces_",get:function(){return[In,Z]}}],[{key:"constructor_",value:function(){if(this._childBoundables=new T,this._bounds=null,this._level=null,arguments.length!==0&&arguments.length===1){var t=arguments[0];this._level=t}}}]),r}(),Pt={reverseOrder:function(){return{compare:function(r,t){return t.compareTo(r)}}},min:function(r){return Pt.sort(r),r.get(0)},sort:function(r,t){var e=r.toArray();t?Tt.sort(e,t):Tt.sort(e);for(var n=r.iterator(),i=0,s=e.length;i<s;i++)n.next(),n.set(e[i])},singletonList:function(r){var t=new T;return t.add(r),t}},ki=function(){function r(){f(this,r)}return m(r,null,[{key:"maxDistance",value:function(t,e,n,i,s,a,u,o){var l=r.distance(t,e,s,a);return l=Math.max(l,r.distance(t,e,u,o)),l=Math.max(l,r.distance(n,i,s,a)),l=Math.max(l,r.distance(n,i,u,o))}},{key:"distance",value:function(t,e,n,i){var s=n-t,a=i-e;return Math.sqrt(s*s+a*a)}},{key:"maximumDistance",value:function(t,e){var n=Math.min(t.getMinX(),e.getMinX()),i=Math.min(t.getMinY(),e.getMinY()),s=Math.max(t.getMaxX(),e.getMaxX()),a=Math.max(t.getMaxY(),e.getMaxY());return r.distance(n,i,s,a)}},{key:"minMaxDistance",value:function(t,e){var n=t.getMinX(),i=t.getMinY(),s=t.getMaxX(),a=t.getMaxY(),u=e.getMinX(),o=e.getMinY(),l=e.getMaxX(),c=e.getMaxY(),g=r.maxDistance(n,i,n,a,u,o,u,c);return g=Math.min(g,r.maxDistance(n,i,n,a,u,o,l,o)),g=Math.min(g,r.maxDistance(n,i,n,a,l,c,u,c)),g=Math.min(g,r.maxDistance(n,i,n,a,l,c,l,o)),g=Math.min(g,r.maxDistance(n,i,s,i,u,o,u,c)),g=Math.min(g,r.maxDistance(n,i,s,i,u,o,l,o)),g=Math.min(g,r.maxDistance(n,i,s,i,l,c,u,c)),g=Math.min(g,r.maxDistance(n,i,s,i,l,c,l,o)),g=Math.min(g,r.maxDistance(s,a,n,a,u,o,u,c)),g=Math.min(g,r.maxDistance(s,a,n,a,u,o,l,o)),g=Math.min(g,r.maxDistance(s,a,n,a,l,c,u,c)),g=Math.min(g,r.maxDistance(s,a,n,a,l,c,l,o)),g=Math.min(g,r.maxDistance(s,a,s,i,u,o,u,c)),g=Math.min(g,r.maxDistance(s,a,s,i,u,o,l,o)),g=Math.min(g,r.maxDistance(s,a,s,i,l,c,u,c)),g=Math.min(g,r.maxDistance(s,a,s,i,l,c,l,o))}}]),r}(),Dt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"maximumDistance",value:function(){return ki.maximumDistance(this._boundable1.getBounds(),this._boundable2.getBounds())}},{key:"expandToQueue",value:function(t,e){var n=r.isComposite(this._boundable1),i=r.isComposite(this._boundable2);if(n&&i)return r.area(this._boundable1)>r.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,!1,t,e),null):(this.expand(this._boundable2,this._boundable1,!0,t,e),null);if(n)return this.expand(this._boundable1,this._boundable2,!1,t,e),null;if(i)return this.expand(this._boundable2,this._boundable1,!0,t,e),null;throw new P("neither boundable is composite")}},{key:"isLeaves",value:function(){return!(r.isComposite(this._boundable1)||r.isComposite(this._boundable2))}},{key:"compareTo",value:function(t){var e=t;return this._distance<e._distance?-1:this._distance>e._distance?1:0}},{key:"expand",value:function(t,e,n,i,s){for(var a=t.getChildBoundables().iterator();a.hasNext();){var u=a.next(),o=null;(o=n?new r(e,u,this._itemDistance):new r(u,e,this._itemDistance)).getDistance()<s&&i.add(o)}}},{key:"getBoundable",value:function(t){return t===0?this._boundable1:this._boundable2}},{key:"getDistance",value:function(){return this._distance}},{key:"distance",value:function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var t=arguments[0],e=arguments[1],n=arguments[2];this._boundable1=t,this._boundable2=e,this._itemDistance=n,this._distance=this.distance()}},{key:"area",value:function(t){return t.getBounds().getArea()}},{key:"isComposite",value:function(t){return t instanceof nt}}]),r}(),En=function(){function r(){f(this,r)}return m(r,[{key:"visitItem",value:function(t){}}]),r}(),Ft=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"queryInternal",value:function(){if(b(arguments[2],En)&&arguments[0]instanceof Object&&arguments[1]instanceof nt)for(var t=arguments[0],e=arguments[1],n=arguments[2],i=e.getChildBoundables(),s=0;s<i.size();s++){var a=i.get(s);this.getIntersectsOp().intersects(a.getBounds(),t)&&(a instanceof nt?this.queryInternal(t,a,n):a instanceof dt?n.visitItem(a.getItem()):A.shouldNeverReachHere())}else if(b(arguments[2],Et)&&arguments[0]instanceof Object&&arguments[1]instanceof nt)for(var u=arguments[0],o=arguments[1],l=arguments[2],c=o.getChildBoundables(),g=0;g<c.size();g++){var y=c.get(g);this.getIntersectsOp().intersects(y.getBounds(),u)&&(y instanceof nt?this.queryInternal(u,y,l):y instanceof dt?l.add(y.getItem()):A.shouldNeverReachHere())}}},{key:"getNodeCapacity",value:function(){return this._nodeCapacity}},{key:"lastNode",value:function(t){return t.get(t.size()-1)}},{key:"size",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var t=arguments[0],e=0,n=t.getChildBoundables().iterator();n.hasNext();){var i=n.next();i instanceof nt?e+=this.size(i):i instanceof dt&&(e+=1)}return e}}},{key:"removeItem",value:function(t,e){for(var n=null,i=t.getChildBoundables().iterator();i.hasNext();){var s=i.next();s instanceof dt&&s.getItem()===e&&(n=s)}return n!==null&&(t.getChildBoundables().remove(n),!0)}},{key:"itemsTree",value:function(){if(arguments.length===0){this.build();var t=this.itemsTree(this._root);return t===null?new T:t}if(arguments.length===1){for(var e=arguments[0],n=new T,i=e.getChildBoundables().iterator();i.hasNext();){var s=i.next();if(s instanceof nt){var a=this.itemsTree(s);a!==null&&n.add(a)}else s instanceof dt?n.add(s.getItem()):A.shouldNeverReachHere()}return n.size()<=0?null:n}}},{key:"insert",value:function(t,e){A.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new dt(t,e))}},{key:"boundablesAtLevel",value:function(){if(arguments.length===1){var t=arguments[0],e=new T;return this.boundablesAtLevel(t,this._root,e),e}if(arguments.length===3){var n=arguments[0],i=arguments[1],s=arguments[2];if(A.isTrue(n>-2),i.getLevel()===n)return s.add(i),null;for(var a=i.getChildBoundables().iterator();a.hasNext();){var u=a.next();u instanceof nt?this.boundablesAtLevel(n,u,s):(A.isTrue(u instanceof dt),n===-1&&s.add(u))}return null}}},{key:"query",value:function(){if(arguments.length===1){var t=arguments[0];this.build();var e=new T;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.queryInternal(t,this._root,e),e}if(arguments.length===2){var n=arguments[0],i=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.queryInternal(n,this._root,i)}}},{key:"build",value:function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0}},{key:"getRoot",value:function(){return this.build(),this._root}},{key:"remove",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];return this.build(),!!this.getIntersectsOp().intersects(this._root.getBounds(),t)&&this.remove(t,this._root,e)}if(arguments.length===3){var n=arguments[0],i=arguments[1],s=arguments[2],a=this.removeItem(i,s);if(a)return!0;for(var u=null,o=i.getChildBoundables().iterator();o.hasNext();){var l=o.next();if(this.getIntersectsOp().intersects(l.getBounds(),n)&&l instanceof nt&&(a=this.remove(n,l,s))){u=l;break}}return u!==null&&u.getChildBoundables().isEmpty()&&i.getChildBoundables().remove(u),a}}},{key:"createHigherLevels",value:function(t,e){A.isTrue(!t.isEmpty());var n=this.createParentBoundables(t,e+1);return n.size()===1?n.get(0):this.createHigherLevels(n,e+1)}},{key:"depth",value:function(){if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var t=arguments[0],e=0,n=t.getChildBoundables().iterator();n.hasNext();){var i=n.next();if(i instanceof nt){var s=this.depth(i);s>e&&(e=s)}}return e+1}}},{key:"createParentBoundables",value:function(t,e){A.isTrue(!t.isEmpty());var n=new T;n.add(this.createNode(e));var i=new T(t);Pt.sort(i,this.getComparator());for(var s=i.iterator();s.hasNext();){var a=s.next();this.lastNode(n).getChildBoundables().size()===this.getNodeCapacity()&&n.add(this.createNode(e)),this.lastNode(n).addChildBoundable(a)}return n}},{key:"isEmpty",value:function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()}},{key:"interfaces_",get:function(){return[Z]}}],[{key:"constructor_",value:function(){if(this._root=null,this._built=!1,this._itemBoundables=new T,this._nodeCapacity=null,arguments.length===0)r.constructor_.call(this,r.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var t=arguments[0];A.isTrue(t>1,"Node capacity must be greater than 1"),this._nodeCapacity=t}}},{key:"compareDoubles",value:function(t,e){return t>e?1:t<e?-1:0}}]),r}();Ft.IntersectsOp=function(){},Ft.DEFAULT_NODE_CAPACITY=10;var xi=function(){function r(){f(this,r)}return m(r,[{key:"distance",value:function(t,e){}}]),r}(),ct=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"createParentBoundablesFromVerticalSlices",value:function(n,i){A.isTrue(n.length>0);for(var s=new T,a=0;a<n.length;a++)s.addAll(this.createParentBoundablesFromVerticalSlice(n[a],i));return s}},{key:"nearestNeighbourK",value:function(){if(arguments.length===2){var n=arguments[0],i=arguments[1];return this.nearestNeighbourK(n,I.POSITIVE_INFINITY,i)}if(arguments.length===3){var s=arguments[0],a=arguments[1],u=arguments[2],o=a,l=new pe;l.add(s);for(var c=new pe;!l.isEmpty()&&o>=0;){var g=l.poll(),y=g.getDistance();if(y>=o)break;if(g.isLeaves())if(c.size()<u)c.add(g);else{var _=c.peek();_.getDistance()>y&&(c.poll(),c.add(g));var d=c.peek();o=d.getDistance()}else g.expandToQueue(l,o)}return e.getItems(c)}}},{key:"createNode",value:function(n){return new Nn(n)}},{key:"size",value:function(){return arguments.length===0?M(O(e.prototype),"size",this).call(this):M(O(e.prototype),"size",this).apply(this,arguments)}},{key:"insert",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof z))return M(O(e.prototype),"insert",this).apply(this,arguments);var n=arguments[0],i=arguments[1];if(n.isNull())return null;M(O(e.prototype),"insert",this).call(this,n,i)}},{key:"getIntersectsOp",value:function(){return e.intersectsOp}},{key:"verticalSlices",value:function(n,i){for(var s=Math.trunc(Math.ceil(n.size()/i)),a=new Array(i).fill(null),u=n.iterator(),o=0;o<i;o++){a[o]=new T;for(var l=0;u.hasNext()&&l<s;){var c=u.next();a[o].add(c),l++}}return a}},{key:"query",value:function(){if(arguments.length===1){var n=arguments[0];return M(O(e.prototype),"query",this).call(this,n)}if(arguments.length===2){var i=arguments[0],s=arguments[1];M(O(e.prototype),"query",this).call(this,i,s)}}},{key:"getComparator",value:function(){return e.yComparator}},{key:"createParentBoundablesFromVerticalSlice",value:function(n,i){return M(O(e.prototype),"createParentBoundables",this).call(this,n,i)}},{key:"remove",value:function(){if(arguments.length===2&&arguments[1]instanceof Object&&arguments[0]instanceof z){var n=arguments[0],i=arguments[1];return M(O(e.prototype),"remove",this).call(this,n,i)}return M(O(e.prototype),"remove",this).apply(this,arguments)}},{key:"depth",value:function(){return arguments.length===0?M(O(e.prototype),"depth",this).call(this):M(O(e.prototype),"depth",this).apply(this,arguments)}},{key:"createParentBoundables",value:function(n,i){A.isTrue(!n.isEmpty());var s=Math.trunc(Math.ceil(n.size()/this.getNodeCapacity())),a=new T(n);Pt.sort(a,e.xComparator);var u=this.verticalSlices(a,Math.trunc(Math.ceil(Math.sqrt(s))));return this.createParentBoundablesFromVerticalSlices(u,i)}},{key:"nearestNeighbour",value:function(){if(arguments.length===1){if(b(arguments[0],xi)){var n=arguments[0];if(this.isEmpty())return null;var i=new Dt(this.getRoot(),this.getRoot(),n);return this.nearestNeighbour(i)}if(arguments[0]instanceof Dt){var s=arguments[0],a=I.POSITIVE_INFINITY,u=null,o=new pe;for(o.add(s);!o.isEmpty()&&a>0;){var l=o.poll(),c=l.getDistance();if(c>=a)break;l.isLeaves()?(a=c,u=l):l.expandToQueue(o,a)}return u===null?null:[u.getBoundable(0).getItem(),u.getBoundable(1).getItem()]}}else{if(arguments.length===2){var g=arguments[0],y=arguments[1];if(this.isEmpty()||g.isEmpty())return null;var _=new Dt(this.getRoot(),g.getRoot(),y);return this.nearestNeighbour(_)}if(arguments.length===3){var d=arguments[0],x=arguments[1],N=arguments[2],w=new dt(d,x),G=new Dt(this.getRoot(),w,N);return this.nearestNeighbour(G)[0]}if(arguments.length===4){var U=arguments[0],V=arguments[1],Q=arguments[2],at=arguments[3],_t=new dt(U,V),wt=new Dt(this.getRoot(),_t,Q);return this.nearestNeighbourK(wt,at)}}}},{key:"isWithinDistance",value:function(){if(arguments.length===2){var n=arguments[0],i=arguments[1],s=I.POSITIVE_INFINITY,a=new pe;for(a.add(n);!a.isEmpty();){var u=a.poll(),o=u.getDistance();if(o>i)return!1;if(u.maximumDistance()<=i)return!0;if(u.isLeaves()){if((s=o)<=i)return!0}else u.expandToQueue(a,s)}return!1}if(arguments.length===3){var l=arguments[0],c=arguments[1],g=arguments[2],y=new Dt(this.getRoot(),l.getRoot(),c);return this.isWithinDistance(y,g)}}},{key:"interfaces_",get:function(){return[pi,Z]}}],[{key:"constructor_",value:function(){if(arguments.length===0)e.constructor_.call(this,e.DEFAULT_NODE_CAPACITY);else if(arguments.length===1){var n=arguments[0];Ft.constructor_.call(this,n)}}},{key:"centreX",value:function(n){return e.avg(n.getMinX(),n.getMaxX())}},{key:"avg",value:function(n,i){return(n+i)/2}},{key:"getItems",value:function(n){for(var i=new Array(n.size()).fill(null),s=0;!n.isEmpty();){var a=n.poll();i[s]=a.getBoundable(0).getItem(),s++}return i}},{key:"centreY",value:function(n){return e.avg(n.getMinY(),n.getMaxY())}}]),e}(Ft),Nn=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"computeBounds",value:function(){for(var n=null,i=this.getChildBoundables().iterator();i.hasNext();){var s=i.next();n===null?n=new z(s.getBounds()):n.expandToInclude(s.getBounds())}return n}}],[{key:"constructor_",value:function(){var n=arguments[0];nt.constructor_.call(this,n)}}]),e}(nt);ct.STRtreeNode=Nn,ct.xComparator=new(function(){function r(){f(this,r)}return m(r,[{key:"interfaces_",get:function(){return[Ht]}},{key:"compare",value:function(t,e){return Ft.compareDoubles(ct.centreX(t.getBounds()),ct.centreX(e.getBounds()))}}]),r}()),ct.yComparator=new(function(){function r(){f(this,r)}return m(r,[{key:"interfaces_",get:function(){return[Ht]}},{key:"compare",value:function(t,e){return Ft.compareDoubles(ct.centreY(t.getBounds()),ct.centreY(e.getBounds()))}}]),r}()),ct.intersectsOp=new(function(){function r(){f(this,r)}return m(r,[{key:"interfaces_",get:function(){return[IntersectsOp]}},{key:"intersects",value:function(t,e){return t.intersects(e)}}]),r}()),ct.DEFAULT_NODE_CAPACITY=10;var Ii=function(){function r(){f(this,r)}return m(r,null,[{key:"relativeSign",value:function(t,e){return t<e?-1:t>e?1:0}},{key:"compare",value:function(t,e,n){if(e.equals2D(n))return 0;var i=r.relativeSign(e.x,n.x),s=r.relativeSign(e.y,n.y);switch(t){case 0:return r.compareValue(i,s);case 1:return r.compareValue(s,i);case 2:return r.compareValue(s,-i);case 3:return r.compareValue(-i,s);case 4:return r.compareValue(-i,-s);case 5:return r.compareValue(-s,-i);case 6:return r.compareValue(-s,i);case 7:return r.compareValue(i,-s)}return A.shouldNeverReachHere("invalid octant value"),0}},{key:"compareValue",value:function(t,e){return t<0?-1:t>0?1:e<0?-1:e>0?1:0}}]),r}(),Ei=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex)}},{key:"compareTo",value:function(t){var e=t;return this.segmentIndex<e.segmentIndex?-1:this.segmentIndex>e.segmentIndex?1:this.coord.equals2D(e.coord)?0:this._isInterior?e._isInterior?Ii.compare(this._segmentOctant,this.coord,e.coord):1:-1}},{key:"isEndPoint",value:function(t){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===t}},{key:"toString",value:function(){return this.segmentIndex+":"+this.coord.toString()}},{key:"isInterior",value:function(){return this._isInterior}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._segString=t,this.coord=new v(e),this.segmentIndex=n,this._segmentOctant=i,this._isInterior=!e.equals2D(t.getCoordinate(n))}}]),r}(),Ni=function(){function r(){f(this,r)}return m(r,[{key:"hasNext",value:function(){}},{key:"next",value:function(){}},{key:"remove",value:function(){}}]),r}(),Ti=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getSplitCoordinates",value:function(){var t=new Jt;this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next();this.addEdgeCoordinates(n,i,t),n=i}return t.toCoordinateArray()}},{key:"addCollapsedNodes",value:function(){var t=new T;this.findCollapsesFromInsertedNodes(t),this.findCollapsesFromExistingVertices(t);for(var e=t.iterator();e.hasNext();){var n=e.next().intValue();this.add(this._edge.getCoordinate(n),n)}}},{key:"createSplitEdgePts",value:function(t,e){var n=e.segmentIndex-t.segmentIndex+2;if(n===2)return[new v(t.coord),new v(e.coord)];var i=this._edge.getCoordinate(e.segmentIndex),s=e.isInterior()||!e.coord.equals2D(i);s||n--;var a=new Array(n).fill(null),u=0;a[u++]=new v(t.coord);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)a[u++]=this._edge.getCoordinate(o);return s&&(a[u]=new v(e.coord)),a}},{key:"print",value:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"findCollapsesFromExistingVertices",value:function(t){for(var e=0;e<this._edge.size()-2;e++){var n=this._edge.getCoordinate(e);this._edge.getCoordinate(e+1);var i=this._edge.getCoordinate(e+2);n.equals2D(i)&&t.add(le.valueOf(e+1))}}},{key:"addEdgeCoordinates",value:function(t,e,n){var i=this.createSplitEdgePts(t,e);n.add(i,!1)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(t){this.addEndpoints(),this.addCollapsedNodes();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),s=this.createSplitEdge(n,i);t.add(s),n=i}}},{key:"findCollapseIndex",value:function(t,e,n){if(!t.coord.equals2D(e.coord))return!1;var i=e.segmentIndex-t.segmentIndex;return e.isInterior()||i--,i===1&&(n[0]=t.segmentIndex+1,!0)}},{key:"findCollapsesFromInsertedNodes",value:function(t){for(var e=new Array(1).fill(null),n=this.iterator(),i=n.next();n.hasNext();){var s=n.next();this.findCollapseIndex(i,s,e)&&t.add(le.valueOf(e[0])),i=s}}},{key:"getEdge",value:function(){return this._edge}},{key:"addEndpoints",value:function(){var t=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(t),t)}},{key:"createSplitEdge",value:function(t,e){var n=this.createSplitEdgePts(t,e);return new Rt(n,this._edge.getData())}},{key:"add",value:function(t,e){var n=new Ei(this._edge,t,e,this._edge.getSegmentOctant(e)),i=this._nodeMap.get(n);return i!==null?(A.isTrue(i.coord.equals2D(t),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(n,n),n)}},{key:"checkSplitEdgesCorrectness",value:function(t){var e=this._edge.getCoordinates(),n=t.get(0).getCoordinate(0);if(!n.equals2D(e[0]))throw new ut("bad split edge start point at "+n);var i=t.get(t.size()-1).getCoordinates(),s=i[i.length-1];if(!s.equals2D(e[e.length-1]))throw new ut("bad split edge end point at "+s)}}],[{key:"constructor_",value:function(){this._nodeMap=new te,this._edge=null;var t=arguments[0];this._edge=t}}]),r}(),Si=function(){function r(){f(this,r)}return m(r,null,[{key:"octant",value:function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var t=arguments[0],e=arguments[1];if(t===0&&e===0)throw new P("Cannot compute the octant for point ( "+t+", "+e+" )");var n=Math.abs(t),i=Math.abs(e);return t>=0?e>=0?n>=i?0:1:n>=i?7:6:e>=0?n>=i?3:2:n>=i?4:5}if(arguments[0]instanceof v&&arguments[1]instanceof v){var s=arguments[0],a=arguments[1],u=a.x-s.x,o=a.y-s.y;if(u===0&&o===0)throw new P("Cannot compute the octant for two identical points "+s);return r.octant(u,o)}}}]),r}(),Li=function(){function r(){f(this,r)}return m(r,[{key:"getCoordinates",value:function(){}},{key:"size",value:function(){}},{key:"getCoordinate",value:function(t){}},{key:"isClosed",value:function(){}},{key:"setData",value:function(t){}},{key:"getData",value:function(){}}]),r}(),Ci=function(){function r(){f(this,r)}return m(r,[{key:"addIntersection",value:function(t,e){}},{key:"interfaces_",get:function(){return[Li]}}]),r}(),Rt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getCoordinates",value:function(){return this._pts}},{key:"size",value:function(){return this._pts.length}},{key:"getCoordinate",value:function(t){return this._pts[t]}},{key:"isClosed",value:function(){return this._pts[0].equals(this._pts[this._pts.length-1])}},{key:"getSegmentOctant",value:function(t){return t===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(t),this.getCoordinate(t+1))}},{key:"setData",value:function(t){this._data=t}},{key:"safeOctant",value:function(t,e){return t.equals2D(e)?0:Si.octant(t,e)}},{key:"getData",value:function(){return this._data}},{key:"addIntersection",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.addIntersectionNode(t,e)}else if(arguments.length===4){var n=arguments[0],i=arguments[1],s=arguments[3],a=new v(n.getIntersection(s));this.addIntersection(a,i)}}},{key:"toString",value:function(){return Fe.toLineString(new Qt(this._pts))}},{key:"getNodeList",value:function(){return this._nodeList}},{key:"addIntersectionNode",value:function(t,e){var n=e,i=n+1;if(i<this._pts.length){var s=this._pts[i];t.equals2D(s)&&(n=i)}return this._nodeList.add(t,n)}},{key:"addIntersections",value:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++)this.addIntersection(t,e,n,i)}},{key:"interfaces_",get:function(){return[Ci]}}],[{key:"constructor_",value:function(){this._nodeList=new Ti(this),this._pts=null,this._data=null;var t=arguments[0],e=arguments[1];this._pts=t,this._data=e}},{key:"getNodedSubstrings",value:function(){if(arguments.length===1){var t=arguments[0],e=new T;return r.getNodedSubstrings(t,e),e}if(arguments.length===2)for(var n=arguments[0],i=arguments[1],s=n.iterator();s.hasNext();){var a=s.next();a.getNodeList().addSplitEdges(i)}}}]),r}(),K=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"minX",value:function(){return Math.min(this.p0.x,this.p1.x)}},{key:"orientationIndex",value:function(){if(arguments[0]instanceof r){var t=arguments[0],e=L.index(this.p0,this.p1,t.p0),n=L.index(this.p0,this.p1,t.p1);return e>=0&&n>=0||e<=0&&n<=0?Math.max(e,n):0}if(arguments[0]instanceof v){var i=arguments[0];return L.index(this.p0,this.p1,i)}}},{key:"toGeometry",value:function(t){return t.createLineString([this.p0,this.p1])}},{key:"isVertical",value:function(){return this.p0.x===this.p1.x}},{key:"equals",value:function(t){if(!(t instanceof r))return!1;var e=t;return this.p0.equals(e.p0)&&this.p1.equals(e.p1)}},{key:"intersection",value:function(t){var e=new Ct;return e.computeIntersection(this.p0,this.p1,t.p0,t.p1),e.hasIntersection()?e.getIntersection(0):null}},{key:"project",value:function(){if(arguments[0]instanceof v){var t=arguments[0];if(t.equals(this.p0)||t.equals(this.p1))return new v(t);var e=this.projectionFactor(t),n=new v;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n}if(arguments[0]instanceof r){var i=arguments[0],s=this.projectionFactor(i.p0),a=this.projectionFactor(i.p1);if(s>=1&&a>=1||s<=0&&a<=0)return null;var u=this.project(i.p0);s<0&&(u=this.p0),s>1&&(u=this.p1);var o=this.project(i.p1);return a<0&&(o=this.p0),a>1&&(o=this.p1),new r(u,o)}}},{key:"normalize",value:function(){this.p1.compareTo(this.p0)<0&&this.reverse()}},{key:"angle",value:function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)}},{key:"getCoordinate",value:function(t){return t===0?this.p0:this.p1}},{key:"distancePerpendicular",value:function(t){return lt.pointToLinePerpendicular(t,this.p0,this.p1)}},{key:"minY",value:function(){return Math.min(this.p0.y,this.p1.y)}},{key:"midPoint",value:function(){return r.midPoint(this.p0,this.p1)}},{key:"projectionFactor",value:function(t){if(t.equals(this.p0))return 0;if(t.equals(this.p1))return 1;var e=this.p1.x-this.p0.x,n=this.p1.y-this.p0.y,i=e*e+n*n;return i<=0?I.NaN:((t.x-this.p0.x)*e+(t.y-this.p0.y)*n)/i}},{key:"closestPoints",value:function(t){var e=this.intersection(t);if(e!==null)return[e,e];var n=new Array(2).fill(null),i=I.MAX_VALUE,s=null,a=this.closestPoint(t.p0);i=a.distance(t.p0),n[0]=a,n[1]=t.p0;var u=this.closestPoint(t.p1);(s=u.distance(t.p1))<i&&(i=s,n[0]=u,n[1]=t.p1);var o=t.closestPoint(this.p0);(s=o.distance(this.p0))<i&&(i=s,n[0]=this.p0,n[1]=o);var l=t.closestPoint(this.p1);return(s=l.distance(this.p1))<i&&(i=s,n[0]=this.p1,n[1]=l),n}},{key:"closestPoint",value:function(t){var e=this.projectionFactor(t);return e>0&&e<1?this.project(t):this.p0.distance(t)<this.p1.distance(t)?this.p0:this.p1}},{key:"maxX",value:function(){return Math.max(this.p0.x,this.p1.x)}},{key:"getLength",value:function(){return this.p0.distance(this.p1)}},{key:"compareTo",value:function(t){var e=t,n=this.p0.compareTo(e.p0);return n!==0?n:this.p1.compareTo(e.p1)}},{key:"reverse",value:function(){var t=this.p0;this.p0=this.p1,this.p1=t}},{key:"equalsTopo",value:function(t){return this.p0.equals(t.p0)&&this.p1.equals(t.p1)||this.p0.equals(t.p1)&&this.p1.equals(t.p0)}},{key:"lineIntersection",value:function(t){return Re.intersection(this.p0,this.p1,t.p0,t.p1)}},{key:"maxY",value:function(){return Math.max(this.p0.y,this.p1.y)}},{key:"pointAlongOffset",value:function(t,e){var n=this.p0.x+t*(this.p1.x-this.p0.x),i=this.p0.y+t*(this.p1.y-this.p0.y),s=this.p1.x-this.p0.x,a=this.p1.y-this.p0.y,u=Math.sqrt(s*s+a*a),o=0,l=0;if(e!==0){if(u<=0)throw new IllegalStateException("Cannot compute offset from zero-length line segment");o=e*s/u,l=e*a/u}return new v(n-l,i+o)}},{key:"setCoordinates",value:function(){if(arguments.length===1){var t=arguments[0];this.setCoordinates(t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this.p0.x=e.x,this.p0.y=e.y,this.p1.x=n.x,this.p1.y=n.y}}},{key:"segmentFraction",value:function(t){var e=this.projectionFactor(t);return e<0?e=0:(e>1||I.isNaN(e))&&(e=1),e}},{key:"toString",value:function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"}},{key:"isHorizontal",value:function(){return this.p0.y===this.p1.y}},{key:"reflect",value:function(t){var e=this.p1.getY()-this.p0.getY(),n=this.p0.getX()-this.p1.getX(),i=this.p0.getY()*(this.p1.getX()-this.p0.getX())-this.p0.getX()*(this.p1.getY()-this.p0.getY()),s=e*e+n*n,a=e*e-n*n,u=t.getX(),o=t.getY();return new v((-a*u-2*e*n*o-2*e*i)/s,(a*o-2*e*n*u-2*n*i)/s)}},{key:"distance",value:function(){if(arguments[0]instanceof r){var t=arguments[0];return lt.segmentToSegment(this.p0,this.p1,t.p0,t.p1)}if(arguments[0]instanceof v){var e=arguments[0];return lt.pointToSegment(e,this.p0,this.p1)}}},{key:"pointAlong",value:function(t){var e=new v;return e.x=this.p0.x+t*(this.p1.x-this.p0.x),e.y=this.p0.y+t*(this.p1.y-this.p0.y),e}},{key:"hashCode",value:function(){var t=I.doubleToLongBits(this.p0.x);t^=31*I.doubleToLongBits(this.p0.y);var e=Math.trunc(t)^Math.trunc(t>>32),n=I.doubleToLongBits(this.p1.x);return n^=31*I.doubleToLongBits(this.p1.y),e^(Math.trunc(n)^Math.trunc(n>>32))}},{key:"interfaces_",get:function(){return[j,Z]}}],[{key:"constructor_",value:function(){if(this.p0=null,this.p1=null,arguments.length===0)r.constructor_.call(this,new v,new v);else if(arguments.length===1){var t=arguments[0];r.constructor_.call(this,t.p0,t.p1)}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this.p0=e,this.p1=n}else if(arguments.length===4){var i=arguments[0],s=arguments[1],a=arguments[2],u=arguments[3];r.constructor_.call(this,new v(i,s),new v(a,u))}}},{key:"midPoint",value:function(t,e){return new v((t.x+e.x)/2,(t.y+e.y)/2)}}]),r}(),Ri=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"overlap",value:function(){if(arguments.length!==2&&arguments.length===4){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];t.getLineSegment(e,this._overlapSeg1),n.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}}],[{key:"constructor_",value:function(){this._overlapSeg1=new K,this._overlapSeg2=new K}}]),r}(),Tn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getLineSegment",value:function(t,e){e.p0=this._pts[t],e.p1=this._pts[t+1]}},{key:"computeSelect",value:function(t,e,n,i){var s=this._pts[e],a=this._pts[n];if(n-e==1)return i.select(this,e),null;if(!t.intersects(s,a))return null;var u=Math.trunc((e+n)/2);e<u&&this.computeSelect(t,e,u,i),u<n&&this.computeSelect(t,u,n,i)}},{key:"getCoordinates",value:function(){for(var t=new Array(this._end-this._start+1).fill(null),e=0,n=this._start;n<=this._end;n++)t[e++]=this._pts[n];return t}},{key:"computeOverlaps",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1];this.computeOverlaps(this._start,this._end,t,t._start,t._end,e)}else if(arguments.length===6){var n=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3],u=arguments[4],o=arguments[5];if(i-n==1&&u-a==1)return o.overlap(this,n,s,a),null;if(!this.overlaps(n,i,s,a,u))return null;var l=Math.trunc((n+i)/2),c=Math.trunc((a+u)/2);n<l&&(a<c&&this.computeOverlaps(n,l,s,a,c,o),c<u&&this.computeOverlaps(n,l,s,c,u,o)),l<i&&(a<c&&this.computeOverlaps(l,i,s,a,c,o),c<u&&this.computeOverlaps(l,i,s,c,u,o))}}},{key:"setId",value:function(t){this._id=t}},{key:"select",value:function(t,e){this.computeSelect(t,this._start,this._end,e)}},{key:"getEnvelope",value:function(){if(this._env===null){var t=this._pts[this._start],e=this._pts[this._end];this._env=new z(t,e)}return this._env}},{key:"overlaps",value:function(t,e,n,i,s){return z.intersects(this._pts[t],this._pts[e],n._pts[i],n._pts[s])}},{key:"getEndIndex",value:function(){return this._end}},{key:"getStartIndex",value:function(){return this._start}},{key:"getContext",value:function(){return this._context}},{key:"getId",value:function(){return this._id}}],[{key:"constructor_",value:function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this._pts=t,this._start=e,this._end=n,this._context=i}}]),r}(),wi=function(){function r(){f(this,r)}return m(r,null,[{key:"findChainEnd",value:function(t,e){for(var n=e;n<t.length-1&&t[n].equals2D(t[n+1]);)n++;if(n>=t.length-1)return t.length-1;for(var i=H.quadrant(t[n],t[n+1]),s=e+1;s<t.length&&!(!t[s-1].equals2D(t[s])&&H.quadrant(t[s-1],t[s])!==i);)s++;return s-1}},{key:"getChains",value:function(){if(arguments.length===1){var t=arguments[0];return r.getChains(t,null)}if(arguments.length===2){var e=arguments[0],n=arguments[1],i=new T,s=0;do{var a=r.findChainEnd(e,s),u=new Tn(e,s,a,n);i.add(u),s=a}while(s<e.length-1);return i}}}]),r}(),ze=function(){function r(){f(this,r)}return m(r,[{key:"computeNodes",value:function(t){}},{key:"getNodedSubstrings",value:function(){}}]),r}(),Sn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"setSegmentIntersector",value:function(t){this._segInt=t}},{key:"interfaces_",get:function(){return[ze]}}],[{key:"constructor_",value:function(){if(this._segInt=null,arguments.length!==0&&arguments.length===1){var t=arguments[0];this.setSegmentIntersector(t)}}}]),r}(),Xe=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"getMonotoneChains",value:function(){return this._monoChains}},{key:"getNodedSubstrings",value:function(){return Rt.getNodedSubstrings(this._nodedSegStrings)}},{key:"getIndex",value:function(){return this._index}},{key:"add",value:function(n){for(var i=wi.getChains(n.getCoordinates(),n).iterator();i.hasNext();){var s=i.next();s.setId(this._idCounter++),this._index.insert(s.getEnvelope(),s),this._monoChains.add(s)}}},{key:"computeNodes",value:function(n){this._nodedSegStrings=n;for(var i=n.iterator();i.hasNext();)this.add(i.next());this.intersectChains()}},{key:"intersectChains",value:function(){for(var n=new Ln(this._segInt),i=this._monoChains.iterator();i.hasNext();)for(var s=i.next(),a=this._index.query(s.getEnvelope()).iterator();a.hasNext();){var u=a.next();if(u.getId()>s.getId()&&(s.computeOverlaps(u,n),this._nOverlaps++),this._segInt.isDone())return null}}}],[{key:"constructor_",value:function(){if(this._monoChains=new T,this._index=new ct,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0,arguments.length!==0&&arguments.length===1){var n=arguments[0];Sn.constructor_.call(this,n)}}}]),e}(Sn),Ln=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"overlap",value:function(){if(arguments.length!==4)return M(O(e.prototype),"overlap",this).apply(this,arguments);var n=arguments[0],i=arguments[1],s=arguments[2],a=arguments[3],u=n.getContext(),o=s.getContext();this._si.processIntersections(u,i,o,a)}}],[{key:"constructor_",value:function(){this._si=null;var n=arguments[0];this._si=n}}]),e}(Ri);Xe.SegmentOverlapAction=Ln;var st=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"isDeletable",value:function(t,e,n,i){var s=this._inputLine[t],a=this._inputLine[e],u=this._inputLine[n];return!!this.isConcave(s,a,u)&&!!this.isShallow(s,a,u,i)&&this.isShallowSampled(s,a,t,n,i)}},{key:"deleteShallowConcavities",value:function(){for(var t=1,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e),i=!1;n<this._inputLine.length;){var s=!1;this.isDeletable(t,e,n,this._distanceTol)&&(this._isDeleted[e]=r.DELETE,s=!0,i=!0),t=s?n:e,e=this.findNextNonDeletedIndex(t),n=this.findNextNonDeletedIndex(e)}return i}},{key:"isShallowConcavity",value:function(t,e,n,i){return L.index(t,e,n)===this._angleOrientation&&lt.pointToSegment(e,t,n)<i}},{key:"isShallowSampled",value:function(t,e,n,i,s){var a=Math.trunc((i-n)/r.NUM_PTS_TO_CHECK);a<=0&&(a=1);for(var u=n;u<i;u+=a)if(!this.isShallow(t,e,this._inputLine[u],s))return!1;return!0}},{key:"isConcave",value:function(t,e,n){var i=L.index(t,e,n)===this._angleOrientation;return i}},{key:"simplify",value:function(t){this._distanceTol=Math.abs(t),t<0&&(this._angleOrientation=L.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var e=!1;do e=this.deleteShallowConcavities();while(e);return this.collapseLine()}},{key:"findNextNonDeletedIndex",value:function(t){for(var e=t+1;e<this._inputLine.length&&this._isDeleted[e]===r.DELETE;)e++;return e}},{key:"isShallow",value:function(t,e,n,i){return lt.pointToSegment(e,t,n)<i}},{key:"collapseLine",value:function(){for(var t=new Jt,e=0;e<this._inputLine.length;e++)this._isDeleted[e]!==r.DELETE&&t.add(this._inputLine[e]);return t.toCoordinateArray()}}],[{key:"constructor_",value:function(){this._inputLine=null,this._distanceTol=null,this._isDeleted=null,this._angleOrientation=L.COUNTERCLOCKWISE;var t=arguments[0];this._inputLine=t}},{key:"simplify",value:function(t,e){return new r(t).simplify(e)}}]),r}();st.INIT=0,st.DELETE=1,st.KEEP=1,st.NUM_PTS_TO_CHECK=10;var Cn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getCoordinates",value:function(){return this._ptList.toArray(r.COORDINATE_ARRAY_TYPE)}},{key:"setPrecisionModel",value:function(t){this._precisionModel=t}},{key:"addPt",value:function(t){var e=new v(t);if(this._precisionModel.makePrecise(e),this.isRedundant(e))return null;this._ptList.add(e)}},{key:"reverse",value:function(){}},{key:"addPts",value:function(t,e){if(e)for(var n=0;n<t.length;n++)this.addPt(t[n]);else for(var i=t.length-1;i>=0;i--)this.addPt(t[i])}},{key:"isRedundant",value:function(t){if(this._ptList.size()<1)return!1;var e=this._ptList.get(this._ptList.size()-1);return t.distance(e)<this._minimimVertexDistance}},{key:"toString",value:function(){return new Mt().createLineString(this.getCoordinates()).toString()}},{key:"closeRing",value:function(){if(this._ptList.size()<1)return null;var t=new v(this._ptList.get(0)),e=this._ptList.get(this._ptList.size()-1);if(t.equals(e))return null;this._ptList.add(t)}},{key:"setMinimumVertexDistance",value:function(t){this._minimimVertexDistance=t}}],[{key:"constructor_",value:function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new T}}]),r}();Cn.COORDINATE_ARRAY_TYPE=new Array(0).fill(null);var J=function(){function r(){f(this,r)}return m(r,null,[{key:"toDegrees",value:function(t){return 180*t/Math.PI}},{key:"normalize",value:function(t){for(;t>Math.PI;)t-=r.PI_TIMES_2;for(;t<=-Math.PI;)t+=r.PI_TIMES_2;return t}},{key:"angle",value:function(){if(arguments.length===1){var t=arguments[0];return Math.atan2(t.y,t.x)}if(arguments.length===2){var e=arguments[0],n=arguments[1],i=n.x-e.x,s=n.y-e.y;return Math.atan2(s,i)}}},{key:"isAcute",value:function(t,e,n){var i=t.x-e.x,s=t.y-e.y;return i*(n.x-e.x)+s*(n.y-e.y)>0}},{key:"isObtuse",value:function(t,e,n){var i=t.x-e.x,s=t.y-e.y;return i*(n.x-e.x)+s*(n.y-e.y)<0}},{key:"interiorAngle",value:function(t,e,n){var i=r.angle(e,t),s=r.angle(e,n);return Math.abs(s-i)}},{key:"normalizePositive",value:function(t){if(t<0){for(;t<0;)t+=r.PI_TIMES_2;t>=r.PI_TIMES_2&&(t=0)}else{for(;t>=r.PI_TIMES_2;)t-=r.PI_TIMES_2;t<0&&(t=0)}return t}},{key:"angleBetween",value:function(t,e,n){var i=r.angle(e,t),s=r.angle(e,n);return r.diff(i,s)}},{key:"diff",value:function(t,e){var n=null;return(n=t<e?e-t:t-e)>Math.PI&&(n=2*Math.PI-n),n}},{key:"toRadians",value:function(t){return t*Math.PI/180}},{key:"getTurn",value:function(t,e){var n=Math.sin(e-t);return n>0?r.COUNTERCLOCKWISE:n<0?r.CLOCKWISE:r.NONE}},{key:"angleBetweenOriented",value:function(t,e,n){var i=r.angle(e,t),s=r.angle(e,n)-i;return s<=-Math.PI?s+r.PI_TIMES_2:s>Math.PI?s-r.PI_TIMES_2:s}}]),r}();J.PI_TIMES_2=2*Math.PI,J.PI_OVER_2=Math.PI/2,J.PI_OVER_4=Math.PI/4,J.COUNTERCLOCKWISE=L.COUNTERCLOCKWISE,J.CLOCKWISE=L.CLOCKWISE,J.NONE=L.COLLINEAR;var ee=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"addNextSegment",value:function(t,e){if(this._s0=this._s1,this._s1=this._s2,this._s2=t,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var n=L.index(this._s0,this._s1,this._s2),i=n===L.CLOCKWISE&&this._side===p.LEFT||n===L.COUNTERCLOCKWISE&&this._side===p.RIGHT;n===0?this.addCollinear(e):i?this.addOutsideTurn(n,e):this.addInsideTurn(n,e)}},{key:"addLineEndCap",value:function(t,e){var n=new K(t,e),i=new K;this.computeOffsetSegment(n,p.LEFT,this._distance,i);var s=new K;this.computeOffsetSegment(n,p.RIGHT,this._distance,s);var a=e.x-t.x,u=e.y-t.y,o=Math.atan2(u,a);switch(this._bufParams.getEndCapStyle()){case Y.CAP_ROUND:this._segList.addPt(i.p1),this.addDirectedFillet(e,o+Math.PI/2,o-Math.PI/2,L.CLOCKWISE,this._distance),this._segList.addPt(s.p1);break;case Y.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(s.p1);break;case Y.CAP_SQUARE:var l=new v;l.x=Math.abs(this._distance)*Math.cos(o),l.y=Math.abs(this._distance)*Math.sin(o);var c=new v(i.p1.x+l.x,i.p1.y+l.y),g=new v(s.p1.x+l.x,s.p1.y+l.y);this._segList.addPt(c),this._segList.addPt(g)}}},{key:"getCoordinates",value:function(){return this._segList.getCoordinates()}},{key:"addMitreJoin",value:function(t,e,n,i){var s=Re.intersection(e.p0,e.p1,n.p0,n.p1);if(s!==null&&(i<=0?1:s.distance(t)/Math.abs(i))<=this._bufParams.getMitreLimit())return this._segList.addPt(s),null;this.addLimitedMitreJoin(e,n,i,this._bufParams.getMitreLimit())}},{key:"addOutsideTurn",value:function(t,e){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*r.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===Y.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===Y.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(e&&this._segList.addPt(this._offset0.p1),this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,t,this._distance),this._segList.addPt(this._offset1.p0))}},{key:"createSquare",value:function(t){this._segList.addPt(new v(t.x+this._distance,t.y+this._distance)),this._segList.addPt(new v(t.x+this._distance,t.y-this._distance)),this._segList.addPt(new v(t.x-this._distance,t.y-this._distance)),this._segList.addPt(new v(t.x-this._distance,t.y+this._distance)),this._segList.closeRing()}},{key:"addSegments",value:function(t,e){this._segList.addPts(t,e)}},{key:"addFirstSegment",value:function(){this._segList.addPt(this._offset1.p0)}},{key:"addCornerFillet",value:function(t,e,n,i,s){var a=e.x-t.x,u=e.y-t.y,o=Math.atan2(u,a),l=n.x-t.x,c=n.y-t.y,g=Math.atan2(c,l);i===L.CLOCKWISE?o<=g&&(o+=2*Math.PI):o>=g&&(o-=2*Math.PI),this._segList.addPt(e),this.addDirectedFillet(t,o,g,i,s),this._segList.addPt(n)}},{key:"addLastSegment",value:function(){this._segList.addPt(this._offset1.p1)}},{key:"initSideSegments",value:function(t,e,n){this._s1=t,this._s2=e,this._side=n,this._seg1.setCoordinates(t,e),this.computeOffsetSegment(this._seg1,n,this._distance,this._offset1)}},{key:"addLimitedMitreJoin",value:function(t,e,n,i){var s=this._seg0.p1,a=J.angle(s,this._seg0.p0),u=J.angleBetweenOriented(this._seg0.p0,s,this._seg1.p1)/2,o=J.normalize(a+u),l=J.normalize(o+Math.PI),c=i*n,g=n-c*Math.abs(Math.sin(u)),y=s.x+c*Math.cos(l),_=s.y+c*Math.sin(l),d=new v(y,_),x=new K(s,d),N=x.pointAlongOffset(1,g),w=x.pointAlongOffset(1,-g);this._side===p.LEFT?(this._segList.addPt(N),this._segList.addPt(w)):(this._segList.addPt(w),this._segList.addPt(N))}},{key:"addDirectedFillet",value:function(t,e,n,i,s){var a=i===L.CLOCKWISE?-1:1,u=Math.abs(e-n),o=Math.trunc(u/this._filletAngleQuantum+.5);if(o<1)return null;for(var l=u/o,c=new v,g=0;g<o;g++){var y=e+a*g*l;c.x=t.x+s*Math.cos(y),c.y=t.y+s*Math.sin(y),this._segList.addPt(c)}}},{key:"computeOffsetSegment",value:function(t,e,n,i){var s=e===p.LEFT?1:-1,a=t.p1.x-t.p0.x,u=t.p1.y-t.p0.y,o=Math.sqrt(a*a+u*u),l=s*n*a/o,c=s*n*u/o;i.p0.x=t.p0.x-c,i.p0.y=t.p0.y+l,i.p1.x=t.p1.x-c,i.p1.y=t.p1.y+l}},{key:"addInsideTurn",value:function(t,e){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*r.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var n=new v((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(n);var i=new v((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}}},{key:"createCircle",value:function(t){var e=new v(t.x+this._distance,t.y);this._segList.addPt(e),this.addDirectedFillet(t,0,2*Math.PI,-1,this._distance),this._segList.closeRing()}},{key:"addBevelJoin",value:function(t,e){this._segList.addPt(t.p1),this._segList.addPt(e.p0)}},{key:"init",value:function(t){this._distance=t,this._maxCurveSegmentError=t*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new Cn,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(t*r.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)}},{key:"addCollinear",value:function(t){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2),this._li.getIntersectionNum()>=2&&(this._bufParams.getJoinStyle()===Y.JOIN_BEVEL||this._bufParams.getJoinStyle()===Y.JOIN_MITRE?(t&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addCornerFillet(this._s1,this._offset0.p1,this._offset1.p0,L.CLOCKWISE,this._distance))}},{key:"closeRing",value:function(){this._segList.closeRing()}},{key:"hasNarrowConcaveAngle",value:function(){return this._hasNarrowConcaveAngle}}],[{key:"constructor_",value:function(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new K,this._seg1=new K,this._offset0=new K,this._offset1=new K,this._side=0,this._hasNarrowConcaveAngle=!1;var t=arguments[0],e=arguments[1],n=arguments[2];this._precisionModel=t,this._bufParams=e,this._li=new Ct,this._filletAngleQuantum=Math.PI/2/e.getQuadrantSegments(),e.getQuadrantSegments()>=8&&e.getJoinStyle()===Y.JOIN_ROUND&&(this._closingSegLengthFactor=r.MAX_CLOSING_SEG_LEN_FACTOR),this.init(n)}}]),r}();ee.OFFSET_SEGMENT_SEPARATION_FACTOR=.001,ee.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR=.001,ee.CURVE_VERTEX_SNAP_DISTANCE_FACTOR=1e-6,ee.MAX_CLOSING_SEG_LEN_FACTOR=80;var Oi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getOffsetCurve",value:function(t,e){if(this._distance=e,e===0)return null;var n=e<0,i=Math.abs(e),s=this.getSegGen(i);t.length<=1?this.computePointCurve(t[0],s):this.computeOffsetCurve(t,n,s);var a=s.getCoordinates();return n&&B.reverse(a),a}},{key:"computeSingleSidedBufferCurve",value:function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){n.addSegments(t,!0);var s=st.simplify(t,-i),a=s.length-1;n.initSideSegments(s[a],s[a-1],p.LEFT),n.addFirstSegment();for(var u=a-2;u>=0;u--)n.addNextSegment(s[u],!0)}else{n.addSegments(t,!1);var o=st.simplify(t,i),l=o.length-1;n.initSideSegments(o[0],o[1],p.LEFT),n.addFirstSegment();for(var c=2;c<=l;c++)n.addNextSegment(o[c],!0)}n.addLastSegment(),n.closeRing()}},{key:"computeRingBufferCurve",value:function(t,e,n){var i=this.simplifyTolerance(this._distance);e===p.RIGHT&&(i=-i);var s=st.simplify(t,i),a=s.length-1;n.initSideSegments(s[a-1],s[0],e);for(var u=1;u<=a;u++){var o=u!==1;n.addNextSegment(s[u],o)}n.closeRing()}},{key:"computeLineBufferCurve",value:function(t,e){var n=this.simplifyTolerance(this._distance),i=st.simplify(t,n),s=i.length-1;e.initSideSegments(i[0],i[1],p.LEFT);for(var a=2;a<=s;a++)e.addNextSegment(i[a],!0);e.addLastSegment(),e.addLineEndCap(i[s-1],i[s]);var u=st.simplify(t,-n),o=u.length-1;e.initSideSegments(u[o],u[o-1],p.LEFT);for(var l=o-2;l>=0;l--)e.addNextSegment(u[l],!0);e.addLastSegment(),e.addLineEndCap(u[1],u[0]),e.closeRing()}},{key:"computePointCurve",value:function(t,e){switch(this._bufParams.getEndCapStyle()){case Y.CAP_ROUND:e.createCircle(t);break;case Y.CAP_SQUARE:e.createSquare(t)}}},{key:"getLineCurve",value:function(t,e){if(this._distance=e,this.isLineOffsetEmpty(e))return null;var n=Math.abs(e),i=this.getSegGen(n);if(t.length<=1)this.computePointCurve(t[0],i);else if(this._bufParams.isSingleSided()){var s=e<0;this.computeSingleSidedBufferCurve(t,s,i)}else this.computeLineBufferCurve(t,i);return i.getCoordinates()}},{key:"getBufferParameters",value:function(){return this._bufParams}},{key:"simplifyTolerance",value:function(t){return t*this._bufParams.getSimplifyFactor()}},{key:"getRingCurve",value:function(t,e,n){if(this._distance=n,t.length<=2)return this.getLineCurve(t,n);if(n===0)return r.copyCoordinates(t);var i=this.getSegGen(n);return this.computeRingBufferCurve(t,e,i),i.getCoordinates()}},{key:"computeOffsetCurve",value:function(t,e,n){var i=this.simplifyTolerance(this._distance);if(e){var s=st.simplify(t,-i),a=s.length-1;n.initSideSegments(s[a],s[a-1],p.LEFT),n.addFirstSegment();for(var u=a-2;u>=0;u--)n.addNextSegment(s[u],!0)}else{var o=st.simplify(t,i),l=o.length-1;n.initSideSegments(o[0],o[1],p.LEFT),n.addFirstSegment();for(var c=2;c<=l;c++)n.addNextSegment(o[c],!0)}n.addLastSegment()}},{key:"isLineOffsetEmpty",value:function(t){return t===0||t<0&&!this._bufParams.isSingleSided()}},{key:"getSegGen",value:function(t){return new ee(this._precisionModel,this._bufParams,t)}}],[{key:"constructor_",value:function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var t=arguments[0],e=arguments[1];this._precisionModel=t,this._bufParams=e}},{key:"copyCoordinates",value:function(t){for(var e=new Array(t.length).fill(null),n=0;n<e.length;n++)e[n]=new v(t[n]);return e}}]),r}(),Rn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"findStabbedSegments",value:function(){if(arguments.length===1){for(var t=arguments[0],e=new T,n=this._subgraphs.iterator();n.hasNext();){var i=n.next(),s=i.getEnvelope();t.y<s.getMinY()||t.y>s.getMaxY()||this.findStabbedSegments(t,i.getDirectedEdges(),e)}return e}if(arguments.length===3){if(b(arguments[2],Et)&&arguments[0]instanceof v&&arguments[1]instanceof Ye)for(var a=arguments[0],u=arguments[1],o=arguments[2],l=u.getEdge().getCoordinates(),c=0;c<l.length-1;c++){this._seg.p0=l[c],this._seg.p1=l[c+1],this._seg.p0.y>this._seg.p1.y&&this._seg.reverse();var g=Math.max(this._seg.p0.x,this._seg.p1.x);if(!(g<a.x)&&!(this._seg.isHorizontal()||a.y<this._seg.p0.y||a.y>this._seg.p1.y||L.index(this._seg.p0,this._seg.p1,a)===L.RIGHT)){var y=u.getDepth(p.LEFT);this._seg.p0.equals(l[c])||(y=u.getDepth(p.RIGHT));var _=new wn(this._seg,y);o.add(_)}}else if(b(arguments[2],Et)&&arguments[0]instanceof v&&b(arguments[1],Et))for(var d=arguments[0],x=arguments[1],N=arguments[2],w=x.iterator();w.hasNext();){var G=w.next();G.isForward()&&this.findStabbedSegments(d,G,N)}}}},{key:"getDepth",value:function(t){var e=this.findStabbedSegments(t);return e.size()===0?0:Pt.min(e)._leftDepth}}],[{key:"constructor_",value:function(){this._subgraphs=null,this._seg=new K;var t=arguments[0];this._subgraphs=t}}]),r}(),wn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"compareTo",value:function(t){var e=t;if(this._upwardSeg.minX()>=e._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=e._upwardSeg.minX())return-1;var n=this._upwardSeg.orientationIndex(e._upwardSeg);return n!==0||(n=-1*e._upwardSeg.orientationIndex(this._upwardSeg))!==0?n:this._upwardSeg.compareTo(e._upwardSeg)}},{key:"compareX",value:function(t,e){var n=t.p0.compareTo(e.p0);return n!==0?n:t.p1.compareTo(e.p1)}},{key:"toString",value:function(){return this._upwardSeg.toString()}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._upwardSeg=null,this._leftDepth=null;var t=arguments[0],e=arguments[1];this._upwardSeg=new K(t),this._leftDepth=e}}]),r}();Rn.DepthSegment=wn;var On=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,null,[{key:"constructor_",value:function(){mt.constructor_.call(this,"Projective point not representable on the Cartesian plane.")}}]),e}(mt),Ue=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getY",value:function(){var t=this.y/this.w;if(I.isNaN(t)||I.isInfinite(t))throw new On;return t}},{key:"getX",value:function(){var t=this.x/this.w;if(I.isNaN(t)||I.isInfinite(t))throw new On;return t}},{key:"getCoordinate",value:function(){var t=new v;return t.x=this.getX(),t.y=this.getY(),t}}],[{key:"constructor_",value:function(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var t=arguments[0];this.x=t.x,this.y=t.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1];this.x=e,this.y=n,this.w=1}else if(arguments[0]instanceof r&&arguments[1]instanceof r){var i=arguments[0],s=arguments[1];this.x=i.y*s.w-s.y*i.w,this.y=s.x*i.w-i.x*s.w,this.w=i.x*s.y-s.x*i.y}else if(arguments[0]instanceof v&&arguments[1]instanceof v){var a=arguments[0],u=arguments[1];this.x=a.y-u.y,this.y=u.x-a.x,this.w=a.x*u.y-u.x*a.y}}else if(arguments.length===3){var o=arguments[0],l=arguments[1],c=arguments[2];this.x=o,this.y=l,this.w=c}else if(arguments.length===4){var g=arguments[0],y=arguments[1],_=arguments[2],d=arguments[3],x=g.y-y.y,N=y.x-g.x,w=g.x*y.y-y.x*g.y,G=_.y-d.y,U=d.x-_.x,V=_.x*d.y-d.x*_.y;this.x=N*V-U*w,this.y=G*w-x*V,this.w=x*U-G*N}}}]),r}(),bi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"area",value:function(){return r.area(this.p0,this.p1,this.p2)}},{key:"signedArea",value:function(){return r.signedArea(this.p0,this.p1,this.p2)}},{key:"interpolateZ",value:function(t){if(t===null)throw new P("Supplied point is null.");return r.interpolateZ(t,this.p0,this.p1,this.p2)}},{key:"longestSideLength",value:function(){return r.longestSideLength(this.p0,this.p1,this.p2)}},{key:"isAcute",value:function(){return r.isAcute(this.p0,this.p1,this.p2)}},{key:"circumcentre",value:function(){return r.circumcentre(this.p0,this.p1,this.p2)}},{key:"area3D",value:function(){return r.area3D(this.p0,this.p1,this.p2)}},{key:"centroid",value:function(){return r.centroid(this.p0,this.p1,this.p2)}},{key:"inCentre",value:function(){return r.inCentre(this.p0,this.p1,this.p2)}}],[{key:"constructor_",value:function(){this.p0=null,this.p1=null,this.p2=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.p0=t,this.p1=e,this.p2=n}},{key:"area",value:function(t,e,n){return Math.abs(((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2)}},{key:"signedArea",value:function(t,e,n){return((n.x-t.x)*(e.y-t.y)-(e.x-t.x)*(n.y-t.y))/2}},{key:"det",value:function(t,e,n,i){return t*i-e*n}},{key:"interpolateZ",value:function(t,e,n,i){var s=e.x,a=e.y,u=n.x-s,o=i.x-s,l=n.y-a,c=i.y-a,g=u*c-o*l,y=t.x-s,_=t.y-a,d=(c*y-o*_)/g,x=(-l*y+u*_)/g;return e.getZ()+d*(n.getZ()-e.getZ())+x*(i.getZ()-e.getZ())}},{key:"longestSideLength",value:function(t,e,n){var i=t.distance(e),s=e.distance(n),a=n.distance(t),u=i;return s>u&&(u=s),a>u&&(u=a),u}},{key:"circumcentreDD",value:function(t,e,n){var i=S.valueOf(t.x).subtract(n.x),s=S.valueOf(t.y).subtract(n.y),a=S.valueOf(e.x).subtract(n.x),u=S.valueOf(e.y).subtract(n.y),o=S.determinant(i,s,a,u).multiply(2),l=i.sqr().add(s.sqr()),c=a.sqr().add(u.sqr()),g=S.determinant(s,l,u,c),y=S.determinant(i,l,a,c),_=S.valueOf(n.x).subtract(g.divide(o)).doubleValue(),d=S.valueOf(n.y).add(y.divide(o)).doubleValue();return new v(_,d)}},{key:"isAcute",value:function(t,e,n){return!!J.isAcute(t,e,n)&&!!J.isAcute(e,n,t)&&!!J.isAcute(n,t,e)}},{key:"circumcentre",value:function(t,e,n){var i=n.x,s=n.y,a=t.x-i,u=t.y-s,o=e.x-i,l=e.y-s,c=2*r.det(a,u,o,l),g=r.det(u,a*a+u*u,l,o*o+l*l),y=r.det(a,a*a+u*u,o,o*o+l*l);return new v(i-g/c,s+y/c)}},{key:"perpendicularBisector",value:function(t,e){var n=e.x-t.x,i=e.y-t.y,s=new Ue(t.x+n/2,t.y+i/2,1),a=new Ue(t.x-i+n/2,t.y+n+i/2,1);return new Ue(s,a)}},{key:"angleBisector",value:function(t,e,n){var i=e.distance(t),s=i/(i+e.distance(n)),a=n.x-t.x,u=n.y-t.y;return new v(t.x+s*a,t.y+s*u)}},{key:"area3D",value:function(t,e,n){var i=e.x-t.x,s=e.y-t.y,a=e.getZ()-t.getZ(),u=n.x-t.x,o=n.y-t.y,l=n.getZ()-t.getZ(),c=s*l-a*o,g=a*u-i*l,y=i*o-s*u,_=c*c+g*g+y*y,d=Math.sqrt(_)/2;return d}},{key:"centroid",value:function(t,e,n){var i=(t.x+e.x+n.x)/3,s=(t.y+e.y+n.y)/3;return new v(i,s)}},{key:"inCentre",value:function(t,e,n){var i=e.distance(n),s=t.distance(n),a=t.distance(e),u=i+s+a,o=(i*t.x+s*e.x+a*n.x)/u,l=(i*t.y+s*e.y+a*n.y)/u;return new v(o,l)}}]),r}(),Mi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"addRingSide",value:function(t,e,n,i,s){if(e===0&&t.length<Kt.MINIMUM_VALID_SIZE)return null;var a=i,u=s;t.length>=Kt.MINIMUM_VALID_SIZE&&L.isCCW(t)&&(a=s,u=i,n=p.opposite(n));var o=this._curveBuilder.getRingCurve(t,n,e);this.addCurve(o,a,u)}},{key:"addRingBothSides",value:function(t,e){this.addRingSide(t,e,p.LEFT,h.EXTERIOR,h.INTERIOR),this.addRingSide(t,e,p.RIGHT,h.INTERIOR,h.EXTERIOR)}},{key:"addPoint",value:function(t){if(this._distance<=0)return null;var e=t.getCoordinates(),n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,h.EXTERIOR,h.INTERIOR)}},{key:"addPolygon",value:function(t){var e=this._distance,n=p.LEFT;this._distance<0&&(e=-this._distance,n=p.RIGHT);var i=t.getExteriorRing(),s=B.removeRepeatedPoints(i.getCoordinates());if(this._distance<0&&this.isErodedCompletely(i,this._distance)||this._distance<=0&&s.length<3)return null;this.addRingSide(s,e,n,h.EXTERIOR,h.INTERIOR);for(var a=0;a<t.getNumInteriorRing();a++){var u=t.getInteriorRingN(a),o=B.removeRepeatedPoints(u.getCoordinates());this._distance>0&&this.isErodedCompletely(u,-this._distance)||this.addRingSide(o,e,p.opposite(n),h.INTERIOR,h.EXTERIOR)}}},{key:"isTriangleErodedCompletely",value:function(t,e){var n=new bi(t[0],t[1],t[2]),i=n.inCentre();return lt.pointToSegment(i,n.p0,n.p1)<Math.abs(e)}},{key:"addLineString",value:function(t){if(this._curveBuilder.isLineOffsetEmpty(this._distance))return null;var e=B.removeRepeatedPoints(t.getCoordinates());if(B.isRing(e)&&!this._curveBuilder.getBufferParameters().isSingleSided())this.addRingBothSides(e,this._distance);else{var n=this._curveBuilder.getLineCurve(e,this._distance);this.addCurve(n,h.EXTERIOR,h.INTERIOR)}}},{key:"addCurve",value:function(t,e,n){if(t===null||t.length<2)return null;var i=new Rt(t,new et(0,h.BOUNDARY,e,n));this._curveList.add(i)}},{key:"getCurves",value:function(){return this.add(this._inputGeom),this._curveList}},{key:"add",value:function(t){if(t.isEmpty())return null;if(t instanceof fe)this.addPolygon(t);else if(t instanceof Wt)this.addLineString(t);else if(t instanceof we)this.addPoint(t);else if(t instanceof Oe)this.addCollection(t);else if(t instanceof Pe)this.addCollection(t);else if(t instanceof Ae)this.addCollection(t);else{if(!(t instanceof W))throw new pt(t.getGeometryType());this.addCollection(t)}}},{key:"isErodedCompletely",value:function(t,e){var n=t.getCoordinates();if(n.length<4)return e<0;if(n.length===4)return this.isTriangleErodedCompletely(n,e);var i=t.getEnvelopeInternal(),s=Math.min(i.getHeight(),i.getWidth());return e<0&&2*Math.abs(e)>s}},{key:"addCollection",value:function(t){for(var e=0;e<t.getNumGeometries();e++){var n=t.getGeometryN(e);this.add(n)}}}],[{key:"constructor_",value:function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new T;var t=arguments[0],e=arguments[1],n=arguments[2];this._inputGeom=t,this._distance=e,this._curveBuilder=n}}]),r}(),Ai=function(){function r(){f(this,r)}return m(r,[{key:"locate",value:function(t){}}]),r}(),Pi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"next",value:function(){if(this._atStart)return this._atStart=!1,r.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new oe;var t=this._parent.getGeometryN(this._index++);return t instanceof W?(this._subcollectionIterator=new r(t),this._subcollectionIterator.next()):t}},{key:"remove",value:function(){throw new pt(this.getClass().getName())}},{key:"hasNext",value:function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)}},{key:"interfaces_",get:function(){return[Ni]}}],[{key:"constructor_",value:function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var t=arguments[0];this._parent=t,this._atStart=!0,this._index=0,this._max=t.getNumGeometries()}},{key:"isAtomic",value:function(t){return!(t instanceof W)}}]),r}(),Di=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"locate",value:function(t){return r.locate(t,this._geom)}},{key:"interfaces_",get:function(){return[Ai]}}],[{key:"constructor_",value:function(){this._geom=null;var t=arguments[0];this._geom=t}},{key:"locatePointInPolygon",value:function(t,e){if(e.isEmpty())return h.EXTERIOR;var n=e.getExteriorRing(),i=r.locatePointInRing(t,n);if(i!==h.INTERIOR)return i;for(var s=0;s<e.getNumInteriorRing();s++){var a=e.getInteriorRingN(s),u=r.locatePointInRing(t,a);if(u===h.BOUNDARY)return h.BOUNDARY;if(u===h.INTERIOR)return h.EXTERIOR}return h.INTERIOR}},{key:"locatePointInRing",value:function(t,e){return e.getEnvelopeInternal().intersects(t)?Ge.locateInRing(t,e.getCoordinates()):h.EXTERIOR}},{key:"containsPointInPolygon",value:function(t,e){return h.EXTERIOR!==r.locatePointInPolygon(t,e)}},{key:"locateInGeometry",value:function(t,e){if(e instanceof fe)return r.locatePointInPolygon(t,e);if(e instanceof W)for(var n=new Pi(e);n.hasNext();){var i=n.next();if(i!==e){var s=r.locateInGeometry(t,i);if(s!==h.EXTERIOR)return s}}return h.EXTERIOR}},{key:"isContained",value:function(t,e){return h.EXTERIOR!==r.locate(t,e)}},{key:"locate",value:function(t,e){return e.isEmpty()?h.EXTERIOR:e.getEnvelopeInternal().intersects(t)?r.locateInGeometry(t,e):h.EXTERIOR}}]),r}(),Fi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getNextCW",value:function(t){this.getEdges();var e=this._edgeList.indexOf(t),n=e-1;return e===0&&(n=this._edgeList.size()-1),this._edgeList.get(n)}},{key:"propagateSideLabels",value:function(t){for(var e=h.NONE,n=this.iterator();n.hasNext();){var i=n.next().getLabel();i.isArea(t)&&i.getLocation(t,p.LEFT)!==h.NONE&&(e=i.getLocation(t,p.LEFT))}if(e===h.NONE)return null;for(var s=e,a=this.iterator();a.hasNext();){var u=a.next(),o=u.getLabel();if(o.getLocation(t,p.ON)===h.NONE&&o.setLocation(t,p.ON,s),o.isArea(t)){var l=o.getLocation(t,p.LEFT),c=o.getLocation(t,p.RIGHT);if(c!==h.NONE){if(c!==s)throw new vt("side location conflict",u.getCoordinate());l===h.NONE&&A.shouldNeverReachHere("found single null side (at "+u.getCoordinate()+")"),s=l}else A.isTrue(o.getLocation(t,p.LEFT)===h.NONE,"found single null side"),o.setLocation(t,p.RIGHT,s),o.setLocation(t,p.LEFT,s)}}}},{key:"getCoordinate",value:function(){var t=this.iterator();return t.hasNext()?t.next().getCoordinate():null}},{key:"print",value:function(t){$.out.println("EdgeEndStar:   "+this.getCoordinate());for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"isAreaLabelsConsistent",value:function(t){return this.computeEdgeEndLabels(t.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)}},{key:"checkAreaLabelsConsistent",value:function(t){var e=this.getEdges();if(e.size()<=0)return!0;var n=e.size()-1,i=e.get(n).getLabel().getLocation(t,p.LEFT);A.isTrue(i!==h.NONE,"Found unlabelled area edge");for(var s=i,a=this.iterator();a.hasNext();){var u=a.next().getLabel();A.isTrue(u.isArea(t),"Found non-area edge");var o=u.getLocation(t,p.LEFT),l=u.getLocation(t,p.RIGHT);if(o===l||l!==s)return!1;s=o}return!0}},{key:"findIndex",value:function(t){this.iterator();for(var e=0;e<this._edgeList.size();e++)if(this._edgeList.get(e)===t)return e;return-1}},{key:"iterator",value:function(){return this.getEdges().iterator()}},{key:"getEdges",value:function(){return this._edgeList===null&&(this._edgeList=new T(this._edgeMap.values())),this._edgeList}},{key:"getLocation",value:function(t,e,n){return this._ptInAreaLocation[t]===h.NONE&&(this._ptInAreaLocation[t]=Di.locate(e,n[t].getGeometry())),this._ptInAreaLocation[t]}},{key:"toString",value:function(){var t=new Zt;t.append("EdgeEndStar:   "+this.getCoordinate()),t.append(`
`);for(var e=this.iterator();e.hasNext();){var n=e.next();t.append(n),t.append(`
`)}return t.toString()}},{key:"computeEdgeEndLabels",value:function(t){for(var e=this.iterator();e.hasNext();)e.next().computeLabel(t)}},{key:"computeLabelling",value:function(t){this.computeEdgeEndLabels(t[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var e=[!1,!1],n=this.iterator();n.hasNext();)for(var i=n.next().getLabel(),s=0;s<2;s++)i.isLine(s)&&i.getLocation(s)===h.BOUNDARY&&(e[s]=!0);for(var a=this.iterator();a.hasNext();)for(var u=a.next(),o=u.getLabel(),l=0;l<2;l++)if(o.isAnyNull(l)){var c=h.NONE;if(e[l])c=h.EXTERIOR;else{var g=u.getCoordinate();c=this.getLocation(l,g,t)}o.setAllLocationsIfNull(l,c)}}},{key:"getDegree",value:function(){return this._edgeMap.size()}},{key:"insertEdgeEnd",value:function(t,e){this._edgeMap.put(t,e),this._edgeList=null}}],[{key:"constructor_",value:function(){this._edgeMap=new te,this._edgeList=null,this._ptInAreaLocation=[h.NONE,h.NONE]}}]),r}(),Gi=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"linkResultDirectedEdges",value:function(){this.getResultAreaEdges();for(var n=null,i=null,s=this._SCANNING_FOR_INCOMING,a=0;a<this._resultAreaEdgeList.size();a++){var u=this._resultAreaEdgeList.get(a),o=u.getSym();if(u.getLabel().isArea())switch(n===null&&u.isInResult()&&(n=u),s){case this._SCANNING_FOR_INCOMING:if(!o.isInResult())continue;i=o,s=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(!u.isInResult())continue;i.setNext(u),s=this._SCANNING_FOR_INCOMING}}if(s===this._LINKING_TO_OUTGOING){if(n===null)throw new vt("no outgoing dirEdge found",this.getCoordinate());A.isTrue(n.isInResult(),"unable to link last incoming dirEdge"),i.setNext(n)}}},{key:"insert",value:function(n){var i=n;this.insertEdgeEnd(i,i)}},{key:"getRightmostEdge",value:function(){var n=this.getEdges(),i=n.size();if(i<1)return null;var s=n.get(0);if(i===1)return s;var a=n.get(i-1),u=s.getQuadrant(),o=a.getQuadrant();return H.isNorthern(u)&&H.isNorthern(o)?s:H.isNorthern(u)||H.isNorthern(o)?s.getDy()!==0?s:a.getDy()!==0?a:(A.shouldNeverReachHere("found two horizontal edges incident on node"),null):a}},{key:"print",value:function(n){$.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var i=this.iterator();i.hasNext();){var s=i.next();n.print("out "),s.print(n),n.println(),n.print("in "),s.getSym().print(n),n.println()}}},{key:"getResultAreaEdges",value:function(){if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new T;for(var n=this.iterator();n.hasNext();){var i=n.next();(i.isInResult()||i.getSym().isInResult())&&this._resultAreaEdgeList.add(i)}return this._resultAreaEdgeList}},{key:"updateLabelling",value:function(n){for(var i=this.iterator();i.hasNext();){var s=i.next().getLabel();s.setAllLocationsIfNull(0,n.getLocation(0)),s.setAllLocationsIfNull(1,n.getLocation(1))}}},{key:"linkAllDirectedEdges",value:function(){this.getEdges();for(var n=null,i=null,s=this._edgeList.size()-1;s>=0;s--){var a=this._edgeList.get(s),u=a.getSym();i===null&&(i=u),n!==null&&u.setNext(n),n=a}i.setNext(n)}},{key:"computeDepths",value:function(){if(arguments.length===1){var n=arguments[0],i=this.findIndex(n),s=n.getDepth(p.LEFT),a=n.getDepth(p.RIGHT),u=this.computeDepths(i+1,this._edgeList.size(),s),o=this.computeDepths(0,i,u);if(o!==a)throw new vt("depth mismatch at "+n.getCoordinate())}else if(arguments.length===3){for(var l=arguments[0],c=arguments[1],g=arguments[2],y=g,_=l;_<c;_++){var d=this._edgeList.get(_);d.setEdgeDepths(p.RIGHT,y),y=d.getDepth(p.LEFT)}return y}}},{key:"mergeSymLabels",value:function(){for(var n=this.iterator();n.hasNext();){var i=n.next();i.getLabel().merge(i.getSym().getLabel())}}},{key:"linkMinimalDirectedEdges",value:function(n){for(var i=null,s=null,a=this._SCANNING_FOR_INCOMING,u=this._resultAreaEdgeList.size()-1;u>=0;u--){var o=this._resultAreaEdgeList.get(u),l=o.getSym();switch(i===null&&o.getEdgeRing()===n&&(i=o),a){case this._SCANNING_FOR_INCOMING:if(l.getEdgeRing()!==n)continue;s=l,a=this._LINKING_TO_OUTGOING;break;case this._LINKING_TO_OUTGOING:if(o.getEdgeRing()!==n)continue;s.setNextMin(o),a=this._SCANNING_FOR_INCOMING}}a===this._LINKING_TO_OUTGOING&&(A.isTrue(i!==null,"found null for first outgoing dirEdge"),A.isTrue(i.getEdgeRing()===n,"unable to link last incoming dirEdge"),s.setNextMin(i))}},{key:"getOutgoingDegree",value:function(){if(arguments.length===0){for(var n=0,i=this.iterator();i.hasNext();){var s=i.next();s.isInResult()&&n++}return n}if(arguments.length===1){for(var a=arguments[0],u=0,o=this.iterator();o.hasNext();){var l=o.next();l.getEdgeRing()===a&&u++}return u}}},{key:"getLabel",value:function(){return this._label}},{key:"findCoveredLineEdges",value:function(){for(var n=h.NONE,i=this.iterator();i.hasNext();){var s=i.next(),a=s.getSym();if(!s.isLineEdge()){if(s.isInResult()){n=h.INTERIOR;break}if(a.isInResult()){n=h.EXTERIOR;break}}}if(n===h.NONE)return null;for(var u=n,o=this.iterator();o.hasNext();){var l=o.next(),c=l.getSym();l.isLineEdge()?l.getEdge().setCovered(u===h.INTERIOR):(l.isInResult()&&(u=h.EXTERIOR),c.isInResult()&&(u=h.INTERIOR))}}},{key:"computeLabelling",value:function(n){M(O(e.prototype),"computeLabelling",this).call(this,n),this._label=new et(h.NONE);for(var i=this.iterator();i.hasNext();)for(var s=i.next().getEdge().getLabel(),a=0;a<2;a++){var u=s.getLocation(a);u!==h.INTERIOR&&u!==h.BOUNDARY||this._label.setLocation(a,h.INTERIOR)}}}],[{key:"constructor_",value:function(){this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}}]),e}(Fi),qi=function(r){C(e,r);var t=R(e);function e(){return f(this,e),t.call(this)}return m(e,[{key:"createNode",value:function(n){return new _e(n,new Gi)}}]),e}(kn),bn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"compareTo",value:function(t){var e=t;return r.compareOriented(this._pts,this._orientation,e._pts,e._orientation)}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this._pts=null,this._orientation=null;var t=arguments[0];this._pts=t,this._orientation=r.orientation(t)}},{key:"orientation",value:function(t){return B.increasingDirection(t)===1}},{key:"compareOriented",value:function(t,e,n,i){for(var s=e?1:-1,a=i?1:-1,u=e?t.length:-1,o=i?n.length:-1,l=e?0:t.length-1,c=i?0:n.length-1;;){var g=t[l].compareTo(n[c]);if(g!==0)return g;var y=(l+=s)===u,_=(c+=a)===o;if(y&&!_)return-1;if(!y&&_)return 1;if(y&&_)return 0}}}]),r}(),Yi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"print",value:function(t){t.print("MULTILINESTRING ( ");for(var e=0;e<this._edges.size();e++){var n=this._edges.get(e);e>0&&t.print(","),t.print("(");for(var i=n.getCoordinates(),s=0;s<i.length;s++)s>0&&t.print(","),t.print(i[s].x+" "+i[s].y);t.println(")")}t.print(")  ")}},{key:"addAll",value:function(t){for(var e=t.iterator();e.hasNext();)this.add(e.next())}},{key:"findEdgeIndex",value:function(t){for(var e=0;e<this._edges.size();e++)if(this._edges.get(e).equals(t))return e;return-1}},{key:"iterator",value:function(){return this._edges.iterator()}},{key:"getEdges",value:function(){return this._edges}},{key:"get",value:function(t){return this._edges.get(t)}},{key:"findEqualEdge",value:function(t){var e=new bn(t.getCoordinates());return this._ocaMap.get(e)}},{key:"add",value:function(t){this._edges.add(t);var e=new bn(t.getCoordinates());this._ocaMap.put(e,t)}}],[{key:"constructor_",value:function(){this._edges=new T,this._ocaMap=new te}}]),r}(),Mn=function(){function r(){f(this,r)}return m(r,[{key:"processIntersections",value:function(t,e,n,i){}},{key:"isDone",value:function(){}}]),r}(),zi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"isTrivialIntersection",value:function(t,e,n,i){if(t===n&&this._li.getIntersectionNum()===1){if(r.isAdjacentSegments(e,i))return!0;if(t.isClosed()){var s=t.size()-1;if(e===0&&i===s||i===0&&e===s)return!0}}return!1}},{key:"getProperIntersectionPoint",value:function(){return this._properIntersectionPoint}},{key:"hasProperInteriorIntersection",value:function(){return this._hasProperInterior}},{key:"getLineIntersector",value:function(){return this._li}},{key:"hasProperIntersection",value:function(){return this._hasProper}},{key:"processIntersections",value:function(t,e,n,i){if(t===n&&e===i)return null;this.numTests++;var s=t.getCoordinates()[e],a=t.getCoordinates()[e+1],u=n.getCoordinates()[i],o=n.getCoordinates()[i+1];this._li.computeIntersection(s,a,u,o),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(t,e,n,i)||(this._hasIntersection=!0,t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))}},{key:"hasIntersection",value:function(){return this._hasIntersection}},{key:"isDone",value:function(){return!1}},{key:"hasInteriorIntersection",value:function(){return this._hasInterior}},{key:"interfaces_",get:function(){return[Mn]}}],[{key:"constructor_",value:function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var t=arguments[0];this._li=t}},{key:"isAdjacentSegments",value:function(t,e){return Math.abs(t-e)===1}}]),r}(),Xi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getSegmentIndex",value:function(){return this.segmentIndex}},{key:"getCoordinate",value:function(){return this.coord}},{key:"print",value:function(t){t.print(this.coord),t.print(" seg # = "+this.segmentIndex),t.println(" dist = "+this.dist)}},{key:"compareTo",value:function(t){var e=t;return this.compare(e.segmentIndex,e.dist)}},{key:"isEndPoint",value:function(t){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===t}},{key:"toString",value:function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist}},{key:"getDistance",value:function(){return this.dist}},{key:"compare",value:function(t,e){return this.segmentIndex<t?-1:this.segmentIndex>t?1:this.dist<e?-1:this.dist>e?1:0}},{key:"interfaces_",get:function(){return[j]}}],[{key:"constructor_",value:function(){this.coord=null,this.segmentIndex=null,this.dist=null;var t=arguments[0],e=arguments[1],n=arguments[2];this.coord=new v(t),this.segmentIndex=e,this.dist=n}}]),r}(),Ui=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"print",value:function(t){t.println("Intersections:");for(var e=this.iterator();e.hasNext();)e.next().print(t)}},{key:"iterator",value:function(){return this._nodeMap.values().iterator()}},{key:"addSplitEdges",value:function(t){this.addEndpoints();for(var e=this.iterator(),n=e.next();e.hasNext();){var i=e.next(),s=this.createSplitEdge(n,i);t.add(s),n=i}}},{key:"addEndpoints",value:function(){var t=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[t],t,0)}},{key:"createSplitEdge",value:function(t,e){var n=e.segmentIndex-t.segmentIndex+2,i=this.edge.pts[e.segmentIndex],s=e.dist>0||!e.coord.equals2D(i);s||n--;var a=new Array(n).fill(null),u=0;a[u++]=new v(t.coord);for(var o=t.segmentIndex+1;o<=e.segmentIndex;o++)a[u++]=this.edge.pts[o];return s&&(a[u]=e.coord),new Pn(a,new et(this.edge._label))}},{key:"add",value:function(t,e,n){var i=new Xi(t,e,n),s=this._nodeMap.get(i);return s!==null?s:(this._nodeMap.put(i,i),i)}},{key:"isIntersection",value:function(t){for(var e=this.iterator();e.hasNext();)if(e.next().coord.equals(t))return!0;return!1}}],[{key:"constructor_",value:function(){this._nodeMap=new te,this.edge=null;var t=arguments[0];this.edge=t}}]),r}(),Bi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"isIntersects",value:function(){return!this.isDisjoint()}},{key:"isCovers",value:function(){return(r.isTrue(this._matrix[h.INTERIOR][h.INTERIOR])||r.isTrue(this._matrix[h.INTERIOR][h.BOUNDARY])||r.isTrue(this._matrix[h.BOUNDARY][h.INTERIOR])||r.isTrue(this._matrix[h.BOUNDARY][h.BOUNDARY]))&&this._matrix[h.EXTERIOR][h.INTERIOR]===k.FALSE&&this._matrix[h.EXTERIOR][h.BOUNDARY]===k.FALSE}},{key:"isCoveredBy",value:function(){return(r.isTrue(this._matrix[h.INTERIOR][h.INTERIOR])||r.isTrue(this._matrix[h.INTERIOR][h.BOUNDARY])||r.isTrue(this._matrix[h.BOUNDARY][h.INTERIOR])||r.isTrue(this._matrix[h.BOUNDARY][h.BOUNDARY]))&&this._matrix[h.INTERIOR][h.EXTERIOR]===k.FALSE&&this._matrix[h.BOUNDARY][h.EXTERIOR]===k.FALSE}},{key:"set",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this._matrix[n][i]=k.toDimensionValue(t.charAt(e))}else if(arguments.length===3){var s=arguments[0],a=arguments[1],u=arguments[2];this._matrix[s][a]=u}}},{key:"isContains",value:function(){return r.isTrue(this._matrix[h.INTERIOR][h.INTERIOR])&&this._matrix[h.EXTERIOR][h.INTERIOR]===k.FALSE&&this._matrix[h.EXTERIOR][h.BOUNDARY]===k.FALSE}},{key:"setAtLeast",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<t.length;e++){var n=Math.trunc(e/3),i=e%3;this.setAtLeast(n,i,k.toDimensionValue(t.charAt(e)))}else if(arguments.length===3){var s=arguments[0],a=arguments[1],u=arguments[2];this._matrix[s][a]<u&&(this._matrix[s][a]=u)}}},{key:"setAtLeastIfValid",value:function(t,e,n){t>=0&&e>=0&&this.setAtLeast(t,e,n)}},{key:"isWithin",value:function(){return r.isTrue(this._matrix[h.INTERIOR][h.INTERIOR])&&this._matrix[h.INTERIOR][h.EXTERIOR]===k.FALSE&&this._matrix[h.BOUNDARY][h.EXTERIOR]===k.FALSE}},{key:"isTouches",value:function(t,e){return t>e?this.isTouches(e,t):(t===k.A&&e===k.A||t===k.L&&e===k.L||t===k.L&&e===k.A||t===k.P&&e===k.A||t===k.P&&e===k.L)&&this._matrix[h.INTERIOR][h.INTERIOR]===k.FALSE&&(r.isTrue(this._matrix[h.INTERIOR][h.BOUNDARY])||r.isTrue(this._matrix[h.BOUNDARY][h.INTERIOR])||r.isTrue(this._matrix[h.BOUNDARY][h.BOUNDARY]))}},{key:"isOverlaps",value:function(t,e){return t===k.P&&e===k.P||t===k.A&&e===k.A?r.isTrue(this._matrix[h.INTERIOR][h.INTERIOR])&&r.isTrue(this._matrix[h.INTERIOR][h.EXTERIOR])&&r.isTrue(this._matrix[h.EXTERIOR][h.INTERIOR]):t===k.L&&e===k.L&&this._matrix[h.INTERIOR][h.INTERIOR]===1&&r.isTrue(this._matrix[h.INTERIOR][h.EXTERIOR])&&r.isTrue(this._matrix[h.EXTERIOR][h.INTERIOR])}},{key:"isEquals",value:function(t,e){return t===e&&r.isTrue(this._matrix[h.INTERIOR][h.INTERIOR])&&this._matrix[h.INTERIOR][h.EXTERIOR]===k.FALSE&&this._matrix[h.BOUNDARY][h.EXTERIOR]===k.FALSE&&this._matrix[h.EXTERIOR][h.INTERIOR]===k.FALSE&&this._matrix[h.EXTERIOR][h.BOUNDARY]===k.FALSE}},{key:"toString",value:function(){for(var t=new ve("123456789"),e=0;e<3;e++)for(var n=0;n<3;n++)t.setCharAt(3*e+n,k.toDimensionSymbol(this._matrix[e][n]));return t.toString()}},{key:"setAll",value:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this._matrix[e][n]=t}},{key:"get",value:function(t,e){return this._matrix[t][e]}},{key:"transpose",value:function(){var t=this._matrix[1][0];return this._matrix[1][0]=this._matrix[0][1],this._matrix[0][1]=t,t=this._matrix[2][0],this._matrix[2][0]=this._matrix[0][2],this._matrix[0][2]=t,t=this._matrix[2][1],this._matrix[2][1]=this._matrix[1][2],this._matrix[1][2]=t,this}},{key:"matches",value:function(t){if(t.length!==9)throw new P("Should be length 9: "+t);for(var e=0;e<3;e++)for(var n=0;n<3;n++)if(!r.matches(this._matrix[e][n],t.charAt(3*e+n)))return!1;return!0}},{key:"add",value:function(t){for(var e=0;e<3;e++)for(var n=0;n<3;n++)this.setAtLeast(e,n,t.get(e,n))}},{key:"isDisjoint",value:function(){return this._matrix[h.INTERIOR][h.INTERIOR]===k.FALSE&&this._matrix[h.INTERIOR][h.BOUNDARY]===k.FALSE&&this._matrix[h.BOUNDARY][h.INTERIOR]===k.FALSE&&this._matrix[h.BOUNDARY][h.BOUNDARY]===k.FALSE}},{key:"isCrosses",value:function(t,e){return t===k.P&&e===k.L||t===k.P&&e===k.A||t===k.L&&e===k.A?r.isTrue(this._matrix[h.INTERIOR][h.INTERIOR])&&r.isTrue(this._matrix[h.INTERIOR][h.EXTERIOR]):t===k.L&&e===k.P||t===k.A&&e===k.P||t===k.A&&e===k.L?r.isTrue(this._matrix[h.INTERIOR][h.INTERIOR])&&r.isTrue(this._matrix[h.EXTERIOR][h.INTERIOR]):t===k.L&&e===k.L&&this._matrix[h.INTERIOR][h.INTERIOR]===0}},{key:"interfaces_",get:function(){return[Xt]}}],[{key:"constructor_",value:function(){if(this._matrix=null,arguments.length===0)this._matrix=Array(3).fill().map(function(){return Array(3)}),this.setAll(k.FALSE);else if(arguments.length===1){if(typeof arguments[0]=="string"){var t=arguments[0];r.constructor_.call(this),this.set(t)}else if(arguments[0]instanceof r){var e=arguments[0];r.constructor_.call(this),this._matrix[h.INTERIOR][h.INTERIOR]=e._matrix[h.INTERIOR][h.INTERIOR],this._matrix[h.INTERIOR][h.BOUNDARY]=e._matrix[h.INTERIOR][h.BOUNDARY],this._matrix[h.INTERIOR][h.EXTERIOR]=e._matrix[h.INTERIOR][h.EXTERIOR],this._matrix[h.BOUNDARY][h.INTERIOR]=e._matrix[h.BOUNDARY][h.INTERIOR],this._matrix[h.BOUNDARY][h.BOUNDARY]=e._matrix[h.BOUNDARY][h.BOUNDARY],this._matrix[h.BOUNDARY][h.EXTERIOR]=e._matrix[h.BOUNDARY][h.EXTERIOR],this._matrix[h.EXTERIOR][h.INTERIOR]=e._matrix[h.EXTERIOR][h.INTERIOR],this._matrix[h.EXTERIOR][h.BOUNDARY]=e._matrix[h.EXTERIOR][h.BOUNDARY],this._matrix[h.EXTERIOR][h.EXTERIOR]=e._matrix[h.EXTERIOR][h.EXTERIOR]}}}},{key:"matches",value:function(){if(Number.isInteger(arguments[0])&&typeof arguments[1]=="string"){var t=arguments[0],e=arguments[1];return e===k.SYM_DONTCARE||e===k.SYM_TRUE&&(t>=0||t===k.TRUE)||e===k.SYM_FALSE&&t===k.FALSE||e===k.SYM_P&&t===k.P||e===k.SYM_L&&t===k.L||e===k.SYM_A&&t===k.A}if(typeof arguments[0]=="string"&&typeof arguments[1]=="string"){var n=arguments[0],i=arguments[1],s=new r(n);return s.matches(i)}}},{key:"isTrue",value:function(t){return t>=0||t===k.TRUE}}]),r}(),Vi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"size",value:function(){return this._size}},{key:"addAll",value:function(t){return t===null||t.length===0?null:(this.ensureCapacity(this._size+t.length),$.arraycopy(t,0,this._data,this._size,t.length),void(this._size+=t.length))}},{key:"ensureCapacity",value:function(t){if(t<=this._data.length)return null;var e=Math.max(t,2*this._data.length);this._data=Tt.copyOf(this._data,e)}},{key:"toArray",value:function(){var t=new Array(this._size).fill(null);return $.arraycopy(this._data,0,t,0,this._size),t}},{key:"add",value:function(t){this.ensureCapacity(this._size+1),this._data[this._size]=t,++this._size}}],[{key:"constructor_",value:function(){if(this._data=null,this._size=0,arguments.length===0)r.constructor_.call(this,10);else if(arguments.length===1){var t=arguments[0];this._data=new Array(t).fill(null)}}}]),r}(),Hi=function(){function r(){f(this,r)}return m(r,[{key:"getChainStartIndices",value:function(t){var e=0,n=new Vi(Math.trunc(t.length/2));n.add(e);do{var i=this.findChainEnd(t,e);n.add(i),e=i}while(e<t.length-1);return n.toArray()}},{key:"findChainEnd",value:function(t,e){for(var n=H.quadrant(t[e],t[e+1]),i=e+1;i<t.length&&H.quadrant(t[i-1],t[i])===n;)i++;return i-1}},{key:"OLDgetChainStartIndices",value:function(t){var e=0,n=new T;n.add(e);do{var i=this.findChainEnd(t,e);n.add(i),e=i}while(e<t.length-1);return r.toIntArray(n)}}],[{key:"toIntArray",value:function(t){for(var e=new Array(t.size()).fill(null),n=0;n<e.length;n++)e[n]=t.get(n).intValue();return e}}]),r}(),Zi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getCoordinates",value:function(){return this.pts}},{key:"getMaxX",value:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e>n?e:n}},{key:"getMinX",value:function(t){var e=this.pts[this.startIndex[t]].x,n=this.pts[this.startIndex[t+1]].x;return e<n?e:n}},{key:"computeIntersectsForChain",value:function(){if(arguments.length===4){var t=arguments[0],e=arguments[1],n=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[t],this.startIndex[t+1],e,e.startIndex[n],e.startIndex[n+1],i)}else if(arguments.length===6){var s=arguments[0],a=arguments[1],u=arguments[2],o=arguments[3],l=arguments[4],c=arguments[5];if(a-s==1&&l-o==1)return c.addIntersections(this.e,s,u.e,o),null;if(!this.overlaps(s,a,u,o,l))return null;var g=Math.trunc((s+a)/2),y=Math.trunc((o+l)/2);s<g&&(o<y&&this.computeIntersectsForChain(s,g,u,o,y,c),y<l&&this.computeIntersectsForChain(s,g,u,y,l,c)),g<a&&(o<y&&this.computeIntersectsForChain(g,a,u,o,y,c),y<l&&this.computeIntersectsForChain(g,a,u,y,l,c))}}},{key:"overlaps",value:function(t,e,n,i,s){return z.intersects(this.pts[t],this.pts[e],n.pts[i],n.pts[s])}},{key:"getStartIndexes",value:function(){return this.startIndex}},{key:"computeIntersects",value:function(t,e){for(var n=0;n<this.startIndex.length-1;n++)for(var i=0;i<t.startIndex.length-1;i++)this.computeIntersectsForChain(n,t,i,e)}}],[{key:"constructor_",value:function(){this.e=null,this.pts=null,this.startIndex=null;var t=arguments[0];this.e=t,this.pts=t.getCoordinates();var e=new Hi;this.startIndex=e.getChainStartIndices(this.pts)}}]),r}(),An=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"getDepth",value:function(t,e){return this._depth[t][e]}},{key:"setDepth",value:function(t,e,n){this._depth[t][e]=n}},{key:"isNull",value:function(){if(arguments.length===0){for(var t=0;t<2;t++)for(var e=0;e<3;e++)if(this._depth[t][e]!==r.NULL_VALUE)return!1;return!0}if(arguments.length===1){var n=arguments[0];return this._depth[n][1]===r.NULL_VALUE}if(arguments.length===2){var i=arguments[0],s=arguments[1];return this._depth[i][s]===r.NULL_VALUE}}},{key:"normalize",value:function(){for(var t=0;t<2;t++)if(!this.isNull(t)){var e=this._depth[t][1];this._depth[t][2]<e&&(e=this._depth[t][2]),e<0&&(e=0);for(var n=1;n<3;n++){var i=0;this._depth[t][n]>e&&(i=1),this._depth[t][n]=i}}}},{key:"getDelta",value:function(t){return this._depth[t][p.RIGHT]-this._depth[t][p.LEFT]}},{key:"getLocation",value:function(t,e){return this._depth[t][e]<=0?h.EXTERIOR:h.INTERIOR}},{key:"toString",value:function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]}},{key:"add",value:function(){if(arguments.length===1)for(var t=arguments[0],e=0;e<2;e++)for(var n=1;n<3;n++){var i=t.getLocation(e,n);i!==h.EXTERIOR&&i!==h.INTERIOR||(this.isNull(e,n)?this._depth[e][n]=r.depthAtLocation(i):this._depth[e][n]+=r.depthAtLocation(i))}else if(arguments.length===3){var s=arguments[0],a=arguments[1],u=arguments[2];u===h.INTERIOR&&this._depth[s][a]++}}}],[{key:"constructor_",value:function(){this._depth=Array(2).fill().map(function(){return Array(3)});for(var t=0;t<2;t++)for(var e=0;e<3;e++)this._depth[t][e]=r.NULL_VALUE}},{key:"depthAtLocation",value:function(t){return t===h.EXTERIOR?0:t===h.INTERIOR?1:r.NULL_VALUE}}]),r}();An.NULL_VALUE=-1;var Pn=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"getDepth",value:function(){return this._depth}},{key:"getCollapsedEdge",value:function(){var n=new Array(2).fill(null);return n[0]=this.pts[0],n[1]=this.pts[1],new e(n,et.toLineLabel(this._label))}},{key:"isIsolated",value:function(){return this._isIsolated}},{key:"getCoordinates",value:function(){return this.pts}},{key:"setIsolated",value:function(n){this._isIsolated=n}},{key:"setName",value:function(n){this._name=n}},{key:"equals",value:function(n){if(!(n instanceof e))return!1;var i=n;if(this.pts.length!==i.pts.length)return!1;for(var s=!0,a=!0,u=this.pts.length,o=0;o<this.pts.length;o++)if(this.pts[o].equals2D(i.pts[o])||(s=!1),this.pts[o].equals2D(i.pts[--u])||(a=!1),!s&&!a)return!1;return!0}},{key:"getCoordinate",value:function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var n=arguments[0];return this.pts[n]}}},{key:"print",value:function(n){n.print("edge "+this._name+": "),n.print("LINESTRING (");for(var i=0;i<this.pts.length;i++)i>0&&n.print(","),n.print(this.pts[i].x+" "+this.pts[i].y);n.print(")  "+this._label+" "+this._depthDelta)}},{key:"computeIM",value:function(n){e.updateIM(this._label,n)}},{key:"isCollapsed",value:function(){return!!this._label.isArea()&&this.pts.length===3&&!!this.pts[0].equals(this.pts[2])}},{key:"isClosed",value:function(){return this.pts[0].equals(this.pts[this.pts.length-1])}},{key:"getMaximumSegmentIndex",value:function(){return this.pts.length-1}},{key:"getDepthDelta",value:function(){return this._depthDelta}},{key:"getNumPoints",value:function(){return this.pts.length}},{key:"printReverse",value:function(n){n.print("edge "+this._name+": ");for(var i=this.pts.length-1;i>=0;i--)n.print(this.pts[i]+" ");n.println("")}},{key:"getMonotoneChainEdge",value:function(){return this._mce===null&&(this._mce=new Zi(this)),this._mce}},{key:"getEnvelope",value:function(){if(this._env===null){this._env=new z;for(var n=0;n<this.pts.length;n++)this._env.expandToInclude(this.pts[n])}return this._env}},{key:"addIntersection",value:function(n,i,s,a){var u=new v(n.getIntersection(a)),o=i,l=n.getEdgeDistance(s,a),c=o+1;if(c<this.pts.length){var g=this.pts[c];u.equals2D(g)&&(o=c,l=0)}this.eiList.add(u,o,l)}},{key:"toString",value:function(){var n=new ve;n.append("edge "+this._name+": "),n.append("LINESTRING (");for(var i=0;i<this.pts.length;i++)i>0&&n.append(","),n.append(this.pts[i].x+" "+this.pts[i].y);return n.append(")  "+this._label+" "+this._depthDelta),n.toString()}},{key:"isPointwiseEqual",value:function(n){if(this.pts.length!==n.pts.length)return!1;for(var i=0;i<this.pts.length;i++)if(!this.pts[i].equals2D(n.pts[i]))return!1;return!0}},{key:"setDepthDelta",value:function(n){this._depthDelta=n}},{key:"getEdgeIntersectionList",value:function(){return this.eiList}},{key:"addIntersections",value:function(n,i,s){for(var a=0;a<n.getIntersectionNum();a++)this.addIntersection(n,i,s,a)}}],[{key:"constructor_",value:function(){if(this.pts=null,this._env=null,this.eiList=new Ui(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new An,this._depthDelta=0,arguments.length===1){var n=arguments[0];e.constructor_.call(this,n,null)}else if(arguments.length===2){var i=arguments[0],s=arguments[1];this.pts=i,this._label=s}}},{key:"updateIM",value:function(){if(!(arguments.length===2&&arguments[1]instanceof Bi&&arguments[0]instanceof et))return M(O(e),"updateIM",this).apply(this,arguments);var n=arguments[0],i=arguments[1];i.setAtLeastIfValid(n.getLocation(0,p.ON),n.getLocation(1,p.ON),1),n.isArea()&&(i.setAtLeastIfValid(n.getLocation(0,p.LEFT),n.getLocation(1,p.LEFT),2),i.setAtLeastIfValid(n.getLocation(0,p.RIGHT),n.getLocation(1,p.RIGHT),2))}}]),e}(vn),Dn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"setWorkingPrecisionModel",value:function(t){this._workingPrecisionModel=t}},{key:"insertUniqueEdge",value:function(t){var e=this._edgeList.findEqualEdge(t);if(e!==null){var n=e.getLabel(),i=t.getLabel();e.isPointwiseEqual(t)||(i=new et(t.getLabel())).flip(),n.merge(i);var s=r.depthDelta(i),a=e.getDepthDelta()+s;e.setDepthDelta(a)}else this._edgeList.add(t),t.setDepthDelta(r.depthDelta(t.getLabel()))}},{key:"buildSubgraphs",value:function(t,e){for(var n=new T,i=t.iterator();i.hasNext();){var s=i.next(),a=s.getRightmostCoordinate(),u=new Rn(n).getDepth(a);s.computeDepth(u),s.findResultEdges(),n.add(s),e.add(s.getDirectedEdges(),s.getNodes())}}},{key:"createSubgraphs",value:function(t){for(var e=new T,n=t.getNodes().iterator();n.hasNext();){var i=n.next();if(!i.isVisited()){var s=new Qn;s.create(i),e.add(s)}}return Pt.sort(e,Pt.reverseOrder()),e}},{key:"createEmptyResultGeometry",value:function(){return this._geomFact.createPolygon()}},{key:"getNoder",value:function(t){if(this._workingNoder!==null)return this._workingNoder;var e=new Xe,n=new Ct;return n.setPrecisionModel(t),e.setSegmentIntersector(new zi(n)),e}},{key:"buffer",value:function(t,e){var n=this._workingPrecisionModel;n===null&&(n=t.getPrecisionModel()),this._geomFact=t.getFactory();var i=new Oi(n,this._bufParams),s=new Mi(t,e,i).getCurves();if(s.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(s,n),this._graph=new xn(new qi),this._graph.addEdges(this._edgeList.getEdges());var a=this.createSubgraphs(this._graph),u=new _i(this._geomFact);this.buildSubgraphs(a,u);var o=u.getPolygons();return o.size()<=0?this.createEmptyResultGeometry():this._geomFact.buildGeometry(o)}},{key:"computeNodedEdges",value:function(t,e){var n=this.getNoder(e);n.computeNodes(t);for(var i=n.getNodedSubstrings().iterator();i.hasNext();){var s=i.next(),a=s.getCoordinates();if(a.length!==2||!a[0].equals2D(a[1])){var u=s.getData(),o=new Pn(s.getCoordinates(),new et(u));this.insertUniqueEdge(o)}}}},{key:"setNoder",value:function(t){this._workingNoder=t}}],[{key:"constructor_",value:function(){this._bufParams=null,this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Yi;var t=arguments[0];this._bufParams=t}},{key:"depthDelta",value:function(t){var e=t.getLocation(0,p.LEFT),n=t.getLocation(0,p.RIGHT);return e===h.INTERIOR&&n===h.EXTERIOR?1:e===h.EXTERIOR&&n===h.INTERIOR?-1:0}},{key:"convertSegStrings",value:function(t){for(var e=new Mt,n=new T;t.hasNext();){var i=t.next(),s=e.createLineString(i.getCoordinates());n.add(s)}return e.buildGeometry(n)}}]),r}(),ji=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"rescale",value:function(){if(b(arguments[0],ot))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.rescale(n.getCoordinates())}else if(arguments[0]instanceof Array){for(var i=arguments[0],s=0;s<i.length;s++)i[s].x=i[s].x/this._scaleFactor+this._offsetX,i[s].y=i[s].y/this._scaleFactor+this._offsetY;i.length===2&&i[0].equals2D(i[1])&&$.out.println(i)}}},{key:"scale",value:function(){if(b(arguments[0],ot)){for(var t=arguments[0],e=new T(t.size()),n=t.iterator();n.hasNext();){var i=n.next();e.add(new Rt(this.scale(i.getCoordinates()),i.getData()))}return e}if(arguments[0]instanceof Array){for(var s=arguments[0],a=new Array(s.length).fill(null),u=0;u<s.length;u++)a[u]=new v(Math.round((s[u].x-this._offsetX)*this._scaleFactor),Math.round((s[u].y-this._offsetY)*this._scaleFactor),s[u].getZ());var o=B.removeRepeatedPoints(a);return o}}},{key:"isIntegerPrecision",value:function(){return this._scaleFactor===1}},{key:"getNodedSubstrings",value:function(){var t=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(t),t}},{key:"computeNodes",value:function(t){var e=t;this._isScaled&&(e=this.scale(t)),this._noder.computeNodes(e)}},{key:"interfaces_",get:function(){return[ze]}}],[{key:"constructor_",value:function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var t=arguments[0],e=arguments[1];r.constructor_.call(this,t,e,0,0)}else if(arguments.length===4){var n=arguments[0],i=arguments[1];this._noder=n,this._scaleFactor=i,this._isScaled=!this.isIntegerPrecision()}}}]),r}(),Fn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"checkEndPtVertexIntersections",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next(),n=e.getCoordinates();this.checkEndPtVertexIntersections(n[0],this._segStrings),this.checkEndPtVertexIntersections(n[n.length-1],this._segStrings)}else if(arguments.length===2){for(var i=arguments[0],s=arguments[1],a=s.iterator();a.hasNext();)for(var u=a.next(),o=u.getCoordinates(),l=1;l<o.length-1;l++)if(o[l].equals(i))throw new ut("found endpt/interior pt intersection at index "+l+" :pt "+i)}}},{key:"checkInteriorIntersections",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();)for(var e=t.next(),n=this._segStrings.iterator();n.hasNext();){var i=n.next();this.checkInteriorIntersections(e,i)}else if(arguments.length===2)for(var s=arguments[0],a=arguments[1],u=s.getCoordinates(),o=a.getCoordinates(),l=0;l<u.length-1;l++)for(var c=0;c<o.length-1;c++)this.checkInteriorIntersections(s,l,a,c);else if(arguments.length===4){var g=arguments[0],y=arguments[1],_=arguments[2],d=arguments[3];if(g===_&&y===d)return null;var x=g.getCoordinates()[y],N=g.getCoordinates()[y+1],w=_.getCoordinates()[d],G=_.getCoordinates()[d+1];if(this._li.computeIntersection(x,N,w,G),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,x,N)||this.hasInteriorIntersection(this._li,w,G)))throw new ut("found non-noded intersection at "+x+"-"+N+" and "+w+"-"+G)}}},{key:"checkValid",value:function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()}},{key:"checkCollapses",value:function(){if(arguments.length===0)for(var t=this._segStrings.iterator();t.hasNext();){var e=t.next();this.checkCollapses(e)}else if(arguments.length===1)for(var n=arguments[0],i=n.getCoordinates(),s=0;s<i.length-2;s++)this.checkCollapse(i[s],i[s+1],i[s+2])}},{key:"hasInteriorIntersection",value:function(t,e,n){for(var i=0;i<t.getIntersectionNum();i++){var s=t.getIntersection(i);if(!s.equals(e)&&!s.equals(n))return!0}return!1}},{key:"checkCollapse",value:function(t,e,n){if(t.equals(n))throw new ut("found non-noded collapse at "+r.fact.createLineString([t,e,n]))}}],[{key:"constructor_",value:function(){this._li=new Ct,this._segStrings=null;var t=arguments[0];this._segStrings=t}}]),r}();Fn.fact=new Mt;var Be=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"intersectsScaled",value:function(t,e){var n=Math.min(t.x,e.x),i=Math.max(t.x,e.x),s=Math.min(t.y,e.y),a=Math.max(t.y,e.y),u=this._maxx<n||this._minx>i||this._maxy<s||this._miny>a;if(u)return!1;var o=this.intersectsToleranceSquare(t,e);return A.isTrue(!(u&&o),"Found bad envelope test"),o}},{key:"initCorners",value:function(t){var e=.5;this._minx=t.x-e,this._maxx=t.x+e,this._miny=t.y-e,this._maxy=t.y+e,this._corner[0]=new v(this._maxx,this._maxy),this._corner[1]=new v(this._minx,this._maxy),this._corner[2]=new v(this._minx,this._miny),this._corner[3]=new v(this._maxx,this._miny)}},{key:"intersects",value:function(t,e){return this._scaleFactor===1?this.intersectsScaled(t,e):(this.copyScaled(t,this._p0Scaled),this.copyScaled(e,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))}},{key:"scale",value:function(t){return Math.round(t*this._scaleFactor)}},{key:"getCoordinate",value:function(){return this._originalPt}},{key:"copyScaled",value:function(t,e){e.x=this.scale(t.x),e.y=this.scale(t.y)}},{key:"getSafeEnvelope",value:function(){if(this._safeEnv===null){var t=r.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new z(this._originalPt.x-t,this._originalPt.x+t,this._originalPt.y-t,this._originalPt.y+t)}return this._safeEnv}},{key:"intersectsPixelClosure",value:function(t,e){return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.hasIntersection()||(this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.hasIntersection())))}},{key:"intersectsToleranceSquare",value:function(t,e){var n=!1,i=!1;return this._li.computeIntersection(t,e,this._corner[0],this._corner[1]),!!this._li.isProper()||(this._li.computeIntersection(t,e,this._corner[1],this._corner[2]),!!this._li.isProper()||(this._li.hasIntersection()&&(n=!0),this._li.computeIntersection(t,e,this._corner[2],this._corner[3]),!!this._li.isProper()||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(t,e,this._corner[3],this._corner[0]),!!this._li.isProper()||!(!n||!i)||!!t.equals(this._pt)||!!e.equals(this._pt))))}},{key:"addSnappedNode",value:function(t,e){var n=t.getCoordinate(e),i=t.getCoordinate(e+1);return!!this.intersects(n,i)&&(t.addIntersection(this.getCoordinate(),e),!0)}}],[{key:"constructor_",value:function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var t=arguments[0],e=arguments[1],n=arguments[2];if(this._originalPt=t,this._pt=t,this._scaleFactor=e,this._li=n,e<=0)throw new P("Scale factor must be non-zero");e!==1&&(this._pt=new v(this.scale(t.x),this.scale(t.y)),this._p0Scaled=new v,this._p1Scaled=new v),this.initCorners(this._pt)}}]),r}();Be.SAFE_ENV_EXPANSION_FACTOR=.75;var Wi=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"select",value:function(){if(arguments.length!==1&&arguments.length===2){var t=arguments[0],e=arguments[1];t.getLineSegment(e,this.selectedSegment),this.select(this.selectedSegment)}}}],[{key:"constructor_",value:function(){this.selectedSegment=new K}}]),r}(),Gn=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"snap",value:function(){if(arguments.length===1){var t=arguments[0];return this.snap(t,null,-1)}if(arguments.length===3){var e=arguments[0],n=arguments[1],i=arguments[2],s=e.getSafeEnvelope(),a=new qn(e,n,i);return this._index.query(s,new(function(){function u(){f(this,u)}return m(u,[{key:"interfaces_",get:function(){return[En]}},{key:"visitItem",value:function(o){o.select(s,a)}}]),u}())),a.isNodeAdded()}}}],[{key:"constructor_",value:function(){this._index=null;var t=arguments[0];this._index=t}}]),r}(),qn=function(r){C(e,r);var t=R(e);function e(){var n;return f(this,e),n=t.call(this),e.constructor_.apply(q(n),arguments),n}return m(e,[{key:"isNodeAdded",value:function(){return this._isNodeAdded}},{key:"select",value:function(){if(!(arguments.length===2&&Number.isInteger(arguments[1])&&arguments[0]instanceof Tn))return M(O(e.prototype),"select",this).apply(this,arguments);var n=arguments[0],i=arguments[1],s=n.getContext();if(this._parentEdge===s&&(i===this._hotPixelVertexIndex||i+1===this._hotPixelVertexIndex))return null;this._isNodeAdded|=this._hotPixel.addSnappedNode(s,i)}}],[{key:"constructor_",value:function(){this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],i=arguments[1],s=arguments[2];this._hotPixel=n,this._parentEdge=i,this._hotPixelVertexIndex=s}}]),e}(Wi);Gn.HotPixelSnapAction=qn;var Ki=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"processIntersections",value:function(t,e,n,i){if(t===n&&e===i)return null;var s=t.getCoordinates()[e],a=t.getCoordinates()[e+1],u=n.getCoordinates()[i],o=n.getCoordinates()[i+1];if(this._li.computeIntersection(s,a,u,o),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var l=0;l<this._li.getIntersectionNum();l++)this._interiorIntersections.add(this._li.getIntersection(l));t.addIntersections(this._li,e,0),n.addIntersections(this._li,i,1)}}},{key:"isDone",value:function(){return!1}},{key:"getInteriorIntersections",value:function(){return this._interiorIntersections}},{key:"interfaces_",get:function(){return[Mn]}}],[{key:"constructor_",value:function(){this._li=null,this._interiorIntersections=null;var t=arguments[0];this._li=t,this._interiorIntersections=new T}}]),r}(),Ji=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"checkCorrectness",value:function(t){var e=Rt.getNodedSubstrings(t),n=new Fn(e);try{n.checkValid()}catch(i){if(!(i instanceof mt))throw i;i.printStackTrace()}}},{key:"getNodedSubstrings",value:function(){return Rt.getNodedSubstrings(this._nodedSegStrings)}},{key:"snapRound",value:function(t,e){var n=this.findInteriorIntersections(t,e);this.computeIntersectionSnaps(n),this.computeVertexSnaps(t)}},{key:"findInteriorIntersections",value:function(t,e){var n=new Ki(e);return this._noder.setSegmentIntersector(n),this._noder.computeNodes(t),n.getInteriorIntersections()}},{key:"computeVertexSnaps",value:function(){if(b(arguments[0],ot))for(var t=arguments[0],e=t.iterator();e.hasNext();){var n=e.next();this.computeVertexSnaps(n)}else if(arguments[0]instanceof Rt)for(var i=arguments[0],s=i.getCoordinates(),a=0;a<s.length;a++){var u=new Be(s[a],this._scaleFactor,this._li),o=this._pointSnapper.snap(u,i,a);o&&i.addIntersection(s[a],a)}}},{key:"computeNodes",value:function(t){this._nodedSegStrings=t,this._noder=new Xe,this._pointSnapper=new Gn(this._noder.getIndex()),this.snapRound(t,this._li)}},{key:"computeIntersectionSnaps",value:function(t){for(var e=t.iterator();e.hasNext();){var n=e.next(),i=new Be(n,this._scaleFactor,this._li);this._pointSnapper.snap(i)}}},{key:"interfaces_",get:function(){return[ze]}}],[{key:"constructor_",value:function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var t=arguments[0];this._pm=t,this._li=new Ct,this._li.setPrecisionModel(t),this._scaleFactor=t.getScale()}}]),r}(),Gt=function(){function r(){f(this,r),r.constructor_.apply(this,arguments)}return m(r,[{key:"bufferFixedPrecision",value:function(t){var e=new ji(new Ji(new rt(1)),t.getScale()),n=new Dn(this._bufParams);n.setWorkingPrecisionModel(t),n.setNoder(e),this._resultGeometry=n.buffer(this._argGeom,this._distance)}},{key:"bufferReducedPrecision",value:function(){if(arguments.length===0){for(var t=r.MAX_PRECISION_DIGITS;t>=0;t--){try{this.bufferReducedPrecision(t)}catch(s){if(!(s instanceof vt))throw s;this._saveException=s}if(this._resultGeometry!==null)return null}throw this._saveException}if(arguments.length===1){var e=arguments[0],n=r.precisionScaleFactor(this._argGeom,this._distance,e),i=new rt(n);this.bufferFixedPrecision(i)}}},{key:"computeGeometry",value:function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var t=this._argGeom.getFactory().getPrecisionModel();t.getType()===rt.FIXED?this.bufferFixedPrecision(t):this.bufferReducedPrecision()}},{key:"setQuadrantSegments",value:function(t){this._bufParams.setQuadrantSegments(t)}},{key:"bufferOriginalPrecision",value:function(){try{var t=new Dn(this._bufParams);this._resultGeometry=t.buffer(this._argGeom,this._distance)}catch(e){if(!(e instanceof ut))throw e;this._saveException=e}}},{key:"getResultGeometry",value:function(t){return this._distance=t,this.computeGeometry(),this._resultGeometry}},{key:"setEndCapStyle",value:function(t){this._bufParams.setEndCapStyle(t)}}],[{key:"constructor_",value:function(){if(this._argGeom=null,this._distance=null,this._bufParams=new Y,this._resultGeometry=null,this._saveException=null,arguments.length===1){var t=arguments[0];this._argGeom=t}else if(arguments.length===2){var e=arguments[0],n=arguments[1];this._argGeom=e,this._bufParams=n}}},{key:"bufferOp",value:function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],n=new r(t),i=n.getResultGeometry(e);return i}if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof E&&typeof arguments[1]=="number"){var s=arguments[0],a=arguments[1],u=arguments[2],o=new r(s);o.setQuadrantSegments(u);var l=o.getResultGeometry(a);return l}if(arguments[2]instanceof Y&&arguments[0]instanceof E&&typeof arguments[1]=="number"){var c=arguments[0],g=arguments[1],y=arguments[2],_=new r(c,y),d=_.getResultGeometry(g);return d}}else if(arguments.length===4){var x=arguments[0],N=arguments[1],w=arguments[2],G=arguments[3],U=new r(x);U.setQuadrantSegments(w),U.setEndCapStyle(G);var V=U.getResultGeometry(N);return V}}},{key:"precisionScaleFactor",value:function(t,e,n){var i=t.getEnvelopeInternal(),s=jt.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY()))+2*(e>0?e:0),a=n-Math.trunc(Math.log(s)/Math.log(10)+1);return Math.pow(10,a)}}]),r}();Gt.CAP_ROUND=Y.CAP_ROUND,Gt.CAP_BUTT=Y.CAP_FLAT,Gt.CAP_FLAT=Y.CAP_FLAT,Gt.CAP_SQUARE=Y.CAP_SQUARE,Gt.MAX_PRECISION_DIGITS=12;var Qi=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],Yn=function(){function r(t){f(this,r),this.geometryFactory=t||new Mt}return m(r,[{key:"read",value:function(t){var e,n=(e=typeof t=="string"?JSON.parse(t):t).type;if(!it[n])throw new Error("Unknown GeoJSON type: "+e.type);return Qi.indexOf(n)!==-1?it[n].call(this,e.coordinates):n==="GeometryCollection"?it[n].call(this,e.geometries):it[n].call(this,e)}},{key:"write",value:function(t){var e=t.getGeometryType();if(!gt[e])throw new Error("Geometry is not supported");return gt[e].call(this,t)}}]),r}(),it={Feature:function(r){var t={};for(var e in r)t[e]=r[e];if(r.geometry){var n=r.geometry.type;if(!it[n])throw new Error("Unknown GeoJSON type: "+r.type);t.geometry=this.read(r.geometry)}return r.bbox&&(t.bbox=it.bbox.call(this,r.bbox)),t},FeatureCollection:function(r){var t={};if(r.features){t.features=[];for(var e=0;e<r.features.length;++e)t.features.push(this.read(r.features[e]))}return r.bbox&&(t.bbox=this.parse.bbox.call(this,r.bbox)),t},coordinates:function(r){for(var t=[],e=0;e<r.length;++e){var n=r[e];t.push(It(v,se(n)))}return t},bbox:function(r){return this.geometryFactory.createLinearRing([new v(r[0],r[1]),new v(r[2],r[1]),new v(r[2],r[3]),new v(r[0],r[3]),new v(r[0],r[1])])},Point:function(r){var t=It(v,se(r));return this.geometryFactory.createPoint(t)},MultiPoint:function(r){for(var t=[],e=0;e<r.length;++e)t.push(it.Point.call(this,r[e]));return this.geometryFactory.createMultiPoint(t)},LineString:function(r){var t=it.coordinates.call(this,r);return this.geometryFactory.createLineString(t)},MultiLineString:function(r){for(var t=[],e=0;e<r.length;++e)t.push(it.LineString.call(this,r[e]));return this.geometryFactory.createMultiLineString(t)},Polygon:function(r){for(var t=it.coordinates.call(this,r[0]),e=this.geometryFactory.createLinearRing(t),n=[],i=1;i<r.length;++i){var s=r[i],a=it.coordinates.call(this,s),u=this.geometryFactory.createLinearRing(a);n.push(u)}return this.geometryFactory.createPolygon(e,n)},MultiPolygon:function(r){for(var t=[],e=0;e<r.length;++e){var n=r[e];t.push(it.Polygon.call(this,n))}return this.geometryFactory.createMultiPolygon(t)},GeometryCollection:function(r){for(var t=[],e=0;e<r.length;++e){var n=r[e];t.push(this.read(n))}return this.geometryFactory.createGeometryCollection(t)}},gt={coordinate:function(r){var t=[r.x,r.y];return r.z&&t.push(r.z),r.m&&t.push(r.m),t},Point:function(r){return{type:"Point",coordinates:gt.coordinate.call(this,r.getCoordinate())}},MultiPoint:function(r){for(var t=[],e=0;e<r._geometries.length;++e){var n=r._geometries[e],i=gt.Point.call(this,n);t.push(i.coordinates)}return{type:"MultiPoint",coordinates:t}},LineString:function(r){for(var t=[],e=r.getCoordinates(),n=0;n<e.length;++n){var i=e[n];t.push(gt.coordinate.call(this,i))}return{type:"LineString",coordinates:t}},MultiLineString:function(r){for(var t=[],e=0;e<r._geometries.length;++e){var n=r._geometries[e],i=gt.LineString.call(this,n);t.push(i.coordinates)}return{type:"MultiLineString",coordinates:t}},Polygon:function(r){var t=[],e=gt.LineString.call(this,r._shell);t.push(e.coordinates);for(var n=0;n<r._holes.length;++n){var i=r._holes[n],s=gt.LineString.call(this,i);t.push(s.coordinates)}return{type:"Polygon",coordinates:t}},MultiPolygon:function(r){for(var t=[],e=0;e<r._geometries.length;++e){var n=r._geometries[e],i=gt.Polygon.call(this,n);t.push(i.coordinates)}return{type:"MultiPolygon",coordinates:t}},GeometryCollection:function(r){for(var t=[],e=0;e<r._geometries.length;++e){var n=r._geometries[e],i=n.getGeometryType();t.push(gt[i].call(this,n))}return{type:"GeometryCollection",geometries:t}}};return{BufferOp:Gt,GeoJSONReader:function(){function r(t){f(this,r),this.parser=new Yn(t||new Mt)}return m(r,[{key:"read",value:function(t){return this.parser.read(t)}}]),r}(),GeoJSONWriter:function(){function r(){f(this,r),this.parser=new Yn(this.geometryFactory)}return m(r,[{key:"write",value:function(t){return this.parser.write(t)}}]),r}()}})})(Un);var er=Un.exports,nr=tr(er);export{nr as default};

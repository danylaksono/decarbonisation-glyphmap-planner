/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/flubber@0.4.2/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{polygonCentroid as t,polygonLength as e,polygonArea as n}from"../d3-polygon@1.0.6/_esm.js";import r from"../svgpath@2.6.0/_esm.js";import{svgPathProperties as i}from"../svg-path-properties@0.2.2/_esm.js";import o from"../earcut@2.2.4/_esm.js";import{feature as l,neighbors as a,mergeArcs as s}from"../topojson-client@3.1.0/_esm.js";import{bisector as u}from"../d3-array@1.2.4/_esm.js";function c(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function g(t,e,n){return[t[0]+(e[0]-t[0])*n,t[1]+(e[1]-t[1])*n]}function f(t,e,n){let r=t.map(((t,n)=>function(t,e){return function(n){return t.map(((t,r)=>t+n*(e[r]-t)))}}(t,e[n])));return function(t){let e=r.map((e=>e(t)));return n?w(e):e}}function p(t){return"number"==typeof t&&isFinite(t)}function h(e){return function(t){for(let e=0;e<t.length-2;e++){let n=t[e],r=t[e+1],i=t[e+2];if(n[0]*(r[1]-i[1])+r[0]*(i[1]-n[1])+i[0]*(n[1]-r[1]))return!0}return!1}(e)?t(e):[(e[0][0]+e[e.length-1][0])/2,(e[0][1]+e[e.length-1][1])/2]}const m='All shapes must be supplied as arrays of [x, y] points or an SVG path string (https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d).\nExample valid ways of supplying a shape would be:\n[[0, 0], [10, 0], [10, 10]]\n"M0,0 L10,0 L10,10Z"\n';function y(t){return new r(t).abs()}function d(t){return t.toString().split("M").map(((t,e)=>(t=t.trim(),e&&t?"M"+t:t))).filter((t=>t))}function w(t){return"M"+t.join("L")+"Z"}function A(t){return d(y(t))}function M(t,e){let n=y(t);return function(t){let e=t.segments||[],n=[];if(!e.length||"M"!==e[0][0])return!1;for(let t=0;t<e.length;t++){let[r,i,o]=e[t];if("M"===r&&t||"Z"===r)break;if("M"===r||"L"===r)n.push([i,o]);else if("H"===r)n.push([i,n[n.length-1][1]]);else{if("V"!==r)return!1;n.push([n[n.length-1][0],i])}}return!!n.length&&{ring:n}}(n)||function(t,e){let n,r,o=d(t)[0],l=[],a=3;if(!o)throw new TypeError(m);r=function(t){if("undefined"!=typeof window&&window&&window.document)try{let e=window.document.createElementNS("http://www.w3.org/2000/svg","path");return e.setAttributeNS(null,"d",t),e}catch(t){}return i(t)}(o),n=r.getTotalLength(),e&&p(e)&&e>0&&(a=Math.max(a,Math.ceil(n/e)));for(let t=0;t<a;t++){let e=r.getPointAtLength(n*t/a);l.push([e.x,e.y])}return{ring:l,skipBisect:!0}}(n,e)}function b(t,n){const r=t.length+n,i=e(t)/n;let o=0,l=0,a=i/2;for(;t.length<r;){let e=t[o],n=t[(o+1)%t.length],r=c(e,n);a<=l+r?(t.splice(o+1,0,r?g(e,n,(a-l)/r):e.slice(0)),a+=i):(l+=r,o++)}}function L(t,e){let r,i,o;if("string"==typeof t){let n=M(t,e);t=n.ring,o=n.skipBisect}else if(!Array.isArray(t))throw new TypeError(m);if(r=t.slice(0),!function(t){return t.every((function(t){return Array.isArray(t)&&t.length>=2&&p(t[0])&&p(t[1])}))}(r))throw new TypeError(m);var l,a;return r.length>1&&(l=r[0],a=r[r.length-1],c(l,a)<1e-9)&&r.pop(),i=n(r),i>0&&r.reverse(),!o&&e&&p(e)&&e>0&&function(t,e=1/0){for(let n=0;n<t.length;n++){let r=t[n],i=n===t.length-1?t[0]:t[n+1];for(;c(r,i)>e;)i=g(r,i,.5),t.splice(n+1,0,i)}}(r,e),r}function S(t,e,{maxSegmentLength:n=10,string:r=!0}={}){let i=x(L(t,n),L(e,n),r);return!r||"string"!=typeof t&&"string"!=typeof e?i:n=>n<1e-4&&"string"==typeof t?t:1-n<1e-4&&"string"==typeof e?e:i(n)}function x(t,e,n){let r;return r=t.length-e.length,b(t,r<0?-1*r:0),b(e,r>0?r:0),function(t,e){let n,r,i,o=t.length,l=1/0;for(let i=0;i<o;i++)r=0,e.forEach((function(e,n){let l=c(t[(i+n)%o],e);r+=l*l})),r<l&&(l=r,n=i);n&&(i=t.splice(0,n),t.splice(t.length,0,...i))}(t,e),f(t,e,n)}function v(t,e){return function(t,e){const n=t.objects.triangles.geometries,r=u((t=>t.area)).left;for(;n.length>e;)i();if(e>n.length)throw new RangeError("Can't collapse topology into "+e+" pieces.");return l(t,t.objects.triangles).features.map((t=>(t.geometry.coordinates[0].pop(),t.geometry.coordinates[0])));function i(){const e=n[0],i=a(n)[0][0],o=n[i],l=s(t,[e,o]);l.area=e.area+o.area,l.type="Polygon",l.arcs=l.arcs[0],n.splice(i,1),n.shift(),n.splice(r(n,l.area),0,l)}}(function(t,e){const r={},i={type:"Topology",objects:{triangles:{type:"GeometryCollection",geometries:[]}},arcs:[]};return t.forEach((function(t){const o=[];t.forEach((function(t,n){const l=t[0]<t[1]?t.join(","):t[1]+","+t[0],a=t.map((function(t){return e[t]}));l in r?o.push(~r[l]):(o.push(r[l]=i.arcs.length),i.arcs.push(a))})),i.objects.triangles.geometries.push({type:"Polygon",area:Math.abs(n(t.map((function(t){return e[t[0]]})))),arcs:[o]})})),i.objects.triangles.geometries.sort(((t,e)=>t.area-e.area)),i}(function(t){let e=o(t.reduce(((t,e)=>[...t,e[0],e[1]]),[])),n=[];for(let t=0,r=e.length;t<r;t+=3)n.push([[e[t],e[t+1]],[e[t+1],e[t+2]],[e[t+2],e[t]]]);return n}(t),t),e)}function j(t,e){if(t.length>8)return t.map(((t,e)=>e));let n=t.map((t=>e.map((e=>function(t,e){let n=c(h(t),h(e));return n*n}(t,e)))));return function(t,e,n){let r=1/0,i=t.map(((t,e)=>e));function o(t,e=[],l=0){for(let a=0;a<t.length;a++){let s=t.splice(a,1),u=n[s[0]][e.length];l+u<r&&(t.length?o(t.slice(),e.concat(s),l+u):(r=l+u,i=e.concat(s))),t.length&&t.splice(a,0,s[0])}}return o(i),i}(t,0,n)}function E(t,e,{maxSegmentLength:n=10,string:r=!0,single:i=!1}={}){let o=L(t,n);o.length<e.length+2&&b(o,e.length+2-o.length);let l,a=v(o,e.length),s=e.map((t=>L(t,n))),u="string"==typeof t&&t;return i&&!e.every((t=>"string"==typeof t))||(l=e.slice(0)),G(a,s,{match:!0,string:r,single:i,t0:u,t1:l})}function P(t,e,{maxSegmentLength:n=10,string:r=!0,single:i=!1}={}){let o=E(e,t,{maxSegmentLength:n,string:r,single:i});return i?t=>o(1-t):o.map((t=>e=>t(1-e)))}function T(t,e,{maxSegmentLength:n=10,string:r=!0,single:i=!1}={}){if(!Array.isArray(t)||!Array.isArray(e)||t.length!==e.length||!t.length)throw new TypeError("flubber.all() expects two arrays of equal length as arguments. Each element in both arrays should be an array of [x, y] points or an SVG path string (https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d).");let o,l,a=t=>L(t,n),s=t.map(a),u=e.map(a);return i?(t.every((t=>"string"==typeof t))&&(o=t.slice(0)),e.every((t=>"string"==typeof t))&&(l=e.slice(0))):(o=t.slice(0),l=e.slice(0)),G(s,u,{string:r,single:i,t0:o,t1:l,match:!1})}function G(t,e,{string:n,single:r,t0:i,t1:o,match:l}={}){let a=l?j(t,e):t.map(((t,e)=>e)),s=a.map(((r,i)=>x(t[r],e[i],n)));if(l&&Array.isArray(i)&&(i=a.map((t=>i[t]))),r&&n&&(Array.isArray(i)&&(i=i.join(" ")),Array.isArray(o)&&(o=o.join(" "))),r){let t=n?t=>s.map((e=>e(t))).join(" "):t=>s.map((e=>e(t)));return n&&(i||o)?e=>e<1e-4&&i||1-e<1e-4&&o||t(e):t}return n?(i=Array.isArray(i)?i.map((t=>"string"==typeof t&&t)):[],o=Array.isArray(o)?o.map((t=>"string"==typeof t&&t)):[],s.map(((t,e)=>i[e]||o[e]?n=>n<1e-4&&i[e]||1-n<1e-4&&o[e]||t(n):t))):s}function V(t,n,r,i,o){return C(function(t,n,r){return function(i){let o=h(i),l=e([...i,i[0]]),a=Math.atan2(i[0][1]-o[1],i[0][0]-o[0]),s=0;return i.map(((e,o)=>{let u;return o&&(s+=c(e,i[o-1])),u=a+2*Math.PI*(l?s/l:o/i.length),[Math.cos(u)*r+t,Math.sin(u)*r+n]}))}}(t,n,r),i,function(t,e,n){let r=t-n+","+e,i=t+n+","+e,o="A"+n+","+n+",0,1,1,";return"M"+r+o+i+o+r+"Z"}(t,n,r),2*Math.PI*r,o)}function Z(t,e,n,r,i){let o=V(e,n,r,t,i);return t=>o(1-t)}function I(t,n,r,i,o,l){return C(function(t,n,r,i){return function(o){let l=h(o),a=e([...o,o[0]]),s=Math.atan2(o[0][1]-l[1],o[0][0]-l[0]),u=0;s<0&&(s=2*Math.PI+s);let g=s/(2*Math.PI);return o.map(((e,l)=>{l&&(u+=c(e,o[l-1]));let s=function(t){if(t<=1/8)return[1,.5+4*t];if(t<=3/8)return[1.5-4*t,1];if(t<=5/8)return[0,2.5-4*t];if(t<=7/8)return[4*t-2.5,0];return[1,4*t-3.5]}((g+(a?u/a:l/o.length))%1);return[t+s[0]*r,n+s[1]*i]}))}}(t,n,r,i),o,function(t,e,n,r){let i=t+n,o=e+r;return"M"+t+","+e+"L"+i+","+e+"L"+i+","+o+"L"+t+","+o+"Z"}(t,n,r,i),2*r+2*i,l)}function k(t,e,n,r,i,o){let l=I(e,n,r,i,t,o);return t=>l(1-t)}function C(t,e,n,r,{maxSegmentLength:i=10,string:o=!0}={}){let l,a,s=L(e,i);return p(r)&&s.length<r/i&&b(s,Math.ceil(r/i-s.length)),l=t(s),a=f(l,s,o),o?t=>t<1e-4?n:a(t):a}export{P as combine,V as fromCircle,I as fromRect,S as interpolate,T as interpolateAll,E as separate,A as splitPathString,Z as toCircle,w as toPathString,k as toRect};export default null;

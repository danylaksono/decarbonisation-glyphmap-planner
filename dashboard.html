<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>dashboard | Decarbonisation Glyphmap Planner</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="preload" as="style" href="./_observablehq/theme-air,near-midnight,alt,wide.css">
<link rel="preload" as="style" href="./_observablehq/stdlib/inputs.css">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro:ital,wght@0,400;0,600;0,700;1,400;1,600;1,700&amp;display=swap" crossorigin>
<link rel="stylesheet" type="text/css" href="./_observablehq/theme-air,near-midnight,alt,wide.css">
<link rel="stylesheet" type="text/css" href="./_observablehq/stdlib/inputs.css">
<link rel="modulepreload" href="./_observablehq/client.js">
<link rel="modulepreload" href="./_observablehq/runtime.js">
<link rel="modulepreload" href="./_observablehq/stdlib.js">
<link rel="modulepreload" href="./_node/@turf/turf@7.1.0/index.js">
<link rel="modulepreload" href="./_npm/d3@7.9.0/_esm.js">
<link rel="modulepreload" href="./_import/components/morpher.71f80d62.js">
<link rel="modulepreload" href="./_import/components/gridded-glyphmaps/index.min.e9355c65.js">
<link rel="modulepreload" href="./_import/components/utils.62d37372.js">
<link rel="modulepreload" href="./_npm/flubber@0.4.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-require@1.3.0/_esm.js">
<link rel="modulepreload" href="./_npm/topojson-client@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/lodash@4.17.21/_esm.js">
<link rel="modulepreload" href="./_observablehq/stdlib/duckdb.js">
<link rel="modulepreload" href="./_observablehq/stdlib/inputs.js">
<link rel="modulepreload" href="./_npm/@duckdb/duckdb-wasm@1.28.0/_esm.js">
<link rel="modulepreload" href="./_npm/htl@0.3.1/_esm.js">
<link rel="modulepreload" href="./_npm/isoformat@0.2.1/_esm.js">
<link rel="modulepreload" href="./_node/@turf/along@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/angle@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/area@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/bbox@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/bbox-clip@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/bbox-polygon@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/bearing@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/bezier-spline@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-clockwise@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-concave@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-contains@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-crosses@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-disjoint@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-equal@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-intersects@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-overlap@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-parallel@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-point-in-polygon@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-point-on-line@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-touches@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-valid@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/boolean-within@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/buffer@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/center@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/center-mean@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/center-median@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/center-of-mass@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/centroid@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/circle@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/clean-coords@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/clone@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/clusters@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/clusters-dbscan@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/clusters-kmeans@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/collect@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/combine@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/concave@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/convex@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/destination@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/difference@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/dissolve@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/distance@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/distance-weight@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/ellipse@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/envelope@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/explode@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/flatten@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/flip@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/geojson-rbush@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/great-circle@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/helpers@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/hex-grid@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/interpolate@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/intersect@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/invariant@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/isobands@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/isolines@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/kinks@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/length@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-arc@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-chunk@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-intersect@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-offset@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-overlap@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-segment@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-slice@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-slice-along@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-split@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/line-to-polygon@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/mask@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/meta@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/midpoint@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/moran-index@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/nearest-neighbor-analysis@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/nearest-point@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/nearest-point-on-line@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/nearest-point-to-line@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/planepoint@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/point-grid@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/point-on-feature@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/points-within-polygon@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/point-to-line-distance@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/polygonize@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/polygon-smooth@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/polygon-tangents@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/polygon-to-line@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/projection@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/quadrat-analysis@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/random@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/rectangle-grid@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/rewind@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/rhumb-bearing@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/rhumb-destination@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/rhumb-distance@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/sample@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/sector@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/shortest-path@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/simplify@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/square@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/square-grid@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/standard-deviational-ellipse@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/tag@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/tesselate@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/tin@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/transform-rotate@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/transform-scale@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/transform-translate@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/triangle-grid@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/truncate@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/union@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/unkink-polygon@7.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/voronoi@7.1.0/index.js">
<link rel="modulepreload" href="./_npm/d3-array@3.2.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-axis@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-brush@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-chord@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-color@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-contour@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-delaunay@6.0.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dispatch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-drag@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-dsv@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-ease@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-fetch@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-force@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-format@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-geo@3.1.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-hierarchy@3.1.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-interpolate@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-path@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-polygon@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-quadtree@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-random@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale@4.0.2/_esm.js">
<link rel="modulepreload" href="./_npm/d3-scale-chromatic@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-selection@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-shape@3.2.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time@3.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-time-format@4.1.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-timer@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-transition@3.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/d3-zoom@3.0.0/_esm.js">
<link rel="modulepreload" href="./_npm/d3-polygon@1.0.6/_esm.js">
<link rel="modulepreload" href="./_npm/svgpath@2.6.0/_esm.js">
<link rel="modulepreload" href="./_npm/svg-path-properties@0.2.2/_esm.js">
<link rel="modulepreload" href="./_npm/earcut@2.2.4/_esm.js">
<link rel="modulepreload" href="./_npm/d3-array@1.2.4/_esm.js">
<link rel="modulepreload" href="./_npm/apache-arrow@17.0.0/_esm.js">
<link rel="modulepreload" href="./_node/geojson-equality-ts@1.0.2/index.js">
<link rel="modulepreload" href="./_node/point-in-polygon-hao@1.1.0/index.js">
<link rel="modulepreload" href="./_node/@turf/jsts@2.7.1/index.js">
<link rel="modulepreload" href="./_node/d3-geo@1.7.1/index.js">
<link rel="modulepreload" href="./_node/rbush@3.0.1/index.js">
<link rel="modulepreload" href="./_node/skmeans@0.9.7/index.js">
<link rel="modulepreload" href="./_node/topojson-client@3.1.0/index.js">
<link rel="modulepreload" href="./_node/topojson-server@3.0.1/index.js">
<link rel="modulepreload" href="./_node/concaveman@1.2.1/index.js">
<link rel="modulepreload" href="./_node/polygon-clipping@0.15.7/index.js">
<link rel="modulepreload" href="./_node/marchingsquares@1.3.3/index.js">
<link rel="modulepreload" href="./_node/sweepline-intersections@1.5.0/index.js">
<link rel="modulepreload" href="./_node/fast-deep-equal@3.1.3/index.js">
<link rel="modulepreload" href="./_node/earcut@2.2.4/index.js">
<link rel="modulepreload" href="./_node/d3-voronoi@1.1.2/index.js">
<link rel="modulepreload" href="./_npm/internmap@2.0.3/_esm.js">
<link rel="modulepreload" href="./_npm/delaunator@5.0.1/_esm.js">
<link rel="modulepreload" href="./_npm/tslib@2.6.3/_esm.js">
<link rel="modulepreload" href="./_npm/flatbuffers@24.3.25/_esm.js">
<link rel="modulepreload" href="./_node/d3-array@1.2.4/index.js">
<link rel="modulepreload" href="./_node/tinyqueue@2.0.3/index.js">
<link rel="modulepreload" href="./_node/point-in-polygon@1.1.0/index.js">
<link rel="modulepreload" href="./_node/robust-predicates@2.0.4/umd/orient2d.min.js">
<link rel="modulepreload" href="./_npm/robust-predicates@3.0.2/_esm.js">
<script type="module">

import {define} from "./_observablehq/client.js";
import {registerFile, FileAttachment} from "./_observablehq/stdlib.js";
import {registerTable} from "./_observablehq/stdlib/duckdb.js";

registerFile("./data/deprivation.parquet", {"name":"./data/deprivation.parquet","path":"./_file/data/deprivation.127576bc.parquet","lastModified":1724442200951});
registerFile("./data/geo.csv", {"name":"./data/geo.csv","mimeType":"text/csv","path":"./_file/data/geo.8ba75b99.csv","lastModified":1724442201011});
registerFile("./data/pop.parquet", {"name":"./data/pop.parquet","path":"./_file/data/pop.d268a84b.parquet","lastModified":1724442201151});
registerFile("./data/vehicle.parquet", {"name":"./data/vehicle.parquet","path":"./_file/data/vehicle.28874fcc.parquet","lastModified":1724442201203});
registerTable("geo", FileAttachment("./data/geo.csv"));
registerTable("pop", FileAttachment("./data/pop.parquet"));
registerTable("deprivation", FileAttachment("./data/deprivation.parquet"));
registerTable("vehicle", FileAttachment("./data/vehicle.parquet"));

define({id: "2ef11e8f", outputs: ["turf","d3","inSituMorphMouse","prepareGeoJsonForMorphingLib","glyphMap","createDiscretiserValue","_drawCellBackground","downloadBoundaries","joinCensusDataToGeoJSON","convertGridCsvToGeoJson"], body: async () => {
const [turf, d3, {inSituMorphMouse, prepareGeoJsonForMorphingLib}, {glyphMap, createDiscretiserValue, _drawCellBackground}, {downloadBoundaries, joinCensusDataToGeoJSON, convertGridCsvToGeoJson}] = await Promise.all([import("./_node/@turf/turf@7.1.0/index.js"), import("./_npm/d3@7.9.0/_esm.js"), import("./_import/components/morpher.71f80d62.js"), import("./_import/components/gridded-glyphmaps/index.min.e9355c65.js"), import("./_import/components/utils.62d37372.js")]);

return {turf,d3,inSituMorphMouse,prepareGeoJsonForMorphingLib,glyphMap,createDiscretiserValue,_drawCellBackground,downloadBoundaries,joinCensusDataToGeoJSON,convertGridCsvToGeoJson};
}});

define({id: "c4f336b2", inputs: ["view","Inputs","list_la"], outputs: ["local_authority"], body: (view,Inputs,list_la) => {
const local_authority = view(
  Inputs.select(
    [...list_la].map((item) => item.label),
    {
      value: "Cambridge",
      label: "Local Authority:",
    }
  )
);
return {local_authority};
}});

define({id: "ec9a4323", inputs: ["view","Inputs"], outputs: ["geogName"], body: (view,Inputs) => {
const geogName = view(
  Inputs.radio(["LSOA", "MSOA"], {
    value: "MSOA",
    label: "Geography",
  })
);
return {geogName};
}});

define({id: "76ba71c3", inputs: ["list_la","local_authority","geogName"], outputs: ["la_code","geogBoundary"], body: (list_la,local_authority,geogName) => {
const la_code = [...list_la].find((row) => row.label === local_authority).code;
const geogBoundary = geogName.toLowerCase() + "s";
return {la_code,geogBoundary};
}});

define({id: "ac7e408e", inputs: ["sql"], outputs: ["list_la"], body: async (sql) => {
const list_la = await sql`select distinct label, code from geo where geography = 'LA' order by label`;
return {list_la};
}});

define({id: "cad06486", inputs: ["sql","geogName","la_code"], outputs: ["list_of_codes"], body: async (sql,geogName,la_code) => {
const list_of_codes = await sql`SELECT code
FROM geo
WHERE geo.geography = (SELECT replace(${geogName}, '"', ''''))
AND geo.LA = (SELECT replace(${la_code}, '"', ''''))`;
return {list_of_codes};
}});

define({id: "30024201", inputs: ["list_of_codes","downloadBoundaries","geogBoundary"], outputs: ["list_of_code","regular_geodata"], body: async (list_of_codes,downloadBoundaries,geogBoundary) => {
const list_of_code = [...list_of_codes].map((row) => row.code);
const regular_geodata = await downloadBoundaries(geogBoundary, list_of_code);
return {list_of_code,regular_geodata};
}});

define({id: "7343b1d1", inputs: ["sql","geogName","la_code"], outputs: ["census_data"], body: async (sql,geogName,la_code) => {
const census_data = await sql`SELECT geo.code, geo.label, deprivation.value as deprivation, vehicle.value as vehicle
  FROM geo,deprivation, vehicle
  WHERE geo.geography=(SELECT replace(${geogName}, '"', '''')) AND geo.LA= (SELECT replace(${la_code}, '"', '''')) AND geo.code=deprivation.code AND deprivation.category=5
  ORDER BY deprivation.value DESC`;
return {census_data};
}});

define({id: "a5225c8a", inputs: ["d3","convertGridCsvToGeoJson","local_authority","geogBoundary","turf","regular_geodata"], outputs: ["convertGridIfExists","filename","bb","grid_geodata"], body: async (d3,convertGridCsvToGeoJson,local_authority,geogBoundary,turf,regular_geodata) => {
async function convertGridIfExists(filename, bb) {
  // take from stored preprocessed grids for now
  // future version will use the grid generation code
  const gridPath = `https://www.danylaksono.com/datasets/cartogram/${filename}.csv`;

  try {
    const gridCsv = await d3.csv(gridPath);
    return convertGridCsvToGeoJson(gridCsv, bb);
  } catch (error) {
    // console.log(`Grid file ${filename}.csv not found or couldn't be loaded.`);
    return null;
  }
}

const filename = `${local_authority.toLowerCase()}_${geogBoundary}_grids`;
const bb = turf.bbox(regular_geodata);

const grid_geodata = await convertGridIfExists(filename, bb);
// display(bb);
// display(gridGeoJson);
return {convertGridIfExists,filename,bb,grid_geodata};
}});

define({id: "f221b1fe", inputs: ["_","regular_geodata"], outputs: ["data"], body: (_,regular_geodata) => {
const data = _.keyBy(
  regular_geodata.features.map((feat) => {
    return {
      code: feat.properties.code,
      population: +feat.properties.population,
    };
  }),
  "code"
);
return {data};
}});

define({id: "b68a070b", inputs: ["createDiscretiserValue"], outputs: ["valueDiscretiser"], body: (createDiscretiserValue) => {
const valueDiscretiser = (geomLookup) => {
  return createDiscretiserValue({
    //... and adds a discretisation function that aggregates by CODE and supplies the polygons for each cell
    valueFn: (row) => {
      return row.code;
    },
    glyphLocationFn: (key) => geomLookup[key]?.centroid,
    boundaryFn: (key) => geomLookup[key]?.geometry.coordinates[0],
  });
};
return {valueDiscretiser};
}});

define({id: "31e3be70", inputs: ["d3","data","prepareGeoJsonForMorphingLib","regular_geodata","local_authority","geogName","grid_geodata","inSituMorphMouse","display"], outputs: ["colourScalePop","layouts","morphers"], body: (d3,data,prepareGeoJsonForMorphingLib,regular_geodata,local_authority,geogName,grid_geodata,inSituMorphMouse,display) => {
const colourScalePop = d3
  .scaleSequential(d3.interpolateBlues)
  .domain([0, d3.max(Object.values(data).map((row) => row.population))]);

const layouts = [
  {
    shapes: prepareGeoJsonForMorphingLib(
      regular_geodata,
      regular_geodata,
      300,
      300
    ),
    colourFn: (key) => colourScalePop(data[key].population),
    description: local_authority + " " + geogName + " Choropleth Map.",
  },
  {
    shapes: prepareGeoJsonForMorphingLib(
      grid_geodata,
      regular_geodata,
      300,
      300
    ),
    colourFn: (key) => colourScalePop(data[key].population),
    description: local_authority + " " + geogName + "Gridmaps.",
  },
];

const morphers = inSituMorphMouse({
  interactive: true,
  showDescription: true,
  layouts,
});

display(morphers);
return {colourScalePop,layouts,morphers};
}});

</script>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="./">Decarbonisation Glyphmap Planner</a></li>
  </ol>
  <ol>
    <li class="observablehq-link observablehq-link-active"><a href="./dashboard">dashboard</a></li>
    <li class="observablehq-link"><a href="./example-report">Example report</a></li>
  </ol>
</nav>
<script>{Object.assign(document.createElement("a"),{href:""}).password&&location.replace(location.href);const e=document.querySelector("#observablehq-sidebar"),t=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?t.checked=r==="true":t.indeterminate=!0;for(const o of document.querySelectorAll("#observablehq-sidebar summary")){const s=o.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${o.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<div id="observablehq-center">
<main id="observablehq-main" class="observablehq">
<h1 id="morphing-glyphmaps" tabindex="-1"><a class="observablehq-header-anchor" href="#morphing-glyphmaps">Morphing Glyphmaps</a></h1>
<p>An observable framework translation of <a href="https://observablehq.com/@danylaksono/morphing-gridmaps" target="_blank" rel="noopener noreferrer">https://observablehq.com/@danylaksono/morphing-gridmaps</a></p>
<div class="observablehq observablehq--block"><!--:2ef11e8f:--></div>
<h2 id="area-selection" tabindex="-1"><a class="observablehq-header-anchor" href="#area-selection">Area Selection</a></h2>
<p>Select the Local authority from the list below</p>
<div class="observablehq observablehq--block"><!--:c4f336b2:--></div>
<div class="observablehq observablehq--block"><!--:ec9a4323:--></div>
<div class="observablehq observablehq--block"><!--:76ba71c3:--></div>
<div class="observablehq observablehq--block"><!--:ac7e408e:--></div>
<div class="observablehq observablehq--block"><!--:cad06486:--></div>
<div class="observablehq observablehq--block"><!--:30024201:--></div>
<div class="observablehq observablehq--block"><!--:7343b1d1:--></div>
<div class="observablehq observablehq--block"><!--:a5225c8a:--></div>
<h2 id="morphing-geometry" tabindex="-1"><a class="observablehq-header-anchor" href="#morphing-geometry">Morphing Geometry</a></h2>
<div class="observablehq observablehq--block"><!--:f221b1fe:--></div>
<div class="observablehq observablehq--block"><!--:b68a070b:--></div>
<div class="observablehq observablehq--block"><!--:31e3be70:--></div>
</main>
<footer id="observablehq-footer">
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2024-08-23T19:43:26">Aug 23, 2024</a>.</div>
</footer>
</div>
